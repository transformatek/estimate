var myAjaxPageFetcher={loadingMessage:"Loading Page, please wait...",fileRegistry:"",fetchPage:function(f,c,b,g,j,a,i){var k=null;var h="";k=getHTMLHTTPRequest();if(k==null){return}var e=c.replace(/^http:\/\/[^\/]+\//i,"http://"+window.location.hostname+"/");k.onreadystatechange=function(){myAjaxPageFetcher.loadPage(k,f,c,g,j)};if(b){h=(e.indexOf("?")!=-1)?"&"+new Date().getTime():"?"+new Date().getTime()}writeWaitMsg(f,"themes/icons/ajax_loading/22.gif",myAjaxPageFetcher.loadingMessage);if(a=="get"){k.open("GET",e+h,true);k.send(null)}else{if(a=="post"){var d=i;if(d==null||d=="undefined"){d=""}k.open("POST",e+h,true);k.setRequestHeader("Content-type","application/x-www-form-urlencoded");k.setRequestHeader("Content-length",d.length);k.send(d)}else{alert("Wrong Method: only get/post supported")}}},loadPage:function(e,c,f,b,a){if(e.readyState==4&&(e.status==200||window.location.href.indexOf("http")==-1)){document.getElementById(c).innerHTML=e.responseText;for(var d=0;d<b.length;d++){this.loadScript(b[d])}for(var d=0;d<a.length;d++){this.loadStyleSheet(a[d])}this.callbackAction(f)}},loadScript:function(b){if(!this.isLoaded(b)){element=this.createScriptElement(b,"js");document.getElementsByTagName("head")[0].appendChild(element);this.setLoaded(b)}else{var c=document.getElementsByTagName("script");for(var a=c.length;a>=0;a--){var d=null;if(c[a]){d=c[a].getAttribute("src")}if(d!=null&&d.indexOf(b)!=-1){var e=this.createScriptElement(b,"js");c[a].parentNode.replaceChild(e,c[a])}}}},loadStyleSheet:function(a){if(!this.isLoaded(a)){element=this.createScriptElement(a,"css");document.getElementsByTagName("head")[0].appendChild(element);this.setLoaded(a)}else{var c=document.getElementsByTagName("link");for(var b=c.length;b>=0;b--){var d=null;if(c[b]){d=c[b].getAttribute("href")}if(d!=null&&d.indexOf(a)!=-1){var e=this.createScriptElement(a,"css");c[b].parentNode.replaceChild(e,c[b])}}}},isLoaded:function(a){return(this.fileRegistry.indexOf("["+a+"]")!=-1)},setLoaded:function(a){this.fileRegistry+="["+a+"]"},createScriptElement:function(a,c){if(c=="js"){var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("src",a)}else{if(c=="css"){var b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",a)}}return b},callbackAction:function(a){this.callBack(a)},callBack:function(a){},load:function(c,d,e,b,a,g,f){var b=(typeof b=="undefined"||b=="")?[]:b;var a=(typeof a=="undefined"||a=="")?[]:a;this.fetchPage(c,d,e,b,a,g,f)}};