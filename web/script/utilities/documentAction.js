var dmsTableparent=1;var dmsTableTop=1;var dmsTableCurrentParent=1;var dmsTablecontainer="blankContent";var dmsPropertiesWindowTitle=null;var INPUT_NAME_PREFIX="inputName";var RADIO_NAME="radName";var TABLE_NAME="dmsSample";var DIV_NAV_NAME="dmsNavDiv";var ROW_BASE=1;var hasLoaded=false;var ctx_THEAD="DMS_TTHEAD123";var ctx_TBODY="DMS_TTBODY123";var upload_FRAME="DMS_FRAME123";var uploadWindow="blankHidden1";var key="qwerty";var sid=0;var callBack=function(){if(myContextMenuRequest.readyState==4){if(myContextMenuRequest.status==200){configureContextMenu();callDmsAjax(1)}else{alert("Connection Problem:"+myContextMenuRequest.statusText)}}};var initializeDocumentsTable=function(a){myCurrentMenuParent=a;writeWaitMsg(dmsTablecontainer,"themes/icons/ajax_loading/22.gif","Loading Menu...");callContextMenuAjax(a,callBack)};var menu2=function(){return configureContextMenuModel()};contextMenu.modifyMenu=function(){var a=this.srcElement;currentMenuBar=this.menuBar;var b;while(true){b=a.parentNode;if(b.tagName!="TR"){a=b;continue}else{break}}clickOnTableRowContext(b);if(b.myRow==null){setMenuItemState(213180,"disabled");setMenuItemState(213190,"disabled");setMenuItemState(213210,"disabled")}else{setMenuItemState(213180,"regular");setMenuItemState(213190,"regular");setMenuItemState(213210,"regular")}if(myMoveAction.movableItemType==null){setMenuItemState(213230,"disabled")}else{setMenuItemState(213230,"regular")}if(dmsTableCurrentParent==1){setMenuItemState(213110,"disabled");setMenuItemState(213120,"disabled")}else{setMenuItemState(213110,"regular");setMenuItemState(213120,"regular")}setMenuPermissions(currentMenuBar)};function callDmsAjax(d){if(document.getElementById(dmsTablecontainer)==null){return}if(dmsPropertiesWindowTitle!=null){dmsPropertiesWindowTitle.close()}var a=getHTMLHTTPRequest();dmsTableCurrentParent=d;var c=parseInt(Math.random()*99999999);var b=myServerAddress+"MyXMLDispatcher?rand="+c+"&path=24010&parent="+d+"&method=get";a.open("GET",b,true);a.onreadystatechange=function(){if(a.readyState==4){if(a.status==200){renderDms(a)}else{alert("Connection Problem:"+a.statusText)}}};writeWaitMsg(dmsTablecontainer,"themes/icons/ajax_loading/22.gif","Processing request, please wait...");a.send(null)}function renderUploadedFile(){document.getElementById("file_upload_form").target="upload_target";var a=document.getElementById("upload_target");var b=document.getElementById("myRemarks").value;if(navigator.userAgent.indexOf("MSIE")>-1&&!window.opera){a.onreadystatechange=function(){if(a.readyState=="complete"){var g=a.contentWindow.document.body;if(g!=null){var e=a.contentWindow.document.body.childNodes;if(e.length<2){alert("ERROR: File Upload failed")}else{var d=e[0].innerText;var c=e[1].innerText;var f="file";var j=Array();var i=0;j[0]="file";j[1]=""+d;j[2]=c;j[3]=b;j[4]=""+dmsTableCurrentParent;i=getMaxFileRow();var h=document.getElementById(TABLE_NAME);addRowToTable1(h,i,j);reorderRows(h,i)}}}}}else{a.onload=function(){if(true){var g=a.contentWindow.document.body;if(g!=null){var e=g.childNodes;if(e.length<2){alert("ERROR: File Upload failed")}else{var d=""+e[0].innerHTML;var c=""+e[1].innerHTML;var f="file";var j=Array();var i=0;j[0]="file";j[1]=""+d;j[2]=c;j[3]=b;j[4]=""+dmsTableCurrentParent;i=getMaxFileRow();var h=document.getElementById(TABLE_NAME);addRowToTable1(h,i,j);reorderRows(h,i)}}}}}}function openFileUploadWindow(e){var a=24050;var d="uploadReference";var b="<fieldset><legend>Upload File</legend>\n";b+='<form method="post" id="file_upload_form" action="MyActionDispatcher?path='+a+"&method="+d+"&documentId="+e+'" enctype="multipart/form-data" onsubmit="renderUploadedFile();" >\n';b+='<label>File Name:&nbsp;&nbsp;</label><input type="file" size="30" name="fname" class="pgInp"><br>\n';b+='<label>Comments:&nbsp;</label><input type="text" id="myRemarks" size="30" name="fremarks"><br>\n';b+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n";b+='<input type="submit" value="upload" class="btn">\n';b+="</form></fieldset>\n";var c=document.getElementById(uploadWindow);c.innerHTML=b;dmsPropertiesWindowTitle=internalWindow.open("dmsPropertiesWindowTitleId","div",uploadWindow,"#Upload File","width=450px,height=300px,left=200px,top=150px,resize=1,scrolling=1")}function renderDms(b){var c=b.responseXML;if(c==null){alert("Data Error");return}var d=c.getElementsByTagName("status");var a=systemStatus(dmsTablecontainer,d);if(a==0){return}var e="";e+="<div id='"+DIV_NAV_NAME+"'></div>";e+="<table id='"+TABLE_NAME+"' width='100%' class='contentTable'><thead id='"+ctx_THEAD+"'><tr><td width='18px'>&nbsp;</td><td width='1%'>Sl</td><td width='25%'>Name</td><td width='45%'>Description</td><td width='30%'>Remarks</td><td>D</td><td>E</td></tr></thead>";e+="<tbody id='"+ctx_TBODY+"'></tbody></table>";e+='<iframe id="upload_target" name="upload_target" style="display:none;"></iframe>';document.getElementById(dmsTablecontainer).innerHTML=e;updateDmsNav(c,DIV_NAV_NAME);initiateTableRollover(TABLE_NAME,"tableRollOverEffect1","tableRowClickEffect1");populateTable(c,TABLE_NAME);contextMenu.attachTo(ctx_THEAD,menu2());contextMenu.attachTo(ctx_TBODY,menu2())}var updateDmsNav=function(b,a){var d=b.getElementsByTagName("levelParent");var c="<table class='navTable'><tr>";if(d!=null&&d.length>=1){dmsTableparent=d[0].getAttribute("id");c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callDmsAjax("+dmsTableparent+")'><img src='images/utilities/up.png' border='0' alt='Up one level'></a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callDmsAjax("+dmsTableTop+")'><img src='images/utilities/top.png' border='0' alt='Top level'></a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='myDmsAddWindow(\""+TABLE_NAME+'","document");\'>Add Folder</a></td>';c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='openFileUploadWindow("+dmsTableCurrentParent+");'>Add File</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='myDMsEditWindow(\""+TABLE_NAME+"\");'>Edit[E]</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='deleteChecked(\""+TABLE_NAME+"\");'>Delete[D]</a></td>"}else{c+="<td><img src='images/utilities/up1.png' alt='Up one level'></td>";c+="<td><img src='images/utilities/top1.png' alt='Top level'></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='myDmsAddWindow(\""+TABLE_NAME+'","document");\'>Add Folder</a></td>';c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='openFileUploadWindow("+dmsTableCurrentParent+");'>Add File</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='myDMsEditWindow(\""+TABLE_NAME+"\");'>Edit[E]</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='deleteChecked(\""+TABLE_NAME+"\");'>Delete[D]</a></td>";dmsTableparent=1}c+="<td>&nbsp;</td><td align='right'><input type='button' name='search' value='Search' onclick='populateSearchWin();'/></td>";c+="</tr></table>";document.getElementById(a).innerHTML=c};var populateTable=function(e,b){var d=e.getElementsByTagName("document");var a;var f;var g;for(var c=0;c<d.length;c++){f=document.getElementById(b);a=f.tBodies[0].rows.length;g=Array();g[0]="document";g[1]=d[c].childNodes[0].firstChild.data;g[2]=d[c].childNodes[1].firstChild.data;g[3]=d[c].childNodes[2].firstChild.data;g[4]=d[c].childNodes[3].firstChild.data;g[5]=d[c].childNodes[4].firstChild.data;addRowToTable1(f,a,g);reorderRows(f,a)}d=e.getElementsByTagName("file");for(c=0;c<d.length;c++){f=document.getElementById(b);a=f.tBodies[0].rows.length;g=Array();g[0]="file";g[1]=d[c].childNodes[0].firstChild.data;g[2]=d[c].childNodes[1].firstChild.data;g[3]=d[c].childNodes[2].firstChild.data;g[4]=d[c].childNodes[3].firstChild.data;addRowToTable1(f,a,g);reorderRows(f,a)}};var myRowObject=function(b){this.content=Array();for(var a=0;a<b.length;a++){this.content[a]=b[a]}};var addRowToTable1=function(g,h,e){var p=g.tBodies[0].rows.length;var d=p+ROW_BASE;if(h==-1){h=p}else{d=h+ROW_BASE}var q=g.tBodies[0].insertRow(h);if(e[1]==sid){q.className="searchClass"}var o=Array();o[0]=q.insertCell(0);if(e[0]=="document"){o[0].innerHTML="<a href='javascript:void(0);' onclick='callDmsAjax("+e[1]+")'><img src='images/utilities/directory.png' border='0'></a>"}else{o[0].innerHTML="<a href='javascript:void(0);' onclick='downloadFileAction(event);'><img src='images/utilities/reference.png' border='0'></a>"}o[1]=q.insertCell(1);var i=document.createTextNode(d);o[1].appendChild(i);var a;if(e[0]=="document"){o[2]=q.insertCell(2);a=document.createTextNode(e[2]);o[2].appendChild(a)}else{o[2]=q.insertCell(2);a=document.createTextNode(e[2]);o[2].innerHTML="<a href='javascript:void(0);' onclick='downloadFileAction(event);'>"+e[2]+"</a>"}var n;if(e[0]=="document"){o[3]=q.insertCell(3);n=document.createTextNode(e[3]);o[3].appendChild(n)}else{o[3]=q.insertCell(3);n=document.createTextNode("---");o[3].appendChild(n)}var k;if(e[0]=="document"){o[4]=q.insertCell(4);k=document.createTextNode(e[4]);o[4].appendChild(k)}else{o[4]=q.insertCell(4);k=document.createTextNode(e[3]);o[4].appendChild(k)}o[5]=q.insertCell(5);var j=document.createElement("input");j.setAttribute("type","checkbox");o[5].appendChild(j);o[6]=q.insertCell(6);var c;try{c=document.createElement('<input type="radio" name="'+RADIO_NAME+'" value="'+d+'">');var b=c.name.length}catch(l){c=document.createElement("input");c.setAttribute("type","radio");c.setAttribute("name",RADIO_NAME);c.setAttribute("value",d)}o[6].appendChild(c);var f=Array();f[0]=j;f[1]=c;f[2]=o[0].innerHTML;f[3]=i;f[4]=a;f[5]=n;f[6]=e[1];f[7]=e[0];if((e[0]=="document")){f[8]=k;f[9]=e[5]}else{f[8]=k;f[9]=e[4]}var m=new myRowObject(f);q.myRow=m;addRowRolloverEffect(q)};function callDeleteDmsAjax(g,h,d){if(!confirmDelete()){return}var k=getHTMLHTTPRequest();var l=g;var c=h;var e=d;var j=parseInt(Math.random()*99999999);var b="";var m="";for(var f=0;f<h.length;f++){if(h[f].myRow.content[7]=="document"&&b==""){b+=h[f].myRow.content[6]}else{if(h[f].myRow.content[7]=="file"&&m==""){m+=h[f].myRow.content[6]}else{if(h[f].myRow.content[7]=="document"){b+=","+h[f].myRow.content[6]}else{m+=","+h[f].myRow.content[6]}}}}var a=myServerAddress+"MyXMLDispatcher?rand="+j+"&path="+24020+"&dmsId="+URLEncode(b)+"&fileId="+URLEncode(m)+"&method=delete";k.open("GET",a,true);k.onreadystatechange=function(){if(k.readyState==4){if(k.status==200){var n=k.responseXML;var i=0;if(n==null){alert("Data Error")}else{var o=n.getElementsByTagName("status");i=systemStatus(null,o)}if(i==1){deleteRows(c);reorderRows(l,e)}else{if(i==2){alert("DELETE: System Error")}}}else{alert("Connection Problem:"+k.statusText)}closeSplashScreen()}};openSplashScreen();k.send(null)}var deleteChecked=function(d){var f=document.getElementById(d);var a=new Array();var b=0;for(var c=0;c<f.tBodies[0].rows.length;c++){if(f.tBodies[0].rows[c].myRow.content[0].checked){a[b]=f.tBodies[0].rows[c];b++}}if(a.length>0){var e=a[0].sectionRowIndex;callDeleteDmsAjax(f,a,e)}};var deleteRows=function(c){for(var a=0;a<c.length;a++){var b=c[a].sectionRowIndex;c[a].parentNode.deleteRow(b)}};var reorderRows=function(d,c){if(d.tBodies[0].rows[c]){var b=c+ROW_BASE;for(var a=c;a<d.tBodies[0].rows.length;a++){d.tBodies[0].rows[a].myRow.content[3].data=b;b++}}};var deleteContextChecked=function(){var a=new Array();var b=contextMenu.srcElement;while(true){a[0]=b.parentNode;if(a[0].tagName!="TR"){b=a[0];continue}else{break}}var d=a[0].parentNode.parentNode;var c=a[0].sectionRowIndex;callDeleteDmsAjax(d,a,c)};var dmsPropertiesWindowDiv="blankHidden";var dmsPropertiesWindowTitleTitle="Properties";var dmsPropertiesWindowTitleId="dmsPropertiesWindowTitleId";var indexOfRowToEdit=-1;var rowToEdit=null;var myContextDmsEditWindow=function(){indexOfRowToEdit=-1;rowToEdit=null;var a=contextMenu.srcElement;while(true){rowToEdit=a.parentNode;if(rowToEdit.tagName!="TR"){a=rowToEdit;continue}else{break}}if(rowToEdit!=null){populateDmsEditWin()}};var myDMsEditWindow=function(b){var c=document.getElementById(b);indexOfRowToEdit=-1;rowToEdit=null;for(var a=0;a<c.tBodies[0].rows.length;a++){if(c.tBodies[0].rows[a].myRow&&c.tBodies[0].rows[a].myRow.content[1].getAttribute("type")=="radio"&&c.tBodies[0].rows[a].myRow.content[1].checked){indexOfRowToEdit=a;rowToEdit=c.tBodies[0].rows[a]}}if(rowToEdit!=null){populateDmsEditWin()}};var populateDmsEditWin=function(){var a="<table>";if(rowToEdit!=null){if(rowToEdit.myRow.content[7]=="document"){a+="<tr><td><label>Name:</label></td><td><input size='40' type='text' id='editName' value='"+rowToEdit.myRow.content[4].data+"'></td></tr>";a+="<tr><td><label>Specification:</label></td><td><textarea rows='6' cols='30' id='editDescription'>"+rowToEdit.myRow.content[5].data+"</textarea></td></tr>";a+="<tr><td><label>Remarks:</label></td><td><textarea rows='6' cols='30' id='editRemarks'>"+rowToEdit.myRow.content[8].data+"</textarea></td></tr>";a+="<tr><td colspan='2' align='center'><a href='javascript:void(0)' onclick='callEditDmsAjax();'>Update</a>&nbsp;&nbsp;";a+="<a href='javascript:void(0)' onclick='dmsPropertiesWindowTitle.close()'>Discard</a></td></tr>"}else{a+="<tr><td><label>Name(not editable):</label></td><td><input size='40' type='text' id='editName' value='"+rowToEdit.myRow.content[4].data+"' readonly='true'></td></tr>";a+="<tr><td><label>Remarks:</label></td><td><textarea rows='6' cols='30' id='editRemarks'>"+rowToEdit.myRow.content[8].data+"</textarea></td></tr>";a+="<tr><td colspan='2' align='center'><a href='javascript:void(0)' onclick='callEditDmsAjax();'>Update</a>&nbsp;&nbsp;";a+="<a href='javascript:void(0)' onclick='dmsPropertiesWindowTitle.close()'>Discard</a></td></tr>"}}a+="</table>";var b=document.getElementById(dmsPropertiesWindowDiv);b.innerHTML=a;openMyDmsPropertiesWin()};var openMyDmsPropertiesWin=function(){dmsPropertiesWindowTitle=internalWindow.open("dmsPropertiesWindowTitleId","div",dmsPropertiesWindowDiv,"#Properties Window","width=450px,height=350px,left=200px,top=150px,resize=1,scrolling=1")};var myDmsUpdateData="";var myDmsEditRequest=getHTMLHTTPRequest();var callEditDmsAjax=function(){var c=parseInt(Math.random()*99999999);var b="";var d;if(rowToEdit.myRow.content[7]=="document"){d="updateDms";b="id="+rowToEdit.myRow.content[6];b+="&name="+URLEncode(document.getElementById("editName").value);b+="&description="+URLEncode(document.getElementById("editDescription").value);b+="&remarks="+URLEncode(document.getElementById("editRemarks").value)}else{d="updateFile";b="id="+rowToEdit.myRow.content[6];b+="&name="+URLEncode(document.getElementById("editName").value);b+="&remarks="+URLEncode(document.getElementById("editRemarks").value)}var a=myServerAddress+"MyXMLDispatcher?rand="+c+"&path="+24030+"&method="+d;myDmsEditRequest.open("POST",a,true);myDmsEditRequest.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8");myDmsEditRequest.setRequestHeader("Content-length",b.length);myDmsEditRequest.onreadystatechange=upadtedmsAction;openSplashScreen();myDmsEditRequest.send(b)};function upadtedmsAction(){if(myDmsEditRequest.readyState==4){if(myDmsEditRequest.status==200){var b=myDmsEditRequest.responseXML;var a=0;if(b==null){alert("Data Error")}else{var c=b.getElementsByTagName("status");a=systemStatus(null,c)}if(a==1){if(rowToEdit.myRow.content[7]=="document"){rowToEdit.myRow.content[4].data=document.getElementById("editName").value;rowToEdit.myRow.content[5].data=document.getElementById("editDescription").value;rowToEdit.myRow.content[8].data=document.getElementById("editRemarks").value}else{rowToEdit.myRow.content[4].data=document.getElementById("editName").value;rowToEdit.myRow.content[8].data=document.getElementById("editRemarks").value}}else{if(a==2){alert("EDIT: System Error")}}dmsPropertiesWindowTitle.close()}else{alert("Connection Problem:"+myDmsEditRequest.statusText);dmsPropertiesWindowTitle.close()}closeSplashScreen()}}var myDmsTable=null;var myDmsAddWindow=function(a,b){var c=document.getElementById(a);myDmsTable=c;populateDmsAddWin(b)};var populateDmsAddWin=function(b){var a="<table>";if(b=="document"){a+="<tr><td><label>Name:</label></td><td><input size='40' type='text' id='editName' value='name'></td></tr>";a+="<tr><td><label>Specification:</label></td><td><textarea rows='6' cols='30' id='editDescription'>specification</textarea></td></tr>";a+="<tr><td><label>Remarks:</label></td><td><textarea rows='6' cols='30' id='editRemarks'>remarks</textarea></td></tr>";a+="<tr><td colspan='2' align='center'><a href='javascript:void(0)' onclick='callAddDmsAjax(\""+b+"\");'>Add</a>&nbsp;&nbsp;";a+="<a href='javascript:void(0)' onclick='dmsPropertiesWindowTitle.close()'>Discard</a></td></tr>"}else{return}a+="</table>";var c=document.getElementById(dmsPropertiesWindowDiv);c.innerHTML=a;openMyDmsPropertiesWin()};var myDmsAddData="";var myDmsAddRequest=getHTMLHTTPRequest();var callAddDmsAjax=function(b){var c=parseInt(Math.random()*99999999);if(b=="document"){method="addDms";myDmsAddData="id="+dmsTableCurrentParent;myDmsAddData+="&name="+URLEncode(document.getElementById("editName").value);myDmsAddData+="&description="+URLEncode(document.getElementById("editDescription").value);myDmsAddData+="&remarks="+URLEncode(document.getElementById("editRemarks").value)}else{return}var a=myServerAddress+"MyXMLDispatcher?rand="+c+"&path="+24040+"&method="+method;myDmsAddRequest.open("POST",a,true);myDmsAddRequest.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8");myDmsAddRequest.setRequestHeader("Content-length",myDmsAddData.length);myDmsAddRequest.onreadystatechange=addDmsAction;openSplashScreen();myDmsAddRequest.send(myDmsAddData)};function addDmsAction(){if(myDmsAddRequest.readyState==4){if(myDmsAddRequest.status==200){var d=myDmsAddRequest.responseXML;var a=0;if(d==null){alert("Data Error")}else{var e=d.getElementsByTagName("status");a=systemStatus(null,e)}if(a==1){var b=d.getElementsByTagName("key")[0].getAttribute("value");var c=d.getElementsByTagName("key")[0].getAttribute("type");var g=Array();var f=0;if(c=="document"){g[0]="document";g[1]=""+b;g[2]=document.getElementById("editName").value;g[3]=document.getElementById("editDescription").value;g[4]=document.getElementById("editRemarks").value;g[5]=""+dmsTableCurrentParent;f=getMaxDmsRow()}addRowToTable1(myDmsTable,f,g);reorderRows(myDmsTable,f)}else{if(a==2){alert("ADD: System Error")}}dmsPropertiesWindowTitle.close()}else{alert("Connection Problem:"+myDmsAddRequest.statusText);dmsPropertiesWindowTitle.close()}closeSplashScreen()}}var getMaxFileRow=function(){var b=document.getElementById(TABLE_NAME);var c=-1;for(var a=0;a<b.tBodies[0].rows.length;a++){if(b.tBodies[0].rows[a].myRow.content[7]=="document"&&c<=a){c=a}}for(a=0;a<b.tBodies[0].rows.length;a++){if(b.tBodies[0].rows[a].myRow.content[7]=="file"&&c<=a){c=a}}return c+1};var getMaxDmsRow=function(){var b=document.getElementById(TABLE_NAME);var c=-1;for(var a=0;a<b.tBodies[0].rows.length;a++){if(b.tBodies[0].rows[a].myRow.content[7]=="document"&&c<=a){c=a}}return c+1};var downloadFileAction=function(d){var c=d;var f;var b;if(c.target){f=c.target.parentNode}else{if(c.srcElement){f=c.srcElement.parentNode}}while(f.tagName!="TR"){f=f.parentNode}var g=f.sectionRowIndex;b=f.parentNode.parentNode;var a=f.myRow.content[6];window.open("MyActionDispatcher?path=24060&fileId="+a+"&method=downloadFile")};var myParamsForMovableItem=new Array();var cutContextSelected=function(){myMoveAction.reInit();var c=null;var b=contextMenu.srcElement;while(true){c=b.parentNode;if(c.tagName!="TR"){b=c;continue}else{break}}var a=new Array();if(c.myRow.content[7]=="document"){myMoveAction.cut("document",c.myRow.content[6],c.myRow.content[9]);a[0]="document";a[1]=""+c.myRow.content[6];a[2]=""+c.myRow.content[4].data;a[3]=""+c.myRow.content[5].data;a[4]=""+c.myRow.content[8].data;a[5]=""+c.myRow.content[9]}else{if(c.myRow.content[7]=="file"){myMoveAction.cut("file",c.myRow.content[6],c.myRow.content[9]);a[0]="file";a[1]=""+c.myRow.content[6];a[2]=""+c.myRow.content[4].data;a[3]=""+c.myRow.content[8].data;a[4]=""+c.myRow.content[9]}}myMoveAction.initParams(a)};var callPasteToLocationAjax=function(){myMoveAction.verify=function(){if(this.movableItemType=="document"){if(this.movableItemId==this.movableToParentId){alert("Cannot move selected to it's own subtree");return false}if(this.movableFromCurrentParentId==this.movableToParentId){alert("Please chose a different location");return false}}else{if(this.movableItemType=="file"){if(this.movableFromCurrentParentId==this.movableToParentId){alert("Please chose a different location");return false}}}return true};if(myMoveAction.paste(dmsTableCurrentParent)==false){return}var h=""+myMoveAction.movableItemId;var c=""+myMoveAction.movableItemType;var a=""+myMoveAction.movableFromCurrentParentId;var d=""+myMoveAction.movableToParentId;var g=myMoveAction.paramArray;if(c=="file"){g[4]=d}else{if(c=="document"){g[5]=d}}var f=getHTMLHTTPRequest();var e=parseInt(Math.random()*99999999);var b=myServerAddress+"MyXMLDispatcher?rand="+e+"&path="+24070+"&id="+h+"&pid="+a+"&newPid="+d+"&method="+c;f.open("GET",b,true);f.onreadystatechange=function(){if(f.readyState==4){if(f.status==200){var j=f.responseXML;var i=0;if(j==null){alert("Data Error")}else{var k=j.getElementsByTagName("status");i=systemStatus(null,k)}if(i==1){myCbCatTable=document.getElementById(TABLE_NAME);if(c=="file"){addRowToTable1(document.getElementById(TABLE_NAME),getMaxFileRow(),g)}else{if(c=="document"){addRowToTable1(document.getElementById(TABLE_NAME),getMaxDmsRow(),g)}}}else{if(i==2){alert("Move: System Error")}}}else{alert("Connection Problem:"+f.statusText)}myMoveAction.reInit();closeSplashScreen()}};openSplashScreen();f.send(null)};var populateSearchWin=function(){var a="<table>";a+="<tr><td><label>Enter keyword:</label></td><td><input size='40' type='text' id='searchKey' value=''></td><td><input type='button' value='GO' onclick='vaildateKey();'></td></tr>";a+="</table>";a+="<div id='searchResult'>&nbsp;</div>";var b=document.getElementById("blankHidden1");b.innerHTML=a;openSearchWin()};var openSearchWin=function(){projectPropertiesWindow=internalWindow.open("searchWindow","div","blankHidden1","Search CostBooks","width=600px,height=400px,left=200px,top=150px,resize=1,scrolling=1")};function vaildateKey(){key=document.getElementById("searchKey").value;if(key.length<3){alert("Enter Minimum 3 Character");return}else{callSearchDmsAjax()}}function callSearchDmsAjax(){var a=getHTMLHTTPRequest();var d=parseInt(Math.random()*99999999);var c=URLEncode(key);var b=myServerAddress+"MyXMLDispatcher?rand="+d+"&path="+24010+"&key="+c+"&method=searchCostBook";a.open("GET",b,true);a.onreadystatechange=function(){if(a.readyState==4){if(a.status==200){renderSearch(a)}else{alert("Connection Problem:"+a.statusText)}}};writeWaitMsg("searchResult","themes/icons/ajax_loading/22.gif","Processing request, please wait...");a.send(null)}function renderSearch(c){var d=c.responseXML;if(d==null){alert("Data Error");return}var f=d.getElementsByTagName("status");var a=systemStatus("searchResult",f);if(a==0){return}var b="";b+="<table id='searchTable' width='100%' class='contentTable'><thead><tr><td width='18px'>&nbsp;</td><td width='1%'>Sl</td><td width='25%'>Name</td><td width='45%'>Description</td><td width='30%'>Remarks</td></tr></thead>";b+="<tbody id='searchbody'></tbody></table>";document.getElementById("searchResult").innerHTML=b;populateSearchTable(d,"searchTable");var e=document.getElementById("searchResult").innerHTML;document.getElementById("searchResult").innerHTML=doHighlight(e,key);addTableRolloverEffect("searchTable","tableRollOverEffect2","tableRowClickEffect2")}var populateSearchTable=function(e,b){var d=e.getElementsByTagName("document");var a;var f;var g;for(var c=0;c<d.length;c++){f=document.getElementById(b);a=f.tBodies[0].rows.length;g=Array();g[0]="document";g[1]=d[c].childNodes[0].firstChild.data;g[2]=d[c].childNodes[1].firstChild.data;g[3]=d[c].childNodes[2].firstChild.data;g[4]=d[c].childNodes[3].firstChild.data;g[5]=d[c].childNodes[4].firstChild.data;addRowToSearchTable(f,a,g)}d=e.getElementsByTagName("file");for(c=0;c<d.length;c++){f=document.getElementById(b);a=f.tBodies[0].rows.length;g=Array();g[0]="file";g[1]=d[c].childNodes[0].firstChild.data;g[2]=d[c].childNodes[1].firstChild.data;g[3]=d[c].childNodes[2].firstChild.data;g[4]=d[c].childNodes[3].firstChild.data;addRowToSearchTable(f,a,g)}};var addRowToSearchTable=function(d,e,c){var j=d.tBodies[0].rows.length;var b=j+ROW_BASE;if(e==-1){e=j}else{b=e+ROW_BASE}var k=d.tBodies[0].insertRow(e);var i=Array();i[0]=k.insertCell(0);if(c[0]=="document"){i[0].innerHTML="<a href='javascript:void(0);' onclick='sid="+c[1]+";callDmsAjax("+c[5]+")'><img src='images/utilities/directory.png' border='0'></a>"}else{i[0].innerHTML="<a href='javascript:void(0);' onclick='sid="+c[1]+";callDmsAjax("+c[4]+")'><img src='images/utilities/reference.png' border='0'></a>"}i[1]=k.insertCell(1);var f=document.createTextNode(b);i[1].appendChild(f);var a;if(c[0]=="document"){i[2]=k.insertCell(2);a=document.createTextNode(c[2]);i[2].appendChild(a)}else{i[2]=k.insertCell(2);a=document.createTextNode(c[2]);i[2].appendChild(a)}var h;if(c[0]=="document"){i[3]=k.insertCell(3);h=document.createTextNode(c[3]);i[3].appendChild(h)}else{i[3]=k.insertCell(3);h=document.createTextNode("---");i[3].appendChild(h)}var g;if(c[0]=="document"){i[4]=k.insertCell(4);g=document.createTextNode(c[4]);i[4].appendChild(g)}else{i[4]=k.insertCell(4);g=document.createTextNode(c[3]);i[4].appendChild(g)}};initializeDocumentsTable(10140);