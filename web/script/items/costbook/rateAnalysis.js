var INPUT_NAME_PREFIX="inputName";var RADIO_NAME="radName";var TABLE_NAME="rateAnalysisSample";var DIV_NAV_NAME="rateAnalysisNavDiv";var ROW_BASE=1;var hasLoaded=false;var ctx_THEAD="RATES_TTHEAD123";var ctx_TBODY="RATES_TTBODY123";var key="qwerty";var searchFlag=false;var key1="qwerty";var searchFlag1=false;var key2="qwerty";var searchFlag2=false;var contextMenu=null;contextMenu=new DHTMLSuite.contextMenu();contextMenu.setWidth(140);var callBack=function(){if(myContextMenuRequest.readyState==4){if(myContextMenuRequest.status==200){configureContextMenu(myContextMenuRequest);openCostBookOptionsWindow()}else{alert("Connection Problem:"+myContextMenuRequest.statusText)}}};var initializeAnalysisTable=function(a){myCurrentMenuParent=a;writeWaitMsg(ratesManagerContainer,"themes/icons/ajax_loading/22.gif","Loading Menu...");callContextMenuAjax(a,callBack)};var menu2=function(){return configureContextMenuModel()};contextMenu.modifyMenu=function(){var a=this.srcElement;currentMenuBar=this.menuBar;var b;while(true){b=a.parentNode;if(b.tagName!="TR"){a=b;continue}else{break}}clickOnTableRowContext(b);var c=b.parentNode.parentNode;var d=c.parentNode;if(d.getAttribute("matRef")!=null&&d.getAttribute("matRef")!=""){hideMenuItem(210510);hideMenuItem(210520);hideMenuItem(210540);hideMenuItem(210590);hideMenuItem(210600);hideMenuItem(210610);hideMenuItem(210620);showMenuItem(210550);showMenuItem(210560);showMenuItem(210570);showMenuItem(210580);if(b.myRow==null||b.myRow.content[9]==0||b.myRow.content[5].parentNode.childNodes[2]!=null){hideMenuItem(210570);hideMenuItem(210580)}}else{if(d.getAttribute("ovhRef")!=null&&d.getAttribute("ovhRef")!=""){hideMenuItem(210510);hideMenuItem(210520);hideMenuItem(210540);hideMenuItem(210550);hideMenuItem(210560);hideMenuItem(210570);hideMenuItem(210580);showMenuItem(210590);showMenuItem(210600);showMenuItem(210610);showMenuItem(210620);if(b.myRow==null||b.myRow.content[8]==0||b.myRow.content[4].parentNode.childNodes[2]!=null){hideMenuItem(210610);hideMenuItem(210620)}}else{showMenuItem(210510);showMenuItem(210520);showMenuItem(210540);if(b.myRow==null){setMenuItemState(210540,"disabled")}else{if(b.myRow.content[7].data!=""){setMenuItemState(210540,"regular")}else{setMenuItemState(210540,"disabled")}}hideMenuItem(210550);hideMenuItem(210560);hideMenuItem(210570);hideMenuItem(210580);hideMenuItem(210590);hideMenuItem(210600);hideMenuItem(210610);hideMenuItem(210620);if(assemblyTableCurrentParent==1){setMenuItemState(210510,"disabled");setMenuItemState(210520,"disabled")}else{if(assemblyTableCurrentParent==0){setMenuItemState(210510,"disabled");setMenuItemState(210520,"regular")}else{setMenuItemState(210510,"regular");setMenuItemState(210520,"regular")}}}}setMenuPermissions(currentMenuBar,null)};var costBookId;var ratesManagerContainer="blankContent";var ratesOptionsContainer="ratesOptions";var ratesInnnerContainer="innerRATESContainer";var openCostBookOptionsWindow=function(){var a=document.getElementById(ratesManagerContainer);a.innerHTML="<div id='"+ratesOptionsContainer+"'><a href='javascript:void(0);' onclick='openAssemblyCostTable();'>Assemblies</a>&nbsp;&nbsp;<a href='javascript:void(0);' onclick='openMaterialCostTable();'>Resources</a></div><br><div id='"+ratesInnnerContainer+"'>Please click on one of the options above</div>"};var myRowObject=function(b){this.content=Array();for(var a=0;a<b.length;a++){this.content[a]=b[a]}};var deleteRows=function(c){for(var a=0;a<c.length;a++){var b=c[a].sectionRowIndex;c[a].parentNode.deleteRow(b)}};var reorderRows=function(d,c){if(d.tBodies[0].rows[c]){var b=c+ROW_BASE;for(var a=c;a<d.tBodies[0].rows.length;a++){d.tBodies[0].rows[a].myRow.content[3].data=b;b++}}};var assemblyTableparent=1;var assemblyTableTop=1;var assemblyTableCurrentParent=1;var analysisTableContainer=ratesInnnerContainer;var asmAnalysisWindow=null;var importWindow=null;var openAssemblyCostTable=function(){callAssemblyAjax(1)};function callAssemblyAjax(d){if(document.getElementById(analysisTableContainer)==null){return}if(asmAnalysisWindow!=null){asmAnalysisWindow.close()}var b=getHTMLHTTPRequest();assemblyTableCurrentParent=d;var c=parseInt(Math.random()*99999999);var a=myServerAddress+"MyXMLDispatcher?rand="+c+"&path="+20250+"&parent="+d+"&cbId="+costBookId+"&method=getAssemblyCost";b.open("GET",a,true);b.onreadystatechange=function(){if(b.readyState==4){if(b.status==200){renderAssembly(b)}else{alert("Connection Problem:"+b.statusText)}}};writeWaitMsg(analysisTableContainer,"themes/icons/ajax_loading/22.gif","Loading page, please wait...");b.send(null)}function renderAssembly(b){var c=b.responseXML;if(c==null){alert("Data Error");return}var d=c.getElementsByTagName("status");var a=systemStatus(analysisTableContainer,d);if(a==0){return}var e="";e+="<div id='"+DIV_NAV_NAME+"'></div>";e+="<table id='"+TABLE_NAME+"' width='97%' class='contentTable'><thead id='"+ctx_THEAD+"'><tr><td width='18px'>&nbsp;</td><td width='1%'>Sl</td><td width='15%'>Name</td><td width='70%'>Description</td><td>Price</td></tr></thead>";e+="<tbody id='"+ctx_TBODY+"'></tbody></table>";document.getElementById(analysisTableContainer).innerHTML=e;updateAssemblyNav(c,DIV_NAV_NAME);populateAssemblyTable(c,TABLE_NAME);addTableRolloverEffect(TABLE_NAME,"tableRollOverEffect1","tableRowClickEffect1");contextMenu.attachTo(ctx_THEAD,menu2(0));contextMenu.attachTo(ctx_TBODY,menu2(0))}var updateAssemblyNav=function(b,a){var d=b.getElementsByTagName("levelParent");var c="<table class='innerNavTable'><tr>";if(d!=null&&d.length>=1){assemblyTableparent=d[0].getAttribute("id");c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callAssemblyAjax("+assemblyTableparent+")'><img src='images/assembly/up.png' border='0' alt='Up one level'></a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callAssemblyAjax("+assemblyTableTop+")'><img src='images/assembly/top.png' border='0' alt='Top level'></a></td>"}else{if(searchFlag==false){c+="<td><img src='images/assembly/up1.png' alt='Up one level'></td>";c+="<td><img src='images/assembly/top1.png' alt='Top level'></td>";assemblyTableparent=1}else{c+="<td><img src='images/assembly/up1.png' alt='Up one level'></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callAssemblyAjax("+assemblyTableTop+")'><img src='images/assembly/top.png' border='0' alt='Top level'></a></td>";searchFlag=false;assemblyTableparent=1}}c+="<td><label>Enter keyword:</label></td><td><input size='40' type='text' id='searchKeyForAssembly' value=''></td><td><input type='button' value='GO' onclick='vaildateKey2();'></td>";c+="</tr></table>";document.getElementById(a).innerHTML=c};var populateAssemblyTable=function(e,b){var d=e.getElementsByTagName("item");for(var c=0;c<d.length;c++){var f=document.getElementById(b);var a=f.tBodies[0].rows.length;var g=Array();g[0]=d[c].childNodes[0].firstChild.data;g[1]=d[c].childNodes[1].firstChild.data;g[2]=d[c].childNodes[2].firstChild.data;g[3]=d[c].childNodes[3].firstChild.data;g[4]=d[c].childNodes[4].firstChild.data;g[5]=d[c].childNodes[5].firstChild.data;g[6]=d[c].childNodes[6].firstChild.data;g[7]=d[c].childNodes[7].firstChild.data;g[8]=d[c].childNodes[8].firstChild.data;g[9]=d[c].childNodes[9].firstChild.data;g[10]=d[c].childNodes[10].firstChild.data;g[11]=d[c].childNodes[10].firstChild.data;addRowToTable2(f,a,g);reorderRows(f,a)}};var addRowToTable2=function(f,k,j){var o=f.tBodies[0].rows.length;var b=o+ROW_BASE;if(k==-1){k=o}else{b=k+ROW_BASE}var h=f.tBodies[0].insertRow(k);var r=(j[3]=="--");var e=Array();e[0]=h.insertCell(0);if(r){e[0].innerHTML="<a href='javascript:void(0);' onclick='callAssemblyAjax("+j[0]+")'><img src='images/assembly/folder.gif' border='0' width='16' height='16'></a>"}else{e[0].innerHTML="<img src='images/assembly/item.png' border='0' width='16' height='16'>"}e[1]=h.insertCell(1);var d=document.createTextNode(b);e[1].appendChild(d);e[2]=h.insertCell(2);var s=document.createTextNode(j[1]);e[2].appendChild(s);e[3]=h.insertCell(3);var q=document.createTextNode(j[2]);e[3].appendChild(q);e[4]=h.insertCell(4);var c=document.createElement("input");c.setAttribute("type","text");c.setAttribute("size","10");c.setAttribute("value",j[8]);if(r){c.style.display="none"}e[4].appendChild(c);var l=document.createElement("span");l.appendChild(document.createTextNode(j[8]));l.style.display="none";e[4].appendChild(l);if(!r){e[4].appendChild(document.createElement("br"))}var m;var n;var p;if(r){m=document.createTextNode("");n=document.createTextNode("");p=document.createTextNode("-")}else{m=document.createTextNode(j[3]);n=document.createTextNode("/");p=document.createTextNode(j[4])}e[4].appendChild(p);e[4].appendChild(n);e[4].appendChild(m);var g=Array();g[0]=0;g[1]=0;g[2]=e[0].innerHTML;g[3]=d;g[4]=s;g[5]=q;g[6]=j[0];g[7]=m;g[8]=p;g[9]=0;g[10]=j[6];g[11]=j[7];g[12]=c;var a=new myRowObject(g);h.myRow=a};var myAsmRow=null;var asmId=0;var multiplier=1;var sumTotal="0";var overheadTotal="0";var anlyzContainerDiv="blankHidden1";var anlyzInnerDivPrefix="anlyzInnerDivPrefix";var anlyzWindowIdPrefix="anlyzWindowIdPrefix";var INNER_TABLE_NAME_PREFIX="innerTableNamePrefix";var INNER_NAV_DIV_PREFIX="innerNavDivPrefix";var importFlag=0;var importWindowId="importWindowId";var initAnalysisWin=function(c){myAsmRow=null;if(c==true){var a=contextMenu.srcElement;var b;while(true){b=a.parentNode;if(b.tagName!="TR"){a=b;continue}else{break}}myAsmRow=b}if(myAsmRow!=null){openAddAnalysisWin()}};var openAddAnalysisWin=function(){asmId=myAsmRow.myRow.content[6];var a=myAsmRow.myRow.content[4].data;var b="<table width='97%' class='innerContentTable'><tr class='classcb'><td align='left'><b>Toggle: </b><a href='javascript:void(0)' onClick='callShowRateAnlysisAjax()'>Resources</a>/<a href='javascript:void(0)' onClick='callShowOverheadsAjax()'>Overheads</a></td></tr></table>";b+="<div id='"+anlyzInnerDivPrefix+"' class='smallText'>Select One of the options above...</div>";document.getElementById(anlyzContainerDiv).innerHTML=b;var c=internalWindow.open(anlyzWindowIdPrefix,"div",anlyzContainerDiv,"Analysis of Rate for: "+a,"width=850px,height=500px,left=5px,top=5px,resize=1,scrolling=1");c.onclose=function(){if(importWindow!=null){importWindow.close()}return true};asmAnalysisWindow=c};var callShowRateAnlysisAjax=function(){importFlag=1;if(document.getElementById(anlyzInnerDivPrefix)==null){return}var a=getHTMLHTTPRequest();var c=parseInt(Math.random()*99999999);var b=myServerAddress+"MyXMLDispatcher?rand="+c+"&path="+20261+"&costBookId="+costBookId+"&asmId="+asmId+"&method=getAnalysis";a.open("GET",b,true);a.onreadystatechange=function(){if(a.readyState==4){if(a.status==200){renderRateAnlysis(a)}else{alert("Connection Problem:"+a.statusText)}}};writeWaitMsg(anlyzInnerDivPrefix,"themes/icons/ajax_loading/22.gif","Loading page, please wait...");a.send(null)};var renderRateAnlysis=function(d){var e=d.responseXML;if(e==null){alert("Data Error");return}var f=e.getElementsByTagName("status");var c=systemStatus(anlyzInnerDivPrefix,f);if(c==0){return}var b=e.getElementsByTagName("assembly");if(b!=null&&b.length>0){multiplier=b[0].getAttribute("multiplier");sumTotal=b[0].getAttribute("sumTotal");var a=document.getElementById(anlyzInnerDivPrefix);a.setAttribute("ovhRef","");a.setAttribute("matRef",asmId);var g="<div id='"+INNER_NAV_DIV_PREFIX+"'></div>";g+="<table width='97%' class='innerContentTable'><tr class='classcb' id='ANA'><td align='right'>Analysis for <span id='multi'>"+multiplier+"</span> "+myAsmRow.myRow.content[7].data+"  <a href='javascript:void(0);' id='change' onClick='editMultiplier(event,\"change\");'>Change</a> <a href='javascript:void(0);' style='display:none;' id='edit' onclick='editMultiplier(event,\"edit\");'><img src='images/common/tick.gif' border='0'></a> <a href='javascript:void(0);' id='discard' style='display:none;' onclick='editMultiplier(event,\"discard\");'><img src='images/common/cross.gif' border='0'></a></td></tr></table>";g+="<table width='97%' class='innerContentTable' id='"+INNER_TABLE_NAME_PREFIX+"'><thead id='ANATHEAD'><tr><td width='16px'>&nbsp;</td><td width='16px'>Sl</td><td>ID</td><td width='60%'>Description</td><td>Volume</td><td>Price</td><td align='right'>Total</td><td width='10px'>D</td></tr></thead><tbody id='ANATBODY'></tbody></table>";g+="<table width='97%' class='innerContentTable'><tr class='classcb'><td align='left'><b>Total:</b>&nbsp;<span id='sumTotal'>"+sumTotal+"</span></td></tr></table>";a.innerHTML=g;contextMenu.attachTo("ANA",menu2(asmId));contextMenu.attachTo("ANATHEAD",menu2(asmId));contextMenu.attachTo("ANATBODY",menu2(asmId));updateAnalysisNav(e,INNER_NAV_DIV_PREFIX,INNER_TABLE_NAME_PREFIX);initiateTableRollover(INNER_TABLE_NAME_PREFIX,"tableRollOverEffect1","tableRowClickEffect1");populateAnalysisTable(e,INNER_TABLE_NAME_PREFIX)}else{var c=systemStatus(null,f);if(c==0){return}}};var updateAnalysisNav=function(b,d,a){var c="<table class='innerNavTable'><tr>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='initMaterialWin();'>Add New</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='initImportAnalysisWin();'>Import[CostBook]</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='initAssemblyImportWin();'>Import[Assemblies]</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='editCheckedMaterialsBox(\""+a+"\");'>Edit[D]</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='deleteMaterialsChecked(\""+a+"\");'>Delete[D]</a></td>";c+="</tr></table>";document.getElementById(d).innerHTML=c};var populateAnalysisTable=function(f,c){var b=c;var e=f.getElementsByTagName("entry");for(var d=0;d<e.length;d++){var g=document.getElementById(b);var a=g.tBodies[0].rows.length;var h=Array();h[0]=e[d].childNodes[0].firstChild.data;h[1]=e[d].childNodes[1].firstChild.data;h[2]=e[d].childNodes[2].firstChild.data;h[3]=e[d].childNodes[3].firstChild.data;h[4]=e[d].childNodes[4].firstChild.data;h[5]=e[d].childNodes[5].firstChild.data;h[6]=e[d].childNodes[6].firstChild.data;h[7]=e[d].childNodes[7].firstChild.data;addRowToTable4(g,a,h)}};var addRowToTable4=function(f,g,c){var q=f.tBodies[0].rows.length;var b=q+ROW_BASE;if(g==-1){g=q}else{b=g+ROW_BASE}var r=f.tBodies[0].insertRow(g);var o=Array();o[0]=r.insertCell(0);o[0].innerHTML="<img src='images/project/job.gif' border='0'>";o[1]=r.insertCell(1);var j=document.createTextNode(b);o[1].appendChild(j);o[2]=r.insertCell(2);var a=document.createTextNode(c[0]);o[2].appendChild(a);o[3]=r.insertCell(3);var n=document.createTextNode(c[3]);o[3].appendChild(n);o[4]=r.insertCell(4);o[4].setAttribute("align","right");var d=getTextBox(10,c[5]);d.style.display="none";var p=document.createTextNode(c[5]);o[4].appendChild(d);o[4].appendChild(p);o[5]=r.insertCell(5);var h=document.createTextNode(c[6]+"/"+c[4]);o[5].appendChild(h);o[6]=r.insertCell(6);o[6].setAttribute("align","right");var m=document.createTextNode(c[7]);o[6].appendChild(m);o[7]=r.insertCell(7);var k=document.createElement("input");k.setAttribute("type","checkbox");o[7].appendChild(k);var e=Array();e[0]=k;e[1]=0;e[2]=o[0].innerHTML;e[3]=j;e[4]=n;e[5]=p;e[6]=d;e[7]=c[6];e[8]=m;e[9]=c[0];e[10]=c[1];e[11]=c[2];e[12]=a;var l=new myRowObject(e);r.myRow=l;addRowRolloverEffect(r)};var getTextBox=function(b,c){var a=document.createElement("input");a.setAttribute("type","text");a.setAttribute("size",b);a.setAttribute("value",c);return a};var editMultiplier=function(b,a){if(a=="change"){document.getElementById("multi").innerHTML="<input id='editRateMultiplier' type='text' size='5' value='"+multiplier+"'>";document.getElementById("change").style.display="none";document.getElementById("edit").style.display="";document.getElementById("discard").style.display=""}if(a=="discard"){document.getElementById("multi").innerHTML=""+multiplier+"";document.getElementById("change").style.display="";document.getElementById("edit").style.display="none";document.getElementById("discard").style.display="none"}if(a=="edit"){callEditMultiplierAjax(document.getElementById("editRateMultiplier").value)}};var callEditMultiplierAjax=function(c){var b=getHTMLHTTPRequest();var d=parseInt(Math.random()*99999999);var a=myServerAddress+"MyXMLDispatcher?rand="+d+"&path="+20283+"&asmId="+asmId+"&cbId="+costBookId+"&multiplier="+c+"&method=updateRateMultiplier";b.open("GET",a,true);b.onreadystatechange=function(){if(b.readyState==4){if(b.status==200){var f=b.responseXML;var e=0;var g;if(f==null){alert("Data Error")}else{g=f.getElementsByTagName("status");e=systemStatus(null,g)}if(e==1){multiplier=c;myAsmRow.myRow.content[12].value=""+g[0].getAttribute("gross")+""}else{if(e==2){alert("EDIT: System Error")}}document.getElementById("multi").innerHTML=""+multiplier+"";document.getElementById("change").style.display="";document.getElementById("edit").style.display="none";document.getElementById("discard").style.display="none"}else{alert("Connection Problem:"+b.statusText)}closeSplashScreen()}};openSplashScreen();b.send(null)};var toggleElementVisibility=function(b){var a=document.getElementById(b);if(document.getElementById("change").style.display==""){document.getElementById("change").style.display="none"}else{document.getElementById("change").style.display=""}};function callDeleteMatAjax(h,g,e){if(!confirmDelete()){return}var d=getHTMLHTTPRequest();var f=parseInt(Math.random()*99999999);var c="";for(var b=0;b<g.length;b++){if(b==0){c+=g[b].myRow.content[9]}else{c+=","+g[b].myRow.content[9]}}var a=myServerAddress+"MyXMLDispatcher?rand="+f+"&path="+20271+"&id="+URLEncode(c)+"&method=deleteSelectedMats";d.open("GET",a,true);d.onreadystatechange=function(){if(d.readyState==4){if(d.status==200){var k=d.responseXML;var j=0;var l;if(k==null){alert("Data Error")}else{l=k.getElementsByTagName("status");j=systemStatus(null,l)}if(j==1){myAsmRow.myRow.content[12].value=""+l[0].getAttribute("gross")+"";document.getElementById("sumTotal").innerHTML=""+l[0].getAttribute("sumTotal")+"";deleteRows(g);reorderRows(h,e)}else{if(j==2){alert("DELETE: System Error")}}}else{alert("Connection Problem:"+d.statusText)}closeSplashScreen()}};openSplashScreen();d.send(null)}var deleteMaterialsChecked=function(d){var f=document.getElementById(d);var a=new Array();var b=0;for(var c=0;c<f.tBodies[0].rows.length;c++){if(f.tBodies[0].rows[c].myRow.content[0].checked){a[b]=f.tBodies[0].rows[c];b++}}if(a.length>0){var e=a[0].sectionRowIndex;callDeleteMatAjax(f,a,e)}};var deleteContextMaterialsChecked=function(){var a=new Array();var b=contextMenu.srcElement;while(true){a[0]=b.parentNode;if(a[0].tagName!="TR"){b=a[0];continue}else{break}}var d=a[0].parentNode.parentNode;var c=a[0].sectionRowIndex;callDeleteMatAjax(d,a,c)};var editContextMaterialsBox=function(){var a=contextMenu.srcElement;var c;while(true){c=a.parentNode;if(c.tagName!="TR"){a=c;continue}else{break}}var b=c.parentNode.parentNode;var d=b.parentNode;c.myRow.content[0].checked=true;editCheckedMaterialsBox(INNER_TABLE_NAME_PREFIX)};var editCheckedMaterialsBox=function(a){var f=document.getElementById(a);for(var b=0;b<f.tBodies[0].rows.length;b++){if(f.tBodies[0].rows[b].myRow.content[0].checked){var g=f.tBodies[0].rows[b];g.myRow.content[3]=document.createTextNode(g.myRow.content[3].data);g.cells[0].innerHTML="";g.cells[1].innerHTML="";g.cells[0].innerHTML="<a href='javascript:void(0);' onclick='editSelectedMaterial(event,\"edit\");'><img src='images/common/tick.gif' border='0'></a>";g.cells[1].innerHTML="<a href='javascript:void(0);' onclick='editSelectedMaterial(event,\"discard\");'><img src='images/common/cross.gif' border='0'></a>";var c=Array();var e=g.myRow.content[5];var d=document.createElement("span");d.appendChild(document.createTextNode(e.data));d.style.display="none";e.parentNode.appendChild(d);e.data="";g.myRow.content[6].style.display="inline";g.myRow.content[0].checked=false;g.myRow.content[0].disabled=true}}};var editSelectedMaterial=function(j,l){var d=j;var q;var g;if(d.target){q=d.target.parentNode.parentNode.parentNode}else{if(d.srcElement){q=d.srcElement.parentNode.parentNode.parentNode}}var n=q.sectionRowIndex;g=q.parentNode.parentNode;if(l=="discard"){var k;var m;var h;var o;k=q.myRow.content[5];m=q.myRow.content[6];o=k.parentNode.childNodes[2];h=o.firstChild.data;k.data=h;m.value=h;m.style.display="none";o.parentNode.removeChild(o);q.myRow.content[0].disabled=false;q.cells[0].innerHTML="";q.cells[0].innerHTML="<img src='images/common/url.gif' border='0'>";q.myRow.content[2]=q.cells[0].innerHTML;q.cells[1].innerHTML="";q.cells[1].appendChild(q.myRow.content[3])}else{if(l=="edit"){var p=q.myRow.content[6].value;var c=getHTMLHTTPRequest();var f=parseInt(Math.random()*99999999);var b="id="+q.myRow.content[9];b+="&fraction="+URLEncode(p);b+="&price="+q.myRow.content[7];var a=myServerAddress+"MyXMLDispatcher?rand="+f+"&path="+20280+"&method=EditSelectedFraction";c.open("POST",a,true);c.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8");c.setRequestHeader("Content-length",c.length);c.onreadystatechange=function(){if(c.readyState==4){if(c.status==200){var s=c.responseXML;var e=0;var t;if(s==null){alert("Data Error")}else{t=s.getElementsByTagName("status");e=systemStatus(null,t)}if(e==1){var r=s.getElementsByTagName("total")[0].getAttribute("value");q.myRow.content[8].data=""+r;k=q.myRow.content[5];m=q.myRow.content[6];m.style.display="none";if(m.value==""){k.data="-";m.value="-"}else{k.data=m.value}o=k.parentNode.childNodes[2];o.parentNode.removeChild(o);q.myRow.content[0].disabled=false;q.cells[0].innerHTML="";q.cells[0].innerHTML="<img src='images/common/url.gif' border='0'>";q.myRow.content[2]=q.cells[0].innerHTML;q.cells[1].innerHTML="";q.cells[1].appendChild(q.myRow.content[3]);myAsmRow.myRow.content[12].value=""+t[0].getAttribute("gross")+"";document.getElementById("sumTotal").innerHTML=""+t[0].getAttribute("sumTotal")+""}else{if(e==2){alert("EDIT: System Error")}}}else{alert("Connection Problem:"+c.statusText)}closeSplashScreen()}};openSplashScreen();c.send(b)}}};var materialManagerContainer="blankHidden2";var MatInnnerContainer="innerMatContainer";var matOptionsWindowId=importWindowId;var MAT_INNER_TABLE_NAME="matInnerSample";var MAT_INNER_DIV_NAV_NAME="matInnerNavDiv";var initMaterialWin=function(){var a=document.getElementById(materialManagerContainer);a.innerHTML="<div id='"+MatInnnerContainer+"' class='smallText'></div>";openMaterialOptionsWindow(asmId)};var openMaterialOptionsWindow=function(a){var b=document.getElementById(MatInnnerContainer);b.setAttribute("asmId",a);importWindow=internalWindow.open(matOptionsWindowId,"div",materialManagerContainer,"Add Materials","width=600px,height=400px,left=5px,top=5px,resize=1,scrolling=1");callMaterialAjax(1)};var materialTableparent=1;var materialTableTop=1;var materialTableCurrentParent=1;var materialTablecontainer=MatInnnerContainer;function callMaterialAjax(d){if(document.getElementById(materialTablecontainer)==null){return}var c=getHTMLHTTPRequest();materialTableCurrentParent=d;var b=parseInt(Math.random()*99999999);var a=myServerAddress+"MyXMLDispatcher?rand="+b+"&path="+20260+"&parent="+d+"&cbId="+costBookId+"&method=getMaterialCost";c.open("GET",a,true);c.onreadystatechange=function(){if(c.readyState==4){if(c.status==200){renderMaterial(c)}else{alert("Connection Problem:"+c.statusText)}}};writeWaitMsg(materialTablecontainer,"themes/icons/ajax_loading/22.gif","Loading page, please wait...");c.send(null)}function renderMaterial(b){var c=b.responseXML;if(c==null){alert("Data Error");return}var d=c.getElementsByTagName("status");var a=systemStatus(materialTablecontainer,d);if(a==0){return}var e="";e+="<div id='"+MAT_INNER_DIV_NAV_NAME+"'></div>";e+="<table id='"+MAT_INNER_TABLE_NAME+"' width='97%' class='innerContentTable'><thead id='MATTThead'><tr><td width='18px'>&nbsp;</td><td width='1%'>Sl</td><td width='30%'>Name</td><td width='45%'>Description</td><td>Price</td><td width='16px'>&nbsp;</td></tr></thead>";e+="<tbody id='MATTTbody'></tbody></table>";document.getElementById(materialTablecontainer).innerHTML=e;updateMaterialNav(c,MAT_INNER_DIV_NAV_NAME);populateMaterialTable(c,MAT_INNER_TABLE_NAME);addTableRolloverEffect(MAT_INNER_TABLE_NAME,"tableRollOverEffect2","tableRowClickEffect2")}var updateMaterialNav=function(b,a){var d=b.getElementsByTagName("levelParent");var c="<table class='innerNavTable'><tr>";if(d!=null&&d.length>=1){materialTableparent=d[0].getAttribute("id");c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callMaterialAjax("+materialTableparent+")'><img src='images/material/up.png' border='0' alt='Up one level'></a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callMaterialAjax("+materialTableTop+")'><img src='images/material/top.png' border='0' alt='Top level'></a></td>"}else{if(searchFlag2==false){c+="<td><img src='images/material/up1.png' alt='Up one level'></td>";c+="<td><img src='images/material/top1.png' alt='Top level'></td>";materialTableparent=1}else{c+="<td><img src='images/material/up1.png' alt='Up one level'></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callMaterialAjax("+materialTableTop+")'><img src='images/material/top.png' border='0' alt='Top level'></a></td>";searchFlag2=false;materialTableparent=1}}c+="<td><label>Enter keyword:</label></td><td><input size='40' type='text' id='searchKeyForMaterial' value=''></td><td><input type='button' value='GO' onclick='vaildateKey3();'></td>";c+="</tr></table>";document.getElementById(a).innerHTML=c};var populateMaterialTable=function(e,b){var d=e.getElementsByTagName("category");var a;var f;var g;for(var c=0;c<d.length;c++){f=document.getElementById(b);a=f.tBodies[0].rows.length;g=Array();g[0]="category";g[1]=d[c].childNodes[0].firstChild.data;g[2]=d[c].childNodes[1].firstChild.data;g[3]=d[c].childNodes[2].firstChild.data;g[4]=d[c].childNodes[3].firstChild.data;g[5]=d[c].childNodes[4].firstChild.data;addRowToTable3(f,a,g);reorderRows(f,a)}d=e.getElementsByTagName("item");for(c=0;c<d.length;c++){f=document.getElementById(b);a=f.tBodies[0].rows.length;g=Array();g[0]="item";g[1]=d[c].childNodes[0].firstChild.data;g[2]=d[c].childNodes[1].firstChild.data;g[3]=d[c].childNodes[2].firstChild.data;g[4]=d[c].childNodes[3].firstChild.data;g[5]=d[c].childNodes[4].firstChild.data;g[6]=d[c].childNodes[5].firstChild.data;g[7]=d[c].childNodes[6].firstChild.data;g[8]=d[c].childNodes[7].firstChild.data;addRowToTable3(f,a,g);reorderRows(f,a)}};var addRowToTable3=function(e,f,c){var n=e.tBodies[0].rows.length;var b=n+ROW_BASE;if(f==-1){f=n}else{b=f+ROW_BASE}var o=e.tBodies[0].insertRow(f);var m=Array();m[0]=o.insertCell(0);if(c[0]=="category"){m[0].innerHTML="<a href='javascript:void(0);' onclick='callMaterialAjax("+c[1]+")'><img src='images/material/folder.png' border='0'></a>"}else{m[0].innerHTML="<img src='images/material/file.gif' border='0'>"}m[1]=o.insertCell(1);var h=document.createTextNode(b);m[1].appendChild(h);m[2]=o.insertCell(2);var a=document.createTextNode(c[2]);m[2].appendChild(a);m[3]=o.insertCell(3);var l=document.createTextNode(c[3]);m[3].appendChild(l);m[4]=o.insertCell(4);var g;var k;if(c[0]=="item"){if(c[8]=="-"){g=document.createTextNode(c[5]);m[4].style.color="#ff0000"}else{g=document.createTextNode(c[8])}k=document.createTextNode(c[4]);m[4].appendChild(g);m[4].appendChild(document.createTextNode("/"));m[4].appendChild(k)}else{g=document.createTextNode("-");m[4].appendChild(g)}m[5]=o.insertCell(5);if(c[0]=="item"){m[5].innerHTML="<a href='javascript:void(0);' onclick='callAddMaterialAjax(\""+e.getAttribute("id")+'","'+o.sectionRowIndex+"\")'><img src='images/common/tick.gif' border='0'></a>"}else{m[5].innerHTML="&nbsp;"}var d=Array();d[0]=0;d[1]=0;d[2]=m[0].innerHTML;d[3]=h;d[4]=a;d[5]=l;d[6]=c[1];d[7]=c[0];if(c[0]=="category"){d[8]=c[4];d[9]=c[5]}else{d[8]=k;d[9]=g;d[10]=c[7]}var j=new myRowObject(d);o.myRow=j};var addMaterialBox=function(f,g,c){var q=f.tBodies[0].rows.length;var b=q+ROW_BASE;if(g==-1){g=q}else{b=g+ROW_BASE}var r=f.tBodies[0].insertRow(g);var o=Array();o[0]=r.insertCell(0);r.cells[0].innerHTML="<a href='javascript:void(0);' onclick='addMaterial(event,\"add\");'><img src='images/common/tick.gif' border='0'></a>";o[1]=r.insertCell(1);var j=document.createTextNode(b);r.cells[1].innerHTML="<a href='javascript:void(0);' onclick='addMaterial(event,\"discard\");'><img src='images/common/cross.gif' border='0'></a>";o[2]=r.insertCell(2);var a=document.createTextNode(c[0]);o[2].appendChild(a);o[3]=r.insertCell(3);var n=document.createTextNode(c[3]);o[3].appendChild(n);o[4]=r.insertCell(4);o[4].setAttribute("align","right");var d=getTextBox(10,c[5]);d.style.display="";var p=document.createTextNode("");o[4].appendChild(d);o[4].appendChild(p);o[5]=r.insertCell(5);var h=document.createTextNode(c[6]+"/"+c[4]);o[5].appendChild(h);o[6]=r.insertCell(6);o[6].setAttribute("align","right");var m=document.createTextNode(c[7]);o[6].appendChild(m);o[7]=r.insertCell(7);var k=document.createElement("input");k.setAttribute("type","checkbox");k.setAttribute("disabled","true");o[7].appendChild(k);var e=Array();e[0]=k;e[1]=0;e[2]=o[0].innerHTML;e[3]=j;e[4]=n;e[5]=p;e[6]=d;e[7]=c[6];e[8]=m;e[9]=0;e[10]=c[1];e[11]=c[2];e[12]=a;var l=new myRowObject(e);r.myRow=l;addRowRolloverEffect(r)};var callAddMaterialAjax=function(c,g){if(importFlag==2){return}var d=getHTMLHTTPRequest();var b=document.getElementById(c);var f=b.tBodies[0].rows[g];var h=b.parentNode;var a=h.getAttribute("asmId");var e=Array();e[0]=""+f.myRow.content[6];e[1]=a;e[2]=costBookId;e[3]=""+f.myRow.content[5].data;e[4]=""+f.myRow.content[8].data;e[5]="0";e[6]=""+f.myRow.content[9].data;e[7]="0";addMaterialBox(document.getElementById(INNER_TABLE_NAME_PREFIX),-1,e)};var addMaterial=function(h,j){var c=h;var l;var d;if(c.target){l=c.target.parentNode.parentNode.parentNode}else{if(c.srcElement){l=c.srcElement.parentNode.parentNode.parentNode}}var k=l.sectionRowIndex;d=l.parentNode.parentNode;if(j=="discard"){discardRowsArray=Array();discardRowsArray[0]=d.tBodies[0].rows[k];deleteRows(discardRowsArray);reorderRows(d,k)}else{if(j=="add"){var b=getHTMLHTTPRequest();var f=parseInt(Math.random()*99999999);var g="id="+l.myRow.content[12].data;g+="&fraction="+URLEncode(l.myRow.content[6].value);g+="&price="+l.myRow.content[7];g+="&asmId="+l.myRow.content[10];g+="&costBookId="+costBookId;var a=myServerAddress+"MyXMLDispatcher?rand="+f+"&path="+20281+"&method=addMaterialToAnalysis";b.open("POST",a,true);b.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8");b.setRequestHeader("Content-length",b.length);b.onreadystatechange=function(){if(b.readyState==4){if(b.status==200){var o=b.responseXML;var e=0;var p;if(o==null){alert("Data Error")}else{p=o.getElementsByTagName("status");e=systemStatus(null,p)}if(e==1){var m=o.getElementsByTagName("key")[0].getAttribute("value");var n=o.getElementsByTagName("key")[0].getAttribute("total");l.myRow.content[8].data=""+n;l.myRow.content[9]=""+m;l.myRow.content[12].data=""+m;displayedText=l.myRow.content[5];editBox=l.myRow.content[6];editBox.style.display="none";if(editBox.value==""){displayedText.data="-";editBox.value="-"}else{displayedText.data=editBox.value}l.myRow.content[0].disabled=false;l.cells[0].innerHTML="";l.cells[0].innerHTML="<img src='images/common/url.gif' border='0'>";l.myRow.content[2]=l.cells[0].innerHTML;l.cells[1].innerHTML="";l.cells[1].appendChild(l.myRow.content[3]);myAsmRow.myRow.content[12].value=""+p[0].getAttribute("gross")+"";document.getElementById("sumTotal").innerHTML=""+p[0].getAttribute("sumTotal")+""}else{if(e==2){alert("ADD: System Error")}}}else{alert("Connection Problem:"+b.statusText)}closeSplashScreen()}};openSplashScreen();b.send(g)}}};var cbManagerContainer="blankHidden3";var cbInnnerContainer="innerCbContainer";var cbOptionsWindowId=importWindowId;var CB_INNER_TABLE_NAME="cbInnerSample";var CB_INNER_DIV_NAV_NAME="cbInnerNavDiv";var initImportAnalysisWin=function(){var a=document.getElementById(cbManagerContainer);a.innerHTML="<div id='"+cbInnnerContainer+"' class='smallText'></div>";openImportOptionsWindow()};var openImportOptionsWindow=function(){var a=document.getElementById(cbInnnerContainer);importWindow=internalWindow.open(cbOptionsWindowId,"div",cbManagerContainer,"Import Analysis","width=600px,height=400px,left=5px,top=5px,resize=1,scrolling=1");callImportCBAjax(1)};var cbiTableparent=1;var cbiTableTop=1;var cbiTableCurrentParent=1;var cbiTablecontainer=cbInnnerContainer;function callImportCBAjax(e){if(document.getElementById(cbiTablecontainer)==null){return}var a=getHTMLHTTPRequest();cbiTableCurrentParent=e;var d=document.getElementById(cbiTablecontainer);var c=parseInt(Math.random()*99999999);var b=myServerAddress+"MyXMLDispatcher?rand="+c+"&path="+20211+"&parent="+e+"&asmId="+asmId+"&flag="+importFlag+"&method=ImportAnalysis";a.open("GET",b,true);a.onreadystatechange=function(){if(a.readyState==4){if(a.status==200){renderCostBooks(a)}else{alert("Connection Problem:"+a.statusText)}}};writeWaitMsg(cbiTablecontainer,"themes/icons/ajax_loading/22.gif","Loading page, please wait...");a.send(null)}function renderCostBooks(b){var c=b.responseXML;if(c==null){alert("Data Error");return}var d=c.getElementsByTagName("status");var a=systemStatus(cbiTablecontainer,d);if(a==0){return}var e="";e+="<div id='"+CB_INNER_DIV_NAV_NAME+"'></div>";e+="<table id='"+CB_INNER_TABLE_NAME+"' width='100%' class='innerContentTable'><thead><tr><td width='18px'>&nbsp;</td><td width='1%'>Sl</td><td width='25%'>Name</td><td width='100%'>Description</td><td>Analysis</td></tr></thead>";e+="<tbody></tbody></table>";document.getElementById(cbiTablecontainer).innerHTML=e;updateCostbookNav(c,CB_INNER_DIV_NAV_NAME);populateCostbookTable(c,CB_INNER_TABLE_NAME);addTableRolloverEffect(CB_INNER_TABLE_NAME,"tableRollOverEffect2","tableRowClickEffect2")}var updateCostbookNav=function(b,a){var d=b.getElementsByTagName("levelParent");var c="<table class='innerNavTable'><tr>";if(d!=null&&d.length>=1){cbiTableparent=d[0].getAttribute("id");c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callImportCBAjax("+cbiTableparent+")'><img src='images/material/up.png' border='0' alt='Up one level'></a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callImportCBAjax("+cbiTableTop+")'><img src='images/material/top.png' border='0' alt='Top level'></a></td>"}else{if(searchFlag1==false){c+="<td><img src='images/material/up1.png' alt='Up one level'></td>";c+="<td><img src='images/material/top1.png' alt='Top level'></td>";cbiTableparent=1}else{c+="<td><img src='images/material/up1.png' alt='Up one level'></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callImportCBAjax("+cbiTableTop+")'><img src='images/material/top.png' border='0' alt='Top level'></a></td>";searchFlag1=false;cbiTableparent=1}}c+="<td><label>Enter keyword:</label></td><td><input size='40' type='text' id='searchKeyForCB' value=''></td><td><input type='button' value='GO' onclick='vaildateKey1();'></td>";c+="</tr></table>";document.getElementById(a).innerHTML=c};var populateCostbookTable=function(e,b){var d=e.getElementsByTagName("cbCat");var a;var f;var g;for(var c=0;c<d.length;c++){f=document.getElementById(b);a=f.tBodies[0].rows.length;g=Array();g[0]="cbCat";g[1]=d[c].childNodes[0].firstChild.data;g[2]=d[c].childNodes[1].firstChild.data;g[3]=d[c].childNodes[2].firstChild.data;g[4]=d[c].childNodes[3].firstChild.data;g[5]=d[c].childNodes[4].firstChild.data;g[6]="0";addRowToTable1(f,a,g);reorderRows(f,a)}d=e.getElementsByTagName("cb");for(c=0;c<d.length;c++){f=document.getElementById(b);a=f.tBodies[0].rows.length;g=Array();g[0]="cb";g[1]=d[c].childNodes[0].firstChild.data;g[2]=d[c].childNodes[1].firstChild.data;g[3]=d[c].childNodes[2].firstChild.data;g[4]=d[c].childNodes[3].firstChild.data;g[5]=d[c].childNodes[4].firstChild.data;g[6]=d[c].childNodes[5].firstChild.data;addRowToTable1(f,a,g);reorderRows(f,a)}};var addRowToTable1=function(e,f,c){var m=e.tBodies[0].rows.length;var b=m+ROW_BASE;if(f==-1){f=m}else{b=f+ROW_BASE}var n=e.tBodies[0].insertRow(f);var l=Array();l[0]=n.insertCell(0);if(c[0]=="cbCat"){l[0].innerHTML="<a href='javascript:void(0);' onclick='callImportCBAjax("+c[1]+")'><img src='images/costbook/folder.gif' border='0'></a>"}else{l[0].innerHTML="<img src='images/costbook/costbook.png' border='0'>"}l[1]=n.insertCell(1);var h=document.createTextNode(b);l[1].appendChild(h);l[2]=n.insertCell(2);var a=document.createTextNode(c[2]);l[2].appendChild(a);l[3]=n.insertCell(3);var k=document.createTextNode(c[3]);l[3].appendChild(k);l[4]=n.insertCell(4);var g=document.createTextNode("");if(c[0]=="cb"){if(c[1]==costBookId){g=document.createTextNode("Current")}else{if(c[6]=="1"){if(importFlag==1||importFlag==2){l[4].innerHTML="<a href='javascript:void(0);' onclick='importFromCostBook(\""+e.getAttribute("id")+'","'+n.sectionRowIndex+"\")'><img src='images/common/tick.gif' border='0'></a>"}else{l[4].innerHTML="ERROR"}}else{g=document.createTextNode("NotAvailable")}}}l[4].appendChild(g);var d=Array();d[0]="";d[1]="";d[2]=l[0].innerHTML;d[3]=h;d[4]=a;d[5]=k;d[6]=c[1];d[7]=c[0];if(c[0]=="cbCat"){d[8]=c[4];d[9]=c[5]}else{d[8]=c[4];d[9]=c[5]}var j=new myRowObject(d);n.myRow=j};var importFromCostBook=function(a,b){if(importFlag==1){importMaterialsAjax(a,b)}else{if(importFlag==2){importOverheadsAjax(a,b)}else{return}}};var importMaterialsAjax=function(g,f){var d=getHTMLHTTPRequest();var c=document.getElementById(g);var j=c.tBodies[0].rows[f];var h=j.myRow.content[6];var b=c.parentNode;var e=parseInt(Math.random()*99999999);var a=myServerAddress+"MyXMLDispatcher?rand="+e+"&path="+20282+"&fromCostBookId="+h+"&toCostBookId="+costBookId+"&asmId="+asmId+"&flag=1&method=importMaterialToAnalysis";d.open("GET",a,true);d.onreadystatechange=function(){importMaterialToAnalysisAction(d,INNER_TABLE_NAME_PREFIX)};openSplashScreen();d.send(null)};var importMaterialToAnalysisAction=function(c,g){if(c.readyState==4){if(c.status==200){var j=c.responseXML;if(j==null){alert("Data Error")}else{systemMsg=j.getElementsByTagName("status");statusFlag=systemStatus(null,systemMsg);if(statusFlag==0){closeSplashScreen();return}var f=j.getElementsByTagName("entry");var d=document.getElementById(g);if(f.length>0){deleteExistingRowsFromTable(d)}for(var e=0;e<f.length;e++){var h=d.tBodies[0].rows.length;var a=Array();a[0]=f[e].childNodes[0].firstChild.data;a[1]=f[e].childNodes[1].firstChild.data;a[2]=f[e].childNodes[2].firstChild.data;a[3]=f[e].childNodes[3].firstChild.data;a[4]=f[e].childNodes[4].firstChild.data;a[5]=f[e].childNodes[5].firstChild.data;a[6]=f[e].childNodes[6].firstChild.data;a[7]=f[e].childNodes[7].firstChild.data;addRowToTable4(d,h,a)}var b=j.getElementsByTagName("assembly");if(b!=null&&b.length>0){myAsmRow.myRow.content[12].value=""+b[0].getAttribute("gross")+"";document.getElementById("sumTotal").innerHTML=""+b[0].getAttribute("sumTotal")+"";document.getElementById("multi").innerHTML=""+b[0].getAttribute("multiplier")+"";multiplier=parseInt(b[0].getAttribute("multiplier"))}}}else{alert("Connection Problem:"+c.statusText)}closeSplashScreen()}};var deleteExistingRowsFromTable=function(e){var a=new Array();for(var c=0;c<e.tBodies[0].rows.length;c++){a[c]=e.tBodies[0].rows[c]}for(var b=0;b<a.length;b++){var d=a[b].sectionRowIndex;a[b].parentNode.deleteRow(d)}};function openMaterialCostTable(){if(document.getElementById(analysisTableContainer)==null){return}if(asmAnalysisWindow!=null){asmAnalysisWindow.close()}var c=getHTMLHTTPRequest();var b=parseInt(Math.random()*99999999);var a=myServerAddress+"MyXMLDispatcher?rand="+b+"&path="+20250+"&cbId="+costBookId+"&method=getMaterialUsed";c.open("GET",a,true);c.onreadystatechange=function(){if(c.readyState==4){if(c.status==200){renderUsedMaterial(c)}else{alert("Connection Problem:"+c.statusText)}}};writeWaitMsg(analysisTableContainer,"themes/icons/ajax_loading/22.gif","Loading page, please wait...");c.send(null)}function renderUsedMaterial(b){var c=b.responseXML;if(c==null){alert("Data Error");return}var d=c.getElementsByTagName("status");var a=systemStatus(analysisTableContainer,d);if(a==0){return}var e="";e+="Filter: <input name='filter' onKeyUp='filter(this, \"usedMaterial\")' type='text'>";e+="<table id='usedMaterial' width='97%' class='contentTable'><thead id='MATTThead'><tr><td width='18px'>&nbsp;</td><td width='1%'>Sl</td><td width='20%'>Name</td><td width='55%'>Description</td><td>Unit</td><td>Price</td><td width='16px'>&nbsp;</td><td width='16px'>&nbsp;</td></tr></thead>";e+="<tbody id='MATTTbody'></tbody></table>";document.getElementById(analysisTableContainer).innerHTML=e;populateUsedMaterialTable(c,"usedMaterial");addTableRolloverEffect("usedMaterial","tableRollOverEffect1","tableRowClickEffect1")}var populateUsedMaterialTable=function(d,b){var a;var e;var f;var c=d.getElementsByTagName("item");for(i=0;i<c.length;i++){e=document.getElementById(b);a=e.tBodies[0].rows.length;f=Array();f[0]="item";f[1]=c[i].childNodes[0].firstChild.data;f[2]=c[i].childNodes[1].firstChild.data;f[3]=c[i].childNodes[2].firstChild.data;f[4]=c[i].childNodes[3].firstChild.data;f[5]=c[i].childNodes[4].firstChild.data;f[6]=c[i].childNodes[5].firstChild.data;addRowToTable5(e,a,f);reorderRows(e,a)}};var addRowToTable5=function(f,g,d){var o=f.tBodies[0].rows.length;var c=o+ROW_BASE;if(g==-1){g=o}else{c=g+ROW_BASE}var p=f.tBodies[0].insertRow(g);var n=Array();n[0]=p.insertCell(0);n[0].innerHTML="<img src='images/material/file.gif' border='0'>";n[1]=p.insertCell(1);var h=document.createTextNode(c);n[1].appendChild(h);n[2]=p.insertCell(2);var a=document.createTextNode(d[2]);n[2].appendChild(a);n[3]=p.insertCell(3);var m=document.createTextNode(d[3]);n[3].appendChild(m);n[4]=p.insertCell(4);var l=document.createTextNode(d[4]);n[4].appendChild(l);n[5]=p.insertCell(5);var b;var k;b=document.createElement("input");b.setAttribute("type","text");b.setAttribute("size","10");b.setAttribute("value",d[5]);n[5].appendChild(b);k=document.createElement("span");k.style.display="none";k.appendChild(document.createTextNode(d[5]));n[5].appendChild(k);n[6]=p.insertCell(6);n[6].innerHTML="<a href='javascript:void(0);' onclick='callUpdateMaterialCostAjax(\""+p.sectionRowIndex+"\",\"update\")'><img src='images/common/tick.gif' border='0'></a>";n[7]=p.insertCell(7);n[7].innerHTML="<a href='javascript:void(0);' onclick='callUpdateMaterialCostAjax(\""+p.sectionRowIndex+"\",\"discard\")'><img src='images/common/cross.gif' border='0'></a>";var e=Array();e[0]=0;e[1]=0;e[2]=n[0].innerHTML;e[3]=h;e[4]=a;e[5]=m;e[6]=d[1];e[7]=d[0];e[8]=l;e[9]=b;e[10]=k;var j=new myRowObject(e);p.myRow=j};var cbUpdateFlag;var callUpdateMaterialCostAjax=function(k,f){var j=getHTMLHTTPRequest();var g;var c=document.getElementById("usedMaterial");g=c.tBodies[0].rows[k];if(f=="discard"){g.myRow.content[9].value=g.myRow.content[10].firstChild.data;return}var d=parseInt(Math.random()*99999999);var a="";var b=g.myRow.content[6];var h=costBookId;var e=g.myRow.content[9].value;a=myServerAddress+"MyXMLDispatcher?rand="+d+"&path="+20270+"&id="+b+"&cbId="+h+"&price="+e+"&method=updateMaterialCB&flag="+f;j.open("GET",a,true);j.onreadystatechange=function(){updateMaterialCostAction(j,g)};openSplashScreen();j.send(null)};var updateMaterialCostAction=function(b,f){if(b.readyState==4){if(b.status==200){var d=b.responseXML;var a=0;if(d==null){alert("Data Error")}else{var e=d.getElementsByTagName("status");a=systemStatus(null,e)}if(a==1){var c=d.getElementsByTagName("refreshValue");if(c!=null&&c.length>0){f.myRow.content[9].value=c[0].getAttribute("cbPrice");f.myRow.content[10].firstChild.data=f.myRow.content[9].value}}else{if(a==2){alert("UPDATE: System Error")}}}else{alert("Connection Problem:"+b.statusText)}closeSplashScreen()}};function vaildateKey2(){key=document.getElementById("searchKeyForAssembly").value;if(key.length<3){alert("Enter Minimum 3 Character");return}else{callSearchAssemblyAjax()}}function callSearchAssemblyAjax(){if(document.getElementById(analysisTableContainer)==null){return}var c=getHTMLHTTPRequest();assemblyTableCurrentParent=0;var d=parseInt(Math.random()*99999999);var b=URLEncode(key);var a=myServerAddress+"MyXMLDispatcher?rand="+d+"&path="+20250+"&key="+b+"&cbId="+costBookId+"&method=getAssemblyCost";c.open("GET",a,true);c.onreadystatechange=function(){if(c.readyState==4){if(c.status==200){searchFlag=true;renderAssembly(c)}else{alert("Connection Problem:"+c.statusText)}}};writeWaitMsg(analysisTableContainer,"themes/icons/ajax_loading/22.gif","Loading page, please wait...");c.send(null)}function vaildateKey1(){key1=document.getElementById("searchKeyForCB").value;if(key1.length<3){alert("Enter Minimum 3 Character");return}else{callSearchCBAjax()}}function callSearchCBAjax(){if(document.getElementById(cbiTablecontainer)==null){return}var c=getHTMLHTTPRequest();cbiTableCurrentParent=0;var d=parseInt(Math.random()*99999999);var b=URLEncode(key1);var a=myServerAddress+"MyXMLDispatcher?rand="+d+"&path="+20211+"&key="+b+"&asmId="+asmId+"&flag="+importFlag+"&method=ImportAnalysis";c.open("GET",a,true);c.onreadystatechange=function(){if(c.readyState==4){if(c.status==200){searchFlag1=true;renderCostBooks(c)}else{alert("Connection Problem:"+c.statusText)}}};writeWaitMsg(cbiTablecontainer,"themes/icons/ajax_loading/22.gif","Loading page, please wait...");c.send(null)}function vaildateKey3(){key=document.getElementById("searchKeyForMaterial").value;if(key.length<3){alert("Enter Minimum 3 Character");return}else{callSearchMaterialAjax()}}function callSearchMaterialAjax(){if(document.getElementById(materialTablecontainer)==null){return}var d=getHTMLHTTPRequest();var c=parseInt(Math.random()*99999999);var b=URLEncode(key);var a=myServerAddress+"MyXMLDispatcher?rand="+c+"&path="+20260+"&key="+b+"&cbId="+costBookId+"&method=getMaterialCost";d.open("GET",a,true);d.onreadystatechange=function(){if(d.readyState==4){if(d.status==200){searchFlag2=true;renderMaterial(d)}else{alert("Connection Problem:"+d.statusText)}}};writeWaitMsg(materialTablecontainer,"themes/icons/ajax_loading/22.gif","Loading page, please wait...");d.send(null)}var callShowOverheadsAjax=function(){importFlag=2;if(document.getElementById(anlyzInnerDivPrefix)==null){return}var a=getHTMLHTTPRequest();var c=parseInt(Math.random()*99999999);var b=myServerAddress+"MyXMLDispatcher?rand="+c+"&path="+20284+"&costBookId="+costBookId+"&asmId="+asmId+"&method=getOverheads";a.open("GET",b,true);a.onreadystatechange=function(){if(a.readyState==4){if(a.status==200){renderOverheads(a)}else{alert("Connection Problem:"+a.statusText)}}};writeWaitMsg(anlyzInnerDivPrefix,"themes/icons/ajax_loading/22.gif","Loading page, please wait...");a.send(null)};var renderOverheads=function(d){var e=d.responseXML;if(e==null){alert("Data Error");return}var f=e.getElementsByTagName("status");var c=systemStatus(anlyzInnerDivPrefix,f);if(c==0){return}var b=e.getElementsByTagName("assembly");if(b!=null&&b.length>0){multiplier=b[0].getAttribute("multiplier");overheadTotal=b[0].getAttribute("overheadTotal");var a=document.getElementById(anlyzInnerDivPrefix);a.setAttribute("matRef","");a.setAttribute("ovhRef",asmId);var g="<div id='"+INNER_NAV_DIV_PREFIX+"'></div>";g+="<table width='97%' class='innerContentTable'><tr class='classcb' id='OVH'><td align='right'>Analysis for <span id='multi'>"+multiplier+"</span> "+myAsmRow.myRow.content[7].data+"  <a href='javascript:void(0);' id='change' onClick='editMultiplier(event,\"change\");'>Change</a> <a href='javascript:void(0);' style='display:none;' id='edit' onclick='editMultiplier(event,\"edit\");'><img src='images/common/tick.gif' border='0'></a> <a href='javascript:void(0);' id='discard' style='display:none;' onclick='editMultiplier(event,\"discard\");'><img src='images/common/cross.gif' border='0'></a></td></tr></table>";g+="<table width='97%' class='innerContentTable' id='"+INNER_TABLE_NAME_PREFIX+"'><thead id='OVHTHEAD'><tr><td width='16px'>&nbsp;</td><td width='16px'>Sl</td><td>ID</td><td width='60%'>Description</td><td>Amount</td><td>Total</td><td width='10px'>D</td></tr></thead><tbody id='OVHTBODY'></tbody></table>";g+="<table width='97%' class='innerContentTable'><tr class='classcb'><td align='left'><b>Total:</b>&nbsp;<span id='overheadTotal'>"+overheadTotal+"</span></td></tr></table>";a.innerHTML=g;contextMenu.attachTo("OVH",menu2(0));contextMenu.attachTo("OVHTHEAD",menu2(0));contextMenu.attachTo("OVHTBODY",menu2(0));updateOverheadsNav(e,INNER_NAV_DIV_PREFIX,INNER_TABLE_NAME_PREFIX);initiateTableRollover(INNER_TABLE_NAME_PREFIX,"tableRollOverEffect1","tableRowClickEffect1");populateOverheadTable(e,INNER_TABLE_NAME_PREFIX,asmId)}else{var c=systemStatus(null,f);if(c==0){return}}};var updateOverheadsNav=function(b,d,a){var c="<table class='innerNavTable'><tr>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='addNewOverheadBox(\""+a+"\");'>Add New</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='initImportAnalysisWin();'>Import[CostBook]</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='initAssemblyImportWin();'>Import[Assemblies]</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='editCheckedOverheadsBox(\""+a+"\");'>Edit[D]</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='deleteOverheadsChecked(\""+a+"\");'>Delete[D]</a></td>";c+="</tr></table>";document.getElementById(d).innerHTML=c};var populateOverheadTable=function(f,c){var b=c;var e=f.getElementsByTagName("entry");for(var d=0;d<e.length;d++){var g=document.getElementById(b);var a=g.tBodies[0].rows.length;var h=Array();h[0]=e[d].childNodes[0].firstChild.data;h[1]=e[d].childNodes[1].firstChild.data;h[2]=e[d].childNodes[2].firstChild.data;h[3]=e[d].childNodes[3].firstChild.data;h[4]=e[d].childNodes[4].firstChild.data;addRowToTable6(g,a,h)}};var addRowToTable6=function(e,h,c){var q=e.tBodies[0].rows.length;var b=q+ROW_BASE;if(h==-1){h=q}else{b=h+ROW_BASE}var r=e.tBodies[0].insertRow(h);var p=Array();p[0]=r.insertCell(0);p[0].innerHTML="<img src='images/project/job.gif' border='0'>";p[1]=r.insertCell(1);var j=document.createTextNode(b);p[1].appendChild(j);p[2]=r.insertCell(2);var a=document.createTextNode(c[0]);p[2].appendChild(a);p[3]=r.insertCell(3);var g=getTextBox(20,c[2]);g.style.display="none";var o=document.createTextNode(c[2]);p[3].appendChild(g);p[3].appendChild(o);p[4]=r.insertCell(4);var l;l=getTextBox(10,c[3]);l.style.display="none";var f;f=document.createTextNode(c[3]);p[4].appendChild(l);p[4].appendChild(f);p[5]=r.insertCell(5);var n=document.createTextNode(c[4]);p[5].appendChild(n);p[6]=r.insertCell(6);var k=document.createElement("input");k.setAttribute("type","checkbox");p[6].appendChild(k);var d=Array();d[0]=k;d[1]=0;d[2]=p[0].innerHTML;d[3]=j;d[4]=o;d[5]=g;d[6]=f;d[7]=l;d[8]=c[0];d[9]=n;d[10]=a;var m=new myRowObject(d);r.myRow=m;addRowRolloverEffect(r)};function callDeleteOverheadsAjax(f,e,c){if(!confirmDelete()){return}var h=getHTMLHTTPRequest();var d=parseInt(Math.random()*99999999);var g="";for(var b=0;b<e.length;b++){if(b==0){g+=e[b].myRow.content[8]}else{g+=","+e[b].myRow.content[8]}}var a=myServerAddress+"MyXMLDispatcher?rand="+d+"&path="+20285+"&id="+URLEncode(g)+"&method=deleteOverhead";h.open("GET",a,true);h.onreadystatechange=function(){if(h.readyState==4){if(h.status==200){var k=h.responseXML;var j=0;var l;if(k==null){alert("Data Error")}else{l=k.getElementsByTagName("status");j=systemStatus(null,l)}if(j==1){myAsmRow.myRow.content[12].value=""+l[0].getAttribute("gross")+"";document.getElementById("overheadTotal").innerHTML=""+l[0].getAttribute("overheadTotal")+"";deleteRows(e);reorderRows(f,c)}else{if(j==2){alert("DELETE: System Error")}}}else{alert("Connection Problem:"+h.statusText)}closeSplashScreen()}};openSplashScreen();h.send(null)}var deleteOverheadsChecked=function(d){var f=document.getElementById(d);var a=new Array();var b=0;for(var c=0;c<f.tBodies[0].rows.length;c++){if(f.tBodies[0].rows[c].myRow.content[0].checked){a[b]=f.tBodies[0].rows[c];b++}}if(a.length>0){var e=a[0].sectionRowIndex;callDeleteOverheadsAjax(f,a,e)}};var deleteJobsRows=function(c){for(var a=0;a<c.length;a++){var b=c[a].sectionRowIndex;c[a].parentNode.deleteRow(b)}};var reorderJobsRows=function(d,c){if(d.tBodies[0].rows[c]){var b=c+ROW_BASE;for(var a=c;a<d.tBodies[0].rows.length;a++){d.tBodies[0].rows[a].myRow.content[3].data=b;b++}}};var deleteContextOverheadsChecked=function(){var a=new Array();var b=contextMenu.srcElement;while(true){a[0]=b.parentNode;if(a[0].tagName!="TR"){b=a[0];continue}else{break}}var d=a[0].parentNode.parentNode;var c=a[0].sectionRowIndex;callDeleteOverheadsAjax(d,a,c)};var addContextOverheadsBox=function(){var a=contextMenu.srcElement;var c;while(true){c=a.parentNode;if(c.tagName!="TR"){a=c;continue}else{break}}var b=c.parentNode.parentNode;var d=b.parentNode;addNewOverheadBox(INNER_TABLE_NAME_PREFIX)};var addNewOverheadBox=function(c){var e=document.getElementById(c);var q=e.tBodies[0].rows.length;var h=q;var b=h+ROW_BASE;var r=e.tBodies[0].insertRow(h);var p=Array();p[0]=r.insertCell(0);p[0].innerHTML="<a href='javascript:void(0);' onclick='addNewOverhead(event,\"add\");'><img src='images/common/tick.gif' border='0'></a>";p[1]=r.insertCell(1);var j=document.createTextNode(b);p[1].innerHTML="<a href='javascript:void(0);' onclick='addNewOverhead(event,\"discard\");'><img src='images/common/cross.gif' border='0'></a>";p[2]=r.insertCell(2);var a=document.createTextNode("-");p[2].appendChild(a);p[3]=r.insertCell(3);var g=getTextBox(20,"-");var o=document.createTextNode("");p[3].appendChild(g);p[3].appendChild(o);p[4]=r.insertCell(4);var l=getTextBox(10,"-");var f=document.createTextNode("");p[4].appendChild(l);p[4].appendChild(f);p[5]=r.insertCell(5);var n=document.createTextNode("");p[5].appendChild(n);p[6]=r.insertCell(6);var k=document.createElement("input");k.setAttribute("type","checkbox");k.disabled=true;p[6].appendChild(k);var d=Array();d[0]=k;d[1]=0;d[2]=p[0].innerHTML;d[3]=j;d[4]=o;d[5]=g;d[6]=f;d[7]=l;d[8]=0;d[9]=n;d[10]=a;var m=new myRowObject(d);r.myRow=m;addRowRolloverEffect(r)};var addNewOverhead=function(k,l){var c=k;var o;var f;if(c.target){o=c.target.parentNode.parentNode.parentNode}else{if(c.srcElement){o=c.srcElement.parentNode.parentNode.parentNode}}var m=o.sectionRowIndex;f=o.parentNode.parentNode;if(l=="discard"){discardRowsArray=Array();discardRowsArray[0]=f.tBodies[0].rows[m];deleteJobsRows(discardRowsArray);reorderJobsRows(f,m)}else{if(l=="add"){var d=getHTMLHTTPRequest();var g=parseInt(Math.random()*99999999);var b=URLEncode("-");var n=URLEncode(o.myRow.content[5].value);var h=URLEncode(o.myRow.content[7].value);var j="asmId="+asmId;j+="&cbId="+costBookId;j+="&name="+b;j+="&description="+n;j+="&amount="+h;var a=myServerAddress+"MyXMLDispatcher?rand="+g+"&path="+20286+"&method=addOverhead";d.open("POST",a,true);d.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8");d.setRequestHeader("Content-length",d.length);d.onreadystatechange=function(){if(d.readyState==4){if(d.status==200){var s=d.responseXML;var e=0;var t;if(s==null){alert("Data Error")}else{t=s.getElementsByTagName("status");e=systemStatus(null,t)}if(e==1){var p=s.getElementsByTagName("key")[0].getAttribute("value");var r=s.getElementsByTagName("key")[0].getAttribute("total");o.myRow.content[4].data=o.myRow.content[5].value;o.myRow.content[6].data=o.myRow.content[7].value;o.myRow.content[8]=""+p;o.myRow.content[9].data=""+r;o.myRow.content[10].data=""+p;for(var q=5;q<=7;q+=2){o.myRow.content[q].style.display="none"}o.cells[0].innerHTML="";o.cells[0].innerHTML="<img src='images/common/url.gif' border='0'>";o.myRow.content[2]=o.cells[0].innerHTML;o.cells[1].innerHTML="";o.cells[1].appendChild(o.myRow.content[3]);o.myRow.content[0].disabled=false;myAsmRow.myRow.content[12].value=""+t[0].getAttribute("gross")+"";document.getElementById("overheadTotal").innerHTML=""+t[0].getAttribute("overheadTotal")+""}else{if(e==2){alert("ADD: System Error")}}}else{alert("Connection Problem:"+d.statusText)}closeSplashScreen()}};openSplashScreen();d.send(j)}}};var editContextOverheadsBox=function(){var b=contextMenu.srcElement;var d;while(true){d=b.parentNode;if(d.tagName!="TR"){b=d;continue}else{break}}var c=d.parentNode.parentNode;var e=c.parentNode;var a=e.getAttribute("estimateRef");d.myRow.content[0].checked=true;editCheckedOverheadsBox(INNER_TABLE_NAME_PREFIX)};var editCheckedOverheadsBox=function(c){var e=document.getElementById(c);for(var f=0;f<e.tBodies[0].rows.length;f++){if(e.tBodies[0].rows[f].myRow.content[0].checked){var l=e.tBodies[0].rows[f];l.myRow.content[3]=document.createTextNode(l.myRow.content[3].data);l.cells[0].innerHTML="";l.cells[1].innerHTML="";l.cells[0].innerHTML="<a href='javascript:void(0);' onclick='editSelectedOverhead(event,\"edit\");'><img src='images/common/tick.gif' border='0'></a>";l.cells[1].innerHTML="<a href='javascript:void(0);' onclick='editSelectedOverhead(event,\"discard\");'><img src='images/common/cross.gif' border='0'></a>";var g=Array();for(var d=4;d<=6;d+=2){var h=l.myRow.content[d];var a=document.createElement("span");a.appendChild(document.createTextNode(h.data));a.style.display="none";h.parentNode.appendChild(a);h.data=""}for(var b=5;b<=7;b+=2){if(b==11){if(l.myRow.content[9].value=="Actual"||l.myRow.content[9].value=="DR"){l.myRow.content[b].style.display="none"}else{l.myRow.content[b].style.display=""}}else{l.myRow.content[b].style.display=""}}l.myRow.content[0].checked=false;l.myRow.content[0].disabled=true}}};var editSelectedOverhead=function(p,o){var r=p;var f;var c;if(r.target){f=r.target.parentNode.parentNode.parentNode}else{if(r.srcElement){f=r.srcElement.parentNode.parentNode.parentNode}}var h=f.sectionRowIndex;c=f.parentNode.parentNode;if(o=="discard"){var l;var k;var s;var n;for(var j=4;j<=6;j+=2){l=f.myRow.content[j];k=f.myRow.content[j+1];n=l.parentNode.childNodes[2];s=n.firstChild.data;l.data=s;k.value=s;k.style.display="none";n.parentNode.removeChild(n)}f.myRow.content[0].disabled=false;f.cells[0].innerHTML="";f.cells[0].innerHTML="<img src='images/common/url.gif' border='0'>";f.myRow.content[2]=f.cells[0].innerHTML;f.cells[1].innerHTML="";f.cells[1].appendChild(f.myRow.content[3])}else{if(o=="edit"){var q=getHTMLHTTPRequest();var a=parseInt(Math.random()*99999999);var t=URLEncode("-");var m=URLEncode(f.myRow.content[5].value);var g=URLEncode(f.myRow.content[7].value);var d="id="+f.myRow.content[8];d+="&name="+t;d+="&description="+m;d+="&amount="+g;var b=myServerAddress+"MyXMLDispatcher?rand="+a+"&path="+20287+"&method=updateOverhead";q.open("POST",b,true);q.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8");q.setRequestHeader("Content-length",q.length);q.onreadystatechange=function(){if(q.readyState==4){if(q.status==200){var v=q.responseXML;var e=0;var w;if(v==null){alert("Data Error")}else{w=v.getElementsByTagName("status");e=systemStatus(null,w)}if(e==1){var u=v.getElementsByTagName("total")[0].getAttribute("value");for(j=4;j<=6;j+=2){l=f.myRow.content[j];k=f.myRow.content[j+1];k.style.display="none";if(k.value==""){l.data="-";k.value="-"}l.data=k.value;n=l.parentNode.childNodes[2];n.parentNode.removeChild(n)}f.myRow.content[9].data=""+u;f.myRow.content[0].disabled=false;f.cells[0].innerHTML="";f.cells[0].innerHTML="<img src='images/common/url.gif' border='0'>";f.myRow.content[2]=f.cells[0].innerHTML;f.cells[1].innerHTML="";f.cells[1].appendChild(f.myRow.content[3]);myAsmRow.myRow.content[12].value=""+w[0].getAttribute("gross")+"";document.getElementById("overheadTotal").innerHTML=""+w[0].getAttribute("overheadTotal")+""}else{if(e==2){alert("EDIT: System Error")}}}else{alert("Connection Problem:"+q.statusText)}closeSplashScreen()}};openSplashScreen();q.send(d)}}};var importOverheadsAjax=function(g,f){var d=getHTMLHTTPRequest();var c=document.getElementById(g);var j=c.tBodies[0].rows[f];var h=j.myRow.content[6];var b=c.parentNode;var e=parseInt(Math.random()*99999999);var a=myServerAddress+"MyXMLDispatcher?rand="+e+"&path="+20282+"&fromCostBookId="+h+"&toCostBookId="+costBookId+"&asmId="+asmId+"&flag=2&method=importOverheadsToAnalysis";d.open("GET",a,true);d.onreadystatechange=function(){importOverheadsToAnalysisAction(d,INNER_TABLE_NAME_PREFIX)};openSplashScreen();d.send(null)};var importOverheadsToAnalysisAction=function(c,g){if(c.readyState==4){if(c.status==200){var j=c.responseXML;if(j==null){alert("Data Error")}else{systemMsg=j.getElementsByTagName("status");statusFlag=systemStatus(null,systemMsg);if(statusFlag==0){closeSplashScreen();return}var f=j.getElementsByTagName("entry");var d=document.getElementById(g);if(f.length>0){deleteExistingRowsFromTable(d)}for(var e=0;e<f.length;e++){var h=d.tBodies[0].rows.length;var a=Array();a[0]=f[e].childNodes[0].firstChild.data;a[1]=f[e].childNodes[1].firstChild.data;a[2]=f[e].childNodes[2].firstChild.data;a[3]=f[e].childNodes[3].firstChild.data;a[4]=f[e].childNodes[4].firstChild.data;addRowToTable6(d,h,a)}var b=j.getElementsByTagName("assembly");if(b!=null&&b.length>0){myAsmRow.myRow.content[12].value=""+b[0].getAttribute("gross")+"";document.getElementById("overheadTotal").innerHTML=""+b[0].getAttribute("overheadTotal")+"";document.getElementById("multi").innerHTML=""+b[0].getAttribute("multiplier")+"";multiplier=parseInt(b[0].getAttribute("multiplier"))}}}else{alert("Connection Problem:"+c.statusText)}closeSplashScreen()}};var asmManagerContainer="blankHidden4";var asmInnnerContainer="innerASMContainer";var asmOptionsWindowId=importWindowId;var ASM_INNER_TABLE_NAME="asmInnerSample";var ASM_INNER_DIV_NAV_NAME="asmInnerNavDiv";var asmiTablecontainer=asmInnnerContainer;var initAssemblyImportWin=function(){var a=document.getElementById(asmManagerContainer);a.innerHTML="<div id='"+asmInnnerContainer+"' class='smallText'></div>";importWindow=internalWindow.open(cbOptionsWindowId,"div",asmManagerContainer,"Import from Assemblies","width=700px,height=400px,left=5px,top=5px,resize=1,scrolling=1");callOpenAssembliesListAjax()};var callOpenAssembliesListAjax=function(){if(document.getElementById(asmiTablecontainer)==null){return}var a=getHTMLHTTPRequest();cbiTableCurrentParent=id;var d=document.getElementById(asmiTablecontainer);var c=parseInt(Math.random()*99999999);var b=myServerAddress+"MyXMLDispatcher?rand="+c+"&path="+20290+"&cbId="+costBookId+"&flag="+importFlag+"&method=ImportAnalysis";a.open("GET",b,true);a.onreadystatechange=function(){if(a.readyState==4){if(a.status==200){renderAssembliesForImport(a)}else{alert("Connection Problem:"+a.statusText)}}};writeWaitMsg(asmiTablecontainer,"themes/icons/ajax_loading/22.gif","Loading page, please wait...");a.send(null)};function renderAssembliesForImport(b){var c=b.responseXML;if(c==null){alert("Data Error");return}var d=c.getElementsByTagName("status");var a=systemStatus(asmiTablecontainer,d);if(a==0){return}var e="";e+="Filter: <input name='filter' onKeyUp='filter(this, \""+ASM_INNER_TABLE_NAME+"\")' type='text'>";e+="&nbsp;&nbsp;<a href='javascript:void(0);' onclick='exportSelectedAssemblies(\""+ASM_INNER_TABLE_NAME+"\");'>Export</a><br>";e+="<table id='"+ASM_INNER_TABLE_NAME+"' width='100%' class='innerContentTable'><thead><tr><td width='18px'>&nbsp;</td><td width='1%'>Sl</td><td width='15%'>Name</td><td width='45%'>Description</td><td width='15%'>Price</td><td>Amount</td><td></td></tr></thead>";e+="<tbody></tbody></table>";document.getElementById(asmiTablecontainer).innerHTML=e;populateAssembliesImportTable(c,ASM_INNER_TABLE_NAME);addTableRolloverEffect(ASM_INNER_TABLE_NAME,"tableRollOverEffect2","tableRowClickEffect2")}var populateAssembliesImportTable=function(d,b){var a;var e;var f;var c=d.getElementsByTagName("item");for(i=0;i<c.length;i++){e=document.getElementById(b);a=e.tBodies[0].rows.length;f=Array();f[0]=c[i].childNodes[0].firstChild.data;f[1]=c[i].childNodes[1].firstChild.data;f[2]=c[i].childNodes[2].firstChild.data;f[3]=c[i].childNodes[3].firstChild.data;f[4]=c[i].childNodes[4].firstChild.data;f[5]=c[i].childNodes[5].firstChild.data;if(parseInt(f[0])==asmId){continue}addRowToTable7(e,a,f);reorderRows(e,a)}};var addRowToTable7=function(e,g,c){var o=e.tBodies[0].rows.length;var b=o+ROW_BASE;if(g==-1){g=o}else{b=g+ROW_BASE}var p=e.tBodies[0].insertRow(g);var n=Array();n[0]=p.insertCell(0);n[0].innerHTML="<img src='images/assembly/item.png' border='0'>";n[1]=p.insertCell(1);var h=document.createTextNode(b);n[1].appendChild(h);n[2]=p.insertCell(2);var a=document.createTextNode(c[1]);n[2].appendChild(a);n[3]=p.insertCell(3);var m=document.createTextNode(c[2]);n[3].appendChild(m);n[4]=p.insertCell(4);var l=document.createTextNode(c[4]+"/"+c[3]);n[4].appendChild(l);n[5]=p.insertCell(5);var f;f=document.createElement("input");f.setAttribute("type","text");f.setAttribute("size","10");f.setAttribute("value","-");f.disabled=true;n[5].appendChild(f);n[5].appendChild(document.createTextNode("*"+c[5]));n[6]=p.insertCell(6);var j=document.createElement("input");j.setAttribute("type","checkbox");n[6].appendChild(j);j.onclick=toggleVolumeBoxState;var d=Array();d[0]=j;d[1]=0;d[2]=c[0];d[3]=f;var k=new myRowObject(d);p.myRow=k};var toggleVolumeBoxState=function(b){var a=this;row=a.parentNode.parentNode;if(row!=null){if(a.checked==true){row.myRow.content[3].disabled=false}else{row.myRow.content[3].disabled=true;row.myRow.content[3].value="-"}}};var exportSelectedAssemblies=function(d){var f=document.getElementById(d);var a=new Array();var b=0;for(var c=0;c<f.tBodies[0].rows.length;c++){if(f.tBodies[0].rows[c].myRow.content[0].checked){a[b]=f.tBodies[0].rows[c];b++}}if(a.length>0){var e=a[0].sectionRowIndex;callExportAssembliesAjax(f,a,e)}};function callExportAssembliesAjax(h,j,e){if(!window.confirm("Import from selected item(s)?")){return}var n=getHTMLHTTPRequest();var m=h;var d=j;var f=e;var k=parseInt(Math.random()*99999999);var c="";var l="";for(var g=0;g<j.length;g++){if(c==""){c+=j[g].myRow.content[2];l+=j[g].myRow.content[3].value}else{c+=","+j[g].myRow.content[2];l+=","+j[g].myRow.content[3].value}}var a;if(importFlag==1){a="importResourcesFromAssemblies"}else{a="importOverheadsFromAssemblies"}var b=myServerAddress+"MyXMLDispatcher?rand="+k+"&path="+20291+"&ids="+URLEncode(c)+"&volumes="+URLEncode(l)+"&asmId="+asmId+"&cbId="+costBookId+"&method="+a;n.open("GET",b,true);n.onreadystatechange=function(){if(importFlag==1){importMaterialToAnalysisAction(n,INNER_TABLE_NAME_PREFIX)}else{importOverheadsToAnalysisAction(n,INNER_TABLE_NAME_PREFIX)}};openSplashScreen();n.send(null)};