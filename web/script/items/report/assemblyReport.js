var costBookId=0;var costBookName="--";var assemblyTableparent=1;var assemblyTableTop=1;var assemblyTableCurrentParent=1;var assemblyTablecontainer="blankContent";var INPUT_NAME_PREFIX="inputName";var RADIO_NAME="radName";var TABLE_NAME="assemblySample";var DIV_NAV_NAME="assemblyNavDiv";var ROW_BASE=1;var hasLoaded=false;var ctx_THEAD="ASMREP_TTHEAD123";var ctx_TBODY="ASMREP_TTBODY123";var key="qwerty";var sid=0;var key1="qwerty";var searchFlag1=false;var callBack=function(){if(myContextMenuRequest.readyState==4){if(myContextMenuRequest.status==200){configureContextMenu();callAssemblyAjax(1)}else{alert("Connection Problem:"+myContextMenuRequest.statusText)}}};var initializeAssemblyTable=function(a){writeWaitMsg(assemblyTablecontainer,"themes/icons/ajax_loading/22.gif","Loading Menu...");callContextMenuAjax(a,callBack)};var menu2=function(){return configureContextMenuModel()};contextMenu.modifyMenu=function(){var a=this.srcElement;currentMenuBar=this.menuBar;var b;while(true){b=a.parentNode;if(b.tagName!="TR"){a=b;continue}else{break}}clickOnTableRowContext(b);if(b.myRow==null){setMenuItemState(211340,"disabled");setMenuItemState(211350,"disabled")}else{setMenuItemState(211340,"regular");if(b.myRow.content[7].data==""){setMenuItemState(211350,"disabled")}else{setMenuItemState(211350,"regular")}}if(assemblyTableCurrentParent==1){setMenuItemState(211310,"disabled");setMenuItemState(211320,"disabled")}else{setMenuItemState(211310,"regular");setMenuItemState(211320,"regular")}setMenuPermissions(currentMenuBar)};function callAssemblyAjax(d){if(document.getElementById(assemblyTablecontainer)==null){return}var b=getHTMLHTTPRequest();assemblyTableCurrentParent=d;var c=parseInt(Math.random()*99999999);var a=myServerAddress+"MyXMLDispatcher?rand="+c+"&path="+100100+"&parent="+d+"&cbId="+costBookId+"&method=getAssemblyWithCostBook";b.open("GET",a,true);b.onreadystatechange=function(){if(b.readyState==4){if(b.status==200){renderAssembly(b)}else{alert("Connection Problem:"+b.statusText)}}};writeWaitMsg(assemblyTablecontainer,"themes/icons/ajax_loading/22.gif","Processing request, please wait...");b.send(null)}function renderAssembly(b){var c=b.responseXML;if(c==null){alert("Data Error");return}var d=c.getElementsByTagName("status");var a=systemStatus(assemblyTablecontainer,d);if(a==0){return}var e="";e+="<div id='"+DIV_NAV_NAME+"'></div>";e+="<table id='"+TABLE_NAME+"' width='100%' class='reportTable'><thead id='"+ctx_THEAD+"'><tr><td width='18px'>&nbsp;</td><td width='1%'>Sl</td><td width='15%'>Name</td><td width='40%'>Description</td><td>Price</td><td>Premium</td><td width='25%'>Remarks</td></tr></thead>";e+="<tbody id='"+ctx_TBODY+"'></tbody></table>";document.getElementById(assemblyTablecontainer).innerHTML=e;updateAssemblyNav(c,DIV_NAV_NAME);populateTable(c,TABLE_NAME);contextMenu.attachTo(ctx_THEAD,menu2());contextMenu.attachTo(ctx_TBODY,menu2());addTableRolloverEffect(TABLE_NAME,"tableRollOverEffect1","tableRowClickEffect1")}var updateAssemblyNav=function(b,a){var d=b.getElementsByTagName("levelParent");var c="<table class='navTable'><tr>";if(d!=null&&d.length>=1){assemblyTableparent=d[0].getAttribute("id");c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callAssemblyAjax("+assemblyTableparent+")'><img src='images/assembly/report/up.png' border='0' alt='Up one level'></a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callAssemblyAjax("+assemblyTableTop+")'><img src='images/assembly/report/top.png' border='0' alt='Top level'></a></td>";c+="<td>Costbook Selected:&nbsp;[<i>"+costBookName+"</i>]</td>"}else{c+="<td><img src='images/assembly/report/up1.png' alt='Up one level'></td>";c+="<td><img src='images/assembly/report/top1.png' alt='Top level'></td>";c+="<td>Costbook Selected:&nbsp;[<i>"+costBookName+"</i>]</td>";assemblyTableparent=1}c+="<td>&nbsp;</td><td align='right'><input type='button' name='search' value='Search' onclick='populateSearchWin();'/></td>";c+="</tr></table>";document.getElementById(a).innerHTML=c};var populateTable=function(e,b){var d=e.getElementsByTagName("item");for(var c=0;c<d.length;c++){var f=document.getElementById(b);var a=f.tBodies[0].rows.length;var g=Array();g[0]=d[c].childNodes[0].firstChild.data;g[1]=d[c].childNodes[1].firstChild.data;g[2]=d[c].childNodes[2].firstChild.data;g[3]=d[c].childNodes[3].firstChild.data;g[4]=d[c].childNodes[4].firstChild.data;g[5]=d[c].childNodes[5].firstChild.data;g[6]=d[c].childNodes[6].firstChild.data;g[7]=d[c].childNodes[7].firstChild.data;g[8]=d[c].childNodes[8].firstChild.data;g[9]=d[c].childNodes[9].firstChild.data;g[10]=d[c].childNodes[10].firstChild.data;g[11]=d[c].childNodes[11].firstChild.data;addRowToTable1(f,a,g);reorderRows(f,a)}};var myRowObject=function(b){this.content=Array();for(var a=0;a<b.length;a++){this.content[a]=b[a]}};var addRowToTable1=function(g,l,k){var p=g.tBodies[0].rows.length;var b=p+ROW_BASE;if(l==-1){l=p}else{b=l+ROW_BASE}var j=g.tBodies[0].insertRow(l);var s=(k[3]=="--");if(k[0]==sid){j.className="searchClass"}var e=Array();e[0]=j.insertCell(0);if(s){e[0].innerHTML="<a href='javascript:void(0);' onclick='callAssemblyAjax("+k[0]+")'><img src='images/assembly/folder.gif' border='0' width='16' height='16'></a>"}else{e[0].innerHTML="<img src='images/assembly/item.png' border='0' width='16' height='16'>"}e[1]=j.insertCell(1);var d=document.createTextNode(b);e[1].appendChild(d);e[2]=j.insertCell(2);var u=document.createTextNode(k[1]);e[2].appendChild(u);e[3]=j.insertCell(3);var r=document.createTextNode(k[2]);e[3].appendChild(r);e[4]=j.insertCell(4);var m;var o;var q;var c;if(s){m=document.createTextNode("");o=document.createTextNode("");q=document.createTextNode("-");c=document.createTextNode("")}else{o=document.createTextNode("/");if(k[10]=="-"){m=document.createTextNode(k[3]);displayPrice=(k[8]=="-"?k[4]:k[8])}else{m=document.createTextNode(k[10]);displayPrice=(k[8]=="-"?Math.round(k[4]*k[11]*100)/100:Math.round(k[8]*k[11]*100)/100)}q=document.createTextNode(displayPrice)}e[4].appendChild(q);e[4].appendChild(o);e[4].appendChild(m);e[5]=j.insertCell(5);var t;var n;if(s){t=document.createTextNode("-");n=document.createTextNode("")}else{var i=k[9]=="-"?k[5]:k[9];t=document.createTextNode(i)}e[5].appendChild(t);e[6]=j.insertCell(6);var f=document.createTextNode(k[6]);e[6].appendChild(f);var h=Array();h[0]=0;h[1]=0;h[2]=e[0].innerHTML;h[3]=d;h[4]=u;h[5]=r;h[6]=k[0];h[7]=m;h[8]=q;h[9]=t;h[10]=f;h[11]=k[7];var a=new myRowObject(h);j.myRow=a};var reorderRows=function(d,c){if(d.tBodies[0].rows[c]){var b=c+ROW_BASE;for(var a=c;a<d.tBodies[0].rows.length;a++){d.tBodies[0].rows[a].myRow.content[3].data=b;b++}}};initializeAssemblyTable(10240);var editCostBookInnerDiv="costBookInnerDiv";var asmPropertiesWindowDiv="blankHidden";var asmPropertiesWindow=null;var asmPropertiesWindowId="asmPropertiesWindowId";var myContextCostBookEditWindow=function(){populateCostBookEditWin()};var populateCostBookEditWin=function(){var a="<div id='"+editCostBookInnerDiv+"'></div>";var b=document.getElementById(asmPropertiesWindowDiv);b.innerHTML=a;openMyCostBookPropertiesWin()};var openMyCostBookPropertiesWin=function(){asmPropertiesWindow=internalWindow.open(asmPropertiesWindowId,"div",asmPropertiesWindowDiv,"#CostBook","width=750px,height=500px,left=20px,top=15px,resize=1,scrolling=1");callCbCatAjax(1)};var cbCatTableparent=1;var cbCatTableTop=1;var cbCatTableCurrentParent=1;var cbCatTablecontainer=editCostBookInnerDiv;var CB_TABLE_NAME="cbCatSample123";var CB_DIV_NAV_NAME="cbCatNavDiv123";var CB_ROW_BASE=1;function callCbCatAjax(d){if(document.getElementById(cbCatTablecontainer)==null){return}var b=getHTMLHTTPRequest();cbCatTableCurrentParent=d;var c=parseInt(Math.random()*99999999);var a=myServerAddress+"MyXMLDispatcher?rand="+c+"&path="+100200+"&parent="+d+"&method=getCostBook";b.open("GET",a,true);b.onreadystatechange=function(){if(b.readyState==4){if(b.status==200){renderCbCat(b)}else{alert("Connection Problem:"+b.statusText)}}};writeWaitMsg(cbCatTablecontainer,"themes/icons/ajax_loading/22.gif","Loading page, please wait...");b.send(null)}function renderCbCat(b){var c=b.responseXML;if(c==null){alert("Data Error");return}var d=c.getElementsByTagName("status");var a=systemStatus(cbCatTablecontainer,d);if(a==0){return}var e="";e+="<div id='"+CB_DIV_NAV_NAME+"'></div>";e+="<table id='"+CB_TABLE_NAME+"' width='100%' class='innerContentTable'><thead id='TThead1'><tr><td width='18px'>&nbsp;</td><td width='1%'>Sl</td><td width='10%'>Name</td><td width='100%'>Description</td><td>&nbsp;</td></tr></thead>";e+="<tbody id='TTbody1'></tbody></table>";document.getElementById(cbCatTablecontainer).innerHTML=e;updateCbCatNav(c,CB_DIV_NAV_NAME);populateCbTable(c,CB_TABLE_NAME);addTableRolloverEffect(CB_TABLE_NAME,"tableRollOverEffect2","tableRowClickEffect2")}var updateCbCatNav=function(b,a){var d=b.getElementsByTagName("levelParent");var c="<table class='innerNavTable'><tr>";if(d!=null&&d.length>=1){cbCatTableparent=d[0].getAttribute("id");c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callCbCatAjax("+cbCatTableparent+")'><img src='images/costbook/up.png' border='0' alt='Up one level'></a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callCbCatAjax("+cbCatTableTop+")'><img src='images/costbook/top.png' border='0' alt='Top level'></a></td>"}else{if(searchFlag1==false){c+="<td><img src='images/costbook/up1.png' alt='Up one level'></td>";c+="<td><img src='images/costbook/top1.png' alt='Top level'></td>";cbCatTableparent=1}else{c+="<td><img src='images/costbook/up1.png' alt='Up one level'></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callCbCatAjax("+cbCatTableTop+")'><img src='images/costbook/top.png' border='0' alt='Top level'></a></td>";searchFlag1=false;cbCatTableparent=1}}c+="<td><label>Enter keyword:</label></td><td><input size='40' type='text' id='searchKeyForCB' value=''></td><td><input type='button' value='GO' onclick='vaildateKey1();'></td>";c+="</tr></table>";document.getElementById(a).innerHTML=c};var populateCbTable=function(e,b){var d=e.getElementsByTagName("cbCat");var a;var f;var g;for(var c=0;c<d.length;c++){f=document.getElementById(b);a=f.tBodies[0].rows.length;g=Array();g[0]="cbCat";g[1]=d[c].childNodes[0].firstChild.data;g[2]=d[c].childNodes[1].firstChild.data;g[3]=d[c].childNodes[2].firstChild.data;g[4]=d[c].childNodes[3].firstChild.data;g[5]=d[c].childNodes[4].firstChild.data;addRowToTable2(f,a,g);reorderRows(f,a)}d=e.getElementsByTagName("cb");for(c=0;c<d.length;c++){f=document.getElementById(b);a=f.tBodies[0].rows.length;g=Array();g[0]="cb";g[1]=d[c].childNodes[0].firstChild.data;g[2]=d[c].childNodes[1].firstChild.data;g[3]=d[c].childNodes[2].firstChild.data;g[4]=d[c].childNodes[3].firstChild.data;g[5]=d[c].childNodes[4].firstChild.data;addRowToTable2(f,a,g);reorderRows(f,a)}};var addRowToTable2=function(e,f,c){var k=e.tBodies[0].rows.length;var b=k+CB_ROW_BASE;if(f==-1){f=k}else{b=f+CB_ROW_BASE}var l=e.tBodies[0].insertRow(f);var j=Array();j[0]=l.insertCell(0);if(c[0]=="cbCat"){j[0].innerHTML="<a href='javascript:void(0);' onclick='callCbCatAjax("+c[1]+")'><img src='images/costbook/folder.gif' border='0'></a>"}else{j[0].innerHTML="<img src='images/costbook/costbook.png' border='0'>"}j[1]=l.insertCell(1);var g=document.createTextNode(b);j[1].appendChild(g);j[2]=l.insertCell(2);var a=document.createTextNode(c[2]);j[2].appendChild(a);j[3]=l.insertCell(3);var i=document.createTextNode(c[3]);j[3].appendChild(i);j[4]=l.insertCell(4);if(c[0]=="cbCat"){j[4].innerHTML="&nbsp;"}else{j[4].innerHTML="<a href='javascript:void(0);' onclick='changeCostBook("+c[1]+', "'+c[2]+"\")'><img src='images/common/tick.gif' border='0'></a>"}var d=Array();d[0]=0;d[1]=0;d[2]=j[0].innerHTML;d[3]=g;d[4]=a;d[5]=i;d[6]=c[1];d[7]=c[0];if(c[0]=="cbCat"){d[8]=c[4];d[9]=c[5]}else{d[8]=c[4];d[9]=c[5]}var h=new myRowObject(d);l.myRow=h};var changeCostBook=function(b,a){if(costBookId==b){return}costBookId=b;costBookName=""+a;callAssemblyAjax(assemblyTableCurrentParent)};var printAssemblies=function(){var b;var c=null;var a=contextMenu.srcElement;while(true){c=a.parentNode;if(c.tagName!="TR"){a=c;continue}else{break}}b=c.myRow.content[6];window.open("MyActionDispatcher?path=100300&assemblyId="+b+"&cbId="+costBookId+"&cbName="+URLEncode(costBookName)+"&method=assemblyTreePDF")};var pickedAssembly;var printMaterial=function(){var b;var c=null;var a=contextMenu.srcElement;while(true){c=a.parentNode;if(c.tagName!="TR"){a=c;continue}else{break}}b=""+c.myRow.content[6];pickedAssembly=c;populateVolumePickerWindow(c)};var VolumePickerWindowDiv="blankHidden1";var VolumePickerWindowId="VolumePickerWindowId";var VolumePickerWindow=null;var populateVolumePickerWindow=function(b){var a="<table><tr><td><label>Analysis of Rate for: </label>";a+="<input size='40' type='text' id='pickVolume' value='1'>&nbsp;"+b.myRow.content[7].data+"</td></tr>";a+="<tr><td colspan='2' align='center'><a href='javascript:void(0)' onclick='printReport();'>Generate</a>&nbsp;&nbsp;";a+="</td></tr></table>";var c=document.getElementById(VolumePickerWindowDiv);c.innerHTML=a;VolumePickerWindow=internalWindow.open(VolumePickerWindowId,"div",VolumePickerWindowDiv,"#Enter Volume:["+b.myRow.content[4].data+"]","width=500px,height=250px,left=200px,top=150px,resize=1,scrolling=1")};var printReport=function(){var a=""+pickedAssembly.myRow.content[6];var b=document.getElementById("pickVolume").value;VolumePickerWindow=window.open("MyActionDispatcher?path=100400&assemblyId="+a+"&cbId="+costBookId+"&cbName="+URLEncode(costBookName)+"&volume="+b+"&method=AssemblyMaterialPDF")};var populateSearchWin=function(){var a="<table>";a+="<tr><td><label>Enter keyword:</label></td><td><input size='40' type='text' id='searchKey' value=''></td><td><input type='button' value='GO' onclick='vaildateKey();'></td></tr>";a+="</table>";a+="<div id='searchResult'>&nbsp;</div>";var b=document.getElementById("blankHidden1");b.innerHTML=a;openSearchWin()};var openSearchWin=function(){projectPropertiesWindow=internalWindow.open("searchWindow","div","blankHidden1","Search Assemblies","width=600px,height=400px,left=200px,top=150px,resize=1,scrolling=1")};function vaildateKey(){key=document.getElementById("searchKey").value;if(key.length<3){alert("Enter Minimum 3 Character");return}else{callSearchAssembliesAjax()}}function callSearchAssembliesAjax(){var a=getHTMLHTTPRequest();var d=parseInt(Math.random()*99999999);var c=URLEncode(key);var b=myServerAddress+"MyXMLDispatcher?rand="+d+"&path="+100100+"&key="+c+"&cbId="+costBookId+"&method=searchAssemblies";a.open("GET",b,true);a.onreadystatechange=function(){if(a.readyState==4){if(a.status==200){renderSearch(a)}else{alert("Connection Problem:"+a.statusText)}}};writeWaitMsg("searchResult","themes/icons/ajax_loading/22.gif","Processing request, please wait...");a.send(null)}function renderSearch(c){var d=c.responseXML;if(d==null){alert("Data Error");return}var f=d.getElementsByTagName("status");var a=systemStatus("searchResult",f);if(a==0){return}var b="";b+="<table id='searchTable' width='100%' class='reportTable'><thead><tr><td width='18px'>&nbsp;</td><td width='1%'>Sl</td><td width='20%'>Name</td><td>Description</td><td>Price</td><td>Premium</td></tr></thead>";b+="<tbody id='searchbody'></tbody></table>";document.getElementById("searchResult").innerHTML=b;populateSearchTable(d,"searchTable");var e=document.getElementById("searchResult").innerHTML;document.getElementById("searchResult").innerHTML=doHighlight(e,key);addTableRolloverEffect("searchTable","tableRollOverEffect2","tableRowClickEffect2")}var populateSearchTable=function(e,b){var d=e.getElementsByTagName("item");for(var c=0;c<d.length;c++){var f=document.getElementById(b);var a=f.tBodies[0].rows.length;var g=Array();g[0]=d[c].childNodes[0].firstChild.data;g[1]=d[c].childNodes[1].firstChild.data;g[2]=d[c].childNodes[2].firstChild.data;g[3]=d[c].childNodes[3].firstChild.data;g[4]=d[c].childNodes[4].firstChild.data;g[5]=d[c].childNodes[5].firstChild.data;g[6]=d[c].childNodes[6].firstChild.data;g[7]=d[c].childNodes[7].firstChild.data;g[8]=d[c].childNodes[8].firstChild.data;g[9]=d[c].childNodes[9].firstChild.data;g[10]=d[c].childNodes[10].firstChild.data;g[11]=d[c].childNodes[11].firstChild.data;addRowToSearchTable(f,a,g);reorderRows(f,a)}};var addRowToSearchTable=function(f,k,j){var o=f.tBodies[0].rows.length;var b=o+ROW_BASE;if(k==-1){k=o}else{b=k+ROW_BASE}var i=f.tBodies[0].insertRow(k);var r=(j[3]=="--");var e=Array();e[0]=i.insertCell(0);if(r){e[0].innerHTML="<a href='javascript:void(0);' onclick='sid="+j[0]+";callAssemblyAjax("+j[7]+")'><img src='images/assembly/folder.gif' border='0' width='16' height='16'></a>"}else{e[0].innerHTML="<a href='javascript:void(0);' onclick='sid="+j[0]+";callAssemblyAjax("+j[7]+")'><img src='images/assembly/item.png' border='0' width='16' height='16'></a>"}e[1]=i.insertCell(1);var d=document.createTextNode(b);e[1].appendChild(d);e[2]=i.insertCell(2);var t=document.createTextNode(j[1]);e[2].appendChild(t);e[3]=i.insertCell(3);var q=document.createTextNode(j[2]);e[3].appendChild(q);e[4]=i.insertCell(4);var l;var n;var p;var c;if(r){l=document.createTextNode("");n=document.createTextNode("");p=document.createTextNode("-");c=document.createTextNode("")}else{n=document.createTextNode("/");if(j[10]=="-"){l=document.createTextNode(j[3]);displayPrice=(j[8]=="-"?j[4]:j[8])}else{l=document.createTextNode(j[10]);displayPrice=(j[8]=="-"?Math.round(j[4]*j[11]*100)/100:Math.round(j[8]*j[11]*100)/100)}p=document.createTextNode(displayPrice)}e[4].appendChild(p);e[4].appendChild(n);e[4].appendChild(l);e[5]=i.insertCell(5);var s;var m;if(r){s=document.createTextNode("-");m=document.createTextNode("")}else{var h=j[9]=="-"?j[5]:j[9];s=document.createTextNode(h)}e[5].appendChild(s);var g=Array();g[0]=0;g[1]=0;g[2]=e[0].innerHTML;g[3]=d;g[4]=t;g[5]=q;g[6]=j[0];g[7]=l;g[8]=p;g[9]=s;g[10]=j[6];g[11]=j[7];var a=new myRowObject(g);i.myRow=a};function vaildateKey1(){key1=document.getElementById("searchKeyForCB").value;if(key1.length<3){alert("Enter Minimum 3 Character");return}else{callSearchCBAjax()}}function callSearchCBAjax(e){if(document.getElementById(cbCatTablecontainer)==null){return}var c=getHTMLHTTPRequest();cbCatTableCurrentParent=e;var d=parseInt(Math.random()*99999999);var b=URLEncode(key1);var a=myServerAddress+"MyXMLDispatcher?rand="+d+"&path="+100200+"&key="+b+"&method=searchCostBook";c.open("GET",a,true);c.onreadystatechange=function(){if(c.readyState==4){if(c.status==200){searchFlag1=true;renderCbCat(c)}else{alert("Connection Problem:"+c.statusText)}}};writeWaitMsg(cbCatTablecontainer,"themes/icons/ajax_loading/22.gif","Loading page, please wait...");c.send(null)};