var assemblyTableparent=1;var assemblyTableTop=1;var assemblyTableCurrentParent=1;var assemblyTablecontainer="blankContent";var assemblyPropertiesWindow=null;var INPUT_NAME_PREFIX="inputName";var RADIO_NAME="radName";var TABLE_NAME="assemblySample";var DIV_NAV_NAME="assemblyNavDiv";var ROW_BASE=1;var hasLoaded=false;var ctx_THEAD="ASM_TTHEAD123";var ctx_TBODY="ASM_TTBODY123";var key="qwerty";var sid=0;var callBack=function(){if(myContextMenuRequest.readyState==4){if(myContextMenuRequest.status==200){configureContextMenu();callAssemblyAjax(1)}else{alert("Connection Problem:"+myContextMenuRequest.statusText)}}};var initializeAssemblyTable=function(a){writeWaitMsg(assemblyTablecontainer,"themes/icons/ajax_loading/22.gif","Loading Menu...");callContextMenuAjax(a,callBack)};var menu2=function(){return configureContextMenuModel()};contextMenu.modifyMenu=function(){var a=this.srcElement;currentMenuBar=this.menuBar;var b;while(true){b=a.parentNode;if(b.tagName!="TR"){a=b;continue}else{break}}clickOnTableRowContext(b);if(b.myRow==null){setMenuItemState(210060,"disabled");setMenuItemState(210070,"disabled");setMenuItemState(210090,"disabled");setMenuItemState(210100,"disabled")}else{setMenuItemState(210060,"regular");setMenuItemState(210070,"regular");setMenuItemState(210090,"regular");setMenuItemState(210100,"regular")}if(myMoveAction.movableItemType==null){setMenuItemState(210110,"disabled")}else{setMenuItemState(210110,"regular")}if(assemblyTableCurrentParent==1){setMenuItemState(210010,"disabled");setMenuItemState(210020,"disabled")}else{setMenuItemState(210010,"regular");setMenuItemState(210020,"regular")}setMenuPermissions(currentMenuBar)};function callAssemblyAjax(d){if(document.getElementById(assemblyTablecontainer)==null){return}if(assemblyPropertiesWindow!=null){assemblyPropertiesWindow.close()}var b=getHTMLHTTPRequest();assemblyTableCurrentParent=d;var c=parseInt(Math.random()*99999999);var a=myServerAddress+"MyXMLDispatcher?rand="+c+"&path="+20010+"&parent="+d+"&method=get";b.open("GET",a,true);b.onreadystatechange=function(){if(b.readyState==4){if(b.status==200){renderAssembly(b)}else{alert("Connection Problem:"+b.statusText)}}};writeWaitMsg(assemblyTablecontainer,"themes/icons/ajax_loading/22.gif","Processing request, please wait...");b.send(null)}function renderAssembly(b){var c=b.responseXML;if(c==null){alert("Data Error");return}var d=c.getElementsByTagName("status");var a=systemStatus(assemblyTablecontainer,d);if(a==0){return}var e="";e+="<div id='"+DIV_NAV_NAME+"'></div>";e+="<table id='"+TABLE_NAME+"' width='100%' class='contentTable'><thead id='"+ctx_THEAD+"'><tr><td width='18px'>&nbsp;</td><td width='1%'>Sl</td><td width='15%'>Name</td><td width='60%'>Description</td><td>Price</td><td>Premium(%)</td><td width='16px'>D</td><td width='16px'>E</td></tr></thead>";e+="<tbody id='"+ctx_TBODY+"'></tbody></table>";document.getElementById(assemblyTablecontainer).innerHTML=e;updateAssemblyNav(c,DIV_NAV_NAME);initiateTableRollover(TABLE_NAME,"tableRollOverEffect1","tableRowClickEffect1");populateTable(c,TABLE_NAME);contextMenu.attachTo(ctx_THEAD,menu2());contextMenu.attachTo(ctx_TBODY,menu2())}var updateAssemblyNav=function(b,a){var d=b.getElementsByTagName("levelParent");var c="<table class='navTable'><tr>";if(d!=null&&d.length>=1){assemblyTableparent=d[0].getAttribute("id");c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callAssemblyAjax("+assemblyTableparent+")'><img src='images/assembly/up.png' border='0' alt='Up one level'></a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callAssemblyAjax("+assemblyTableTop+")'><img src='images/assembly/top.png' border='0' alt='Top level'></a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='myAssemblyAddWindow(\""+TABLE_NAME+"\");'>Add</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='myAssemblyEditWindow(\""+TABLE_NAME+"\");'>Edit[E]</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='deleteChecked(\""+TABLE_NAME+"\");'>Delete[D]</a></td>"}else{c+="<td><img src='images/assembly/up1.png' alt='Up one level'></td>";c+="<td><img src='images/assembly/top1.png' alt='Top level'></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='myAssemblyAddWindow(\""+TABLE_NAME+"\");'>Add</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='myAssemblyEditWindow(\""+TABLE_NAME+"\");'>Edit[E]</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='deleteChecked(\""+TABLE_NAME+"\");'>Delete[D]</a></td>";assemblyTableparent=1}c+="<td>&nbsp;</td><td align='right'><input type='button' name='search' value='Search' onclick='populateSearchWin();'/></td>";c+="</tr></table>";document.getElementById(a).innerHTML=c};var populateTable=function(e,b){var d=e.getElementsByTagName("item");for(var c=0;c<d.length;c++){var f=document.getElementById(b);var a=f.tBodies[0].rows.length;var g=Array();g[0]=d[c].childNodes[0].firstChild.data;g[1]=d[c].childNodes[1].firstChild.data;g[2]=d[c].childNodes[2].firstChild.data;g[3]=d[c].childNodes[3].firstChild.data;g[4]=d[c].childNodes[4].firstChild.data;g[5]=d[c].childNodes[5].firstChild.data;g[6]=d[c].childNodes[6].firstChild.data;g[7]=d[c].childNodes[7].firstChild.data;g[8]=d[c].childNodes[8].firstChild.data;g[9]=d[c].childNodes[9].firstChild.data;addRowToTable1(f,a,g);reorderRows(f,a)}};var myRowObject=function(b){this.content=Array();for(var a=0;a<b.length;a++){this.content[a]=b[a]}};var addRowToTable1=function(e,i,h){var m=e.tBodies[0].rows.length;var b=m+ROW_BASE;if(i==-1){i=m}else{b=i+ROW_BASE}var g=e.tBodies[0].insertRow(i);var q=(h[3]=="--");if(h[0]==sid){g.className="searchClass"}var d=Array();d[0]=g.insertCell(0);if(q){d[0].innerHTML="<a href='javascript:void(0);' onclick='callAssemblyAjax("+h[0]+")'><img src='images/assembly/folder.gif' border='0' width='16' height='16'></a>"}else{d[0].innerHTML="<img src='images/assembly/item.png' border='0' width='16' height='16'>"}d[1]=g.insertCell(1);var c=document.createTextNode(b);d[1].appendChild(c);d[2]=g.insertCell(2);var u=document.createTextNode(h[1]);d[2].appendChild(u);d[3]=g.insertCell(3);var p=document.createTextNode(h[2]);d[3].appendChild(p);d[4]=g.insertCell(4);var k;var l;var n;if(q){k=document.createTextNode("");l=document.createTextNode("");n=document.createTextNode("-")}else{k=document.createTextNode(h[3]);l=document.createTextNode("/");n=document.createTextNode(h[4])}d[4].appendChild(n);d[4].appendChild(l);d[4].appendChild(k);d[5]=g.insertCell(5);var t;if(q){t=document.createTextNode("-")}else{t=document.createTextNode(h[5])}d[5].appendChild(t);d[6]=g.insertCell(6);var s=document.createElement("input");s.setAttribute("type","checkbox");d[6].appendChild(s);d[7]=g.insertCell(7);var j;try{j=document.createElement('<input type="radio" name="'+RADIO_NAME+'" value="'+b+'">');var o=j.name.length}catch(r){j=document.createElement("input");j.setAttribute("type","radio");j.setAttribute("name",RADIO_NAME);j.setAttribute("value",b)}d[7].appendChild(j);var f=Array();f[0]=s;f[1]=j;f[2]=d[0].innerHTML;f[3]=c;f[4]=u;f[5]=p;f[6]=h[0];f[7]=k;f[8]=n;f[9]=t;f[10]=h[6];f[11]=h[7];f[12]=h[8];f[13]=h[9];var a=new myRowObject(f);g.myRow=a;addRowRolloverEffect(g)};function callDeleteAssemblyAjax(h,j,d){if(!confirmDelete()){return}var f=getHTMLHTTPRequest();var l;var c=Array();var e;l=h;c=j;e=d;var k=parseInt(Math.random()*99999999);var b="";for(var g=0;g<j.length;g++){if(g==0){b+=j[g].myRow.content[6]}else{b+=","+j[g].myRow.content[6]}}var a=myServerAddress+"MyXMLDispatcher?rand="+k+"&path="+20020+"&id="+URLEncode(b)+"&method=delete";f.open("GET",a,true);f.onreadystatechange=function(){if(f.readyState==4){if(f.status==200){var m=f.responseXML;var i=0;if(m==null){alert("Data Error")}else{var n=m.getElementsByTagName("status");i=systemStatus(null,n)}if(i==1){deleteRows(c);reorderRows(l,e)}else{if(i==2){alert("DELETE: System Error")}}}else{alert("Connection Problem:"+f.statusText)}closeSplashScreen()}};openSplashScreen();f.send(null)}var deleteChecked=function(d){var f=document.getElementById(d);var a=new Array();var b=0;for(var c=0;c<f.tBodies[0].rows.length;c++){if(f.tBodies[0].rows[c].myRow.content[0].checked){a[b]=f.tBodies[0].rows[c];b++}}if(a.length>0){var e=a[0].sectionRowIndex;callDeleteAssemblyAjax(f,a,e)}};var deleteRows=function(c){for(var a=0;a<c.length;a++){var b=c[a].sectionRowIndex;c[a].parentNode.deleteRow(b)}};var reorderRows=function(d,c){if(d.tBodies[0].rows[c]){var b=c+ROW_BASE;for(var a=c;a<d.tBodies[0].rows.length;a++){d.tBodies[0].rows[a].myRow.content[3].data=b;b++}}};var deleteContextChecked=function(){var a=new Array();var b=contextMenu.srcElement;while(true){a[0]=b.parentNode;if(a[0].tagName!="TR"){b=a[0];continue}else{break}}var d=a[0].parentNode.parentNode;var c=a[0].sectionRowIndex;callDeleteAssemblyAjax(d,a,c)};var assemblyPropertiesWindowDiv="blankHidden";var assemblyPropertiesWindowTitle="Properties";var assemblyPropertiesWindowId="assemblyPropertiesWindowId";var indexOfRowToEdit=-1;var rowToEdit=null;var myContextAssemblyEditWindow=function(){indexOfRowToEdit=-1;rowToEdit=null;var a=contextMenu.srcElement;while(true){rowToEdit=a.parentNode;if(rowToEdit.tagName!="TR"){a=rowToEdit;continue}else{break}}var b=rowToEdit.parentNode.parentNode;if(rowToEdit!=null){populateAssemblyEditWin()}};var myAssemblyEditWindow=function(b){var c=document.getElementById(b);indexOfRowToEdit=-1;rowToEdit=null;for(var a=0;a<c.tBodies[0].rows.length;a++){if(c.tBodies[0].rows[a].myRow&&c.tBodies[0].rows[a].myRow.content[1].getAttribute("type")=="radio"&&c.tBodies[0].rows[a].myRow.content[1].checked){indexOfRowToEdit=a;rowToEdit=c.tBodies[0].rows[a]}}if(rowToEdit!=null){populateAssemblyEditWin()}};var populateAssemblyEditWin=function(){var a="<table>";if(rowToEdit!=null){a+="<tr><td><label>Name:</label></td><td><input size='40' type='text' id='editName' value='"+rowToEdit.myRow.content[4].data+"'></td></tr>";a+="<tr><td><label>Description:</label></td><td><textarea rows='6' cols='30' id='editDescription'>"+rowToEdit.myRow.content[5].data+"</textarea></td></tr>";a+="<tr><td><label>Unit:</label></td>";a+="<td><select id='editUnit' onchange='showUnitOptions()'>";a+="<option value='--' "+(rowToEdit.myRow.content[7].data=="--"?"selected='selected'":"")+">--</option>";a+="<option value='LS' "+(rowToEdit.myRow.content[7].data=="LS"?"selected='selected'":"")+">lump sum(LS)</option>";a+="<option value='Nos.' "+(rowToEdit.myRow.content[7].data=="Nos."?"selected='selected'":"")+">numbers(Nos.)</option>";a+="<option value='m' "+(rowToEdit.myRow.content[7].data=="m"?"selected='selected'":"")+">metre(m)</option>";a+="<option value='sqm' "+(rowToEdit.myRow.content[7].data=="sqm"?"selected='selected'":"")+">square metre(sqm)</option>";a+="<option value='cum' "+(rowToEdit.myRow.content[7].data=="cum"?"selected='selected'":"")+">cubic metre(cum)</option>";a+="<option value='kg' "+(rowToEdit.myRow.content[7].data=="kg"?"selected='selected'":"")+">kilogram(kg)</option>";a+="<option value='hr' "+(rowToEdit.myRow.content[7].data=="hr"?"selected='selected'":"")+">hour(hr)</option>";a+="<option value='Mandays' "+(rowToEdit.myRow.content[7].data=="Mandays"?"selected='selected'":"")+">Mandays</option>";a+="</select></td></tr>";a+="<tr><td><label>Price:</label></td><td><input size='40' type='text' id='editPrice' value='"+(rowToEdit.myRow.content[8].data!="-"?rowToEdit.myRow.content[8].data:0)+"'></td></tr>";a+="<tr><td><label>Premium:</label></td><td><input size='40' type='text' id='editPremium' value='"+(rowToEdit.myRow.content[9].data!="-"?rowToEdit.myRow.content[9].data:0)+"'></td></tr>";a+="<tr><td><label>Displayed Unit:</label></td><td><input size='40' type='text' id='editDisplayedUnit' value='"+rowToEdit.myRow.content[12]+"'></td></tr>";a+="<tr><td><label>Unit Multiplier:</label></td><td><input size='40' type='text' id='editPriceMultiplier' value='"+rowToEdit.myRow.content[13]+"'></td></tr>";a+="<tr><td><label>Remarks:</label></td><td><textarea rows='6' cols='30' id='editRemarks'>"+rowToEdit.myRow.content[10]+"</textarea></td></tr>";a+="<tr><td colspan='2' align='center'><a href='javascript:void(0)' onclick='callEditAssemblyAjax();'>Update</a>&nbsp;&nbsp;";a+="<a href='javascript:void(0)' onclick='assemblyPropertiesWindow.close()'>Discard</a></td></tr>"}a+="</table>";var b=document.getElementById(assemblyPropertiesWindowDiv);b.innerHTML=a;if(rowToEdit.myRow.content[7].data=="--"||rowToEdit.myRow.content[7].data==""){document.getElementById("editPrice").parentNode.parentNode.childNodes[0].style.display="none";document.getElementById("editPrice").parentNode.parentNode.childNodes[1].style.display="none";document.getElementById("editPremium").parentNode.parentNode.childNodes[0].style.display="none";document.getElementById("editPremium").parentNode.parentNode.childNodes[1].style.display="none";document.getElementById("editDisplayedUnit").parentNode.parentNode.childNodes[0].style.display="none";document.getElementById("editDisplayedUnit").parentNode.parentNode.childNodes[1].style.display="none";document.getElementById("editPriceMultiplier").parentNode.parentNode.childNodes[0].style.display="none";document.getElementById("editPriceMultiplier").parentNode.parentNode.childNodes[1].style.display="none"}else{document.getElementById("editPrice").parentNode.parentNode.childNodes[0].style.display="";document.getElementById("editPrice").parentNode.parentNode.childNodes[1].style.display="";document.getElementById("editPremium").parentNode.parentNode.childNodes[0].style.display="";document.getElementById("editPremium").parentNode.parentNode.childNodes[1].style.display="";document.getElementById("editDisplayedUnit").parentNode.parentNode.childNodes[0].style.display="";document.getElementById("editDisplayedUnit").parentNode.parentNode.childNodes[1].style.display="";document.getElementById("editPriceMultiplier").parentNode.parentNode.childNodes[0].style.display="";document.getElementById("editPriceMultiplier").parentNode.parentNode.childNodes[1].style.display=""}openMyAssemblyPropertiesWin()};var showUnitOptions=function(){if(document.getElementById("editUnit").value=="--"){document.getElementById("editPrice").parentNode.parentNode.childNodes[0].style.display="none";document.getElementById("editPrice").parentNode.parentNode.childNodes[1].style.display="none";document.getElementById("editPremium").parentNode.parentNode.childNodes[0].style.display="none";document.getElementById("editPremium").parentNode.parentNode.childNodes[1].style.display="none";document.getElementById("editDisplayedUnit").parentNode.parentNode.childNodes[0].style.display="none";document.getElementById("editDisplayedUnit").parentNode.parentNode.childNodes[1].style.display="none";document.getElementById("editPriceMultiplier").parentNode.parentNode.childNodes[0].style.display="none";document.getElementById("editPriceMultiplier").parentNode.parentNode.childNodes[1].style.display="none"}else{document.getElementById("editPrice").parentNode.parentNode.childNodes[0].style.display="";document.getElementById("editPrice").parentNode.parentNode.childNodes[1].style.display="";document.getElementById("editPremium").parentNode.parentNode.childNodes[0].style.display="";document.getElementById("editPremium").parentNode.parentNode.childNodes[1].style.display="";document.getElementById("editDisplayedUnit").parentNode.parentNode.childNodes[0].style.display="";document.getElementById("editDisplayedUnit").parentNode.parentNode.childNodes[1].style.display="";document.getElementById("editPriceMultiplier").parentNode.parentNode.childNodes[0].style.display="";document.getElementById("editPriceMultiplier").parentNode.parentNode.childNodes[1].style.display=""}};var openMyAssemblyPropertiesWin=function(){assemblyPropertiesWindow=internalWindow.open("assemblyPropertiesWindowId","div",assemblyPropertiesWindowDiv,"#Properties Window","width=500px,height=450px,left=150px,top=100px,resize=1,scrolling=1")};var callEditAssemblyAjax=function(){var c="";var h=getHTMLHTTPRequest();var f=parseInt(Math.random()*99999999);var i=document.getElementById("editName").value;var e=document.getElementById("editDescription").value;var d=document.getElementById("editUnit").value;document.getElementById("editUnit").style.display="none";document.getElementById("editUnit").parentNode.insertBefore(document.createTextNode(d),document.getElementById("editUnit"));var k=document.getElementById("editPrice").value;var l=document.getElementById("editPremium").value;var j=document.getElementById("editDisplayedUnit").value==""?"-":document.getElementById("editDisplayedUnit").value;var b=document.getElementById("editPriceMultiplier").value==""?"0":document.getElementById("editPriceMultiplier").value;var g=document.getElementById("editRemarks").value;c="id="+rowToEdit.myRow.content[6];c+="&name="+URLEncode(i);c+="&description="+URLEncode(e);c+="&unit="+URLEncode(d);c+="&price="+k;c+="&premium="+l;c+="&displayUnit="+URLEncode(j);c+="&priceMultiplier="+b;c+="&remarks="+URLEncode(g);var a=myServerAddress+"MyXMLDispatcher?rand="+f+"&path="+20030+"&method=update";h.open("POST",a,true);h.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8");h.setRequestHeader("Content-length",c.length);h.onreadystatechange=function(){if(h.readyState==4){if(h.status==200){var n=h.responseXML;var m=0;if(n==null){alert("Data Error")}else{var o=n.getElementsByTagName("status");m=systemStatus(null,o)}if(m==1){rowToEdit.myRow.content[4].data=i;rowToEdit.myRow.content[5].data=e;rowToEdit.myRow.content[7].data=d=="--"?"":d;rowToEdit.myRow.content[8].data=d=="--"?"-":k;rowToEdit.myRow.content[8].parentNode.childNodes[1].data=d=="--"?"":"/";rowToEdit.myRow.content[9].data=d=="--"?"-":l;rowToEdit.myRow.content[10]=g;rowToEdit.myRow.content[12]=j;rowToEdit.myRow.content[13]=b;if(d=="--"){rowToEdit.cells[0].innerHTML="<a href='javascript:void(0);' onclick='callAssemblyAjax("+rowToEdit.myRow.content[6]+")'><img src='images/assembly/folder.gif' border='0' width='16' height='16'></a>"}else{rowToEdit.cells[0].innerHTML="<img src='images/assembly/item.png' border='0' width='16' height='16'>"}}else{if(m==2){alert("EDIT: System Error")}}assemblyPropertiesWindow.close()}else{alert("Connection Problem:"+h.statusText);assemblyPropertiesWindow.close()}closeSplashScreen()}};openSplashScreen();h.send(c)};var myAssemblyTable=null;var myAssemblyAddWindow=function(a){var b=document.getElementById(a);myAssemblyTable=b;populateMaterialAddWin()};var populateMaterialAddWin=function(){var a="<table>";a+="<tr><td><label>Name:</label></td><td><input size='40' type='text' id='editName' value='name'></td></tr>";a+="<tr><td><label>Description:</label></td><td><textarea rows='6' cols='30' id='editDescription'>specification</textarea></td></tr>";a+="<tr><td><label>Unit:</label></td>";a+="<td><select id='editUnit'  onchange='showUnitOptions()'>";a+="<option value='--'>--</option>";a+="<option value='LS'>lump sum(LS)</option>";a+="<option value='Nos.'>number(Nos.)</option>";a+="<option value='m'>metre(m)</option>";a+="<option value='sqm'>square metre(sqm)</option>";a+="<option value='cum'>cubic metre(cum)</option>";a+="<option value='kg'>kilogram(kg)</option>";a+="<option value='Hours'>hour(hr)</option>";a+="<option value='Mandays'>Mandays</option>";a+="</select></td></tr>";a+="<tr><td><label>Price:</label></td><td><input size='40' type='text' id='editPrice' value='0.000'></td></tr>";a+="<tr><td><label>Premium:</label></td><td><input size='40' type='text' id='editPremium' value='0'></td></tr>";a+="<tr><td><label>Displayed Unit:</label></td><td><input size='40' type='text' id='editDisplayedUnit' value='-'></td></tr>";a+="<tr><td><label>Unit Multiplier:</label></td><td><input size='40' type='text' id='editPriceMultiplier' value='0'></td></tr>";a+="<tr><td><label>Remarks:</label></td><td><textarea rows='6' cols='30' id='editRemarks'>remarks</textarea></td></tr>";a+="<tr><td colspan='2' align='center'><a href='javascript:void(0)' onclick='callAddAssemblyAjax();'>Add</a>&nbsp;&nbsp;";a+="<a href='javascript:void(0)' onclick='assemblyPropertiesWindow.close()'>Discard</a></td></tr>";a+="</table>";var b=document.getElementById(assemblyPropertiesWindowDiv);b.innerHTML=a;document.getElementById("editPrice").parentNode.parentNode.childNodes[0].style.display="none";document.getElementById("editPrice").parentNode.parentNode.childNodes[1].style.display="none";document.getElementById("editPremium").parentNode.parentNode.childNodes[0].style.display="none";document.getElementById("editPremium").parentNode.parentNode.childNodes[1].style.display="none";document.getElementById("editDisplayedUnit").parentNode.parentNode.childNodes[0].style.display="none";document.getElementById("editDisplayedUnit").parentNode.parentNode.childNodes[1].style.display="none";document.getElementById("editPriceMultiplier").parentNode.parentNode.childNodes[0].style.display="none";document.getElementById("editPriceMultiplier").parentNode.parentNode.childNodes[1].style.display="none";openMyAssemblyPropertiesWin()};var callAddAssemblyAjax=function(){var j="";var k=getHTMLHTTPRequest();var e=parseInt(Math.random()*99999999);var g=document.getElementById("editName").value;var d=document.getElementById("editDescription").value;var c=document.getElementById("editUnit").value;document.getElementById("editUnit").style.display="none";document.getElementById("editUnit").parentNode.insertBefore(document.createTextNode(c),document.getElementById("editUnit"));var i=document.getElementById("editPrice").value;var l=document.getElementById("editPremium").value;var h=document.getElementById("editDisplayedUnit").value==""?"-":document.getElementById("editDisplayedUnit").value;var b=document.getElementById("editPriceMultiplier").value==""?"0":document.getElementById("editPriceMultiplier").value;var f=document.getElementById("editRemarks").value;j="id="+assemblyTableCurrentParent;j+="&name="+URLEncode(g);j+="&description="+URLEncode(d);j+="&unit="+URLEncode(c);j+="&price="+i;j+="&premium="+l;j+="&displayUnit="+URLEncode(h);j+="&priceMultiplier="+b;j+="&remarks="+URLEncode(f);var a=myServerAddress+"MyXMLDispatcher?rand="+e+"&path="+20040+"&method=add";k.open("POST",a,true);k.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8");k.setRequestHeader("Content-length",j.length);k.onreadystatechange=function(){if(k.readyState==4){if(k.status==200){var o=k.responseXML;var m=0;if(o==null){alert("Data Error")}else{var p=o.getElementsByTagName("status");m=systemStatus(null,p)}if(m==1){var n=o.getElementsByTagName("key")[0].getAttribute("value");var q=Array();q[0]=""+n;q[1]=g;q[2]=d;q[3]=c;q[4]=i;q[5]=l;q[6]=f;q[7]=""+assemblyTableCurrentParent;q[8]=""+h;q[9]=""+b;addRowToTable1(myAssemblyTable,-1,q)}else{if(m==2){alert("ADD: System Error")}}assemblyPropertiesWindow.close()}else{alert("Connection Problem:"+k.statusText);assemblyPropertiesWindow.close()}closeSplashScreen()}};openSplashScreen();k.send(j)};var myParamsForMovableItem=new Array();var cutContextSelected=function(){myMoveAction.reInit();var c=null;var b=contextMenu.srcElement;while(true){c=b.parentNode;if(c.tagName!="TR"){b=c;continue}else{break}}myMoveAction.cut("cutAssembly",c.myRow.content[6],c.myRow.content[11]);var a=new Array();a[0]=""+c.myRow.content[6];a[1]=""+c.myRow.content[4].data;a[2]=""+c.myRow.content[5].data;a[3]=""+(c.myRow.content[7].data==""?"--":c.myRow.content[7].data);a[4]=""+c.myRow.content[8].data;a[5]=""+c.myRow.content[9].data;a[6]=""+c.myRow.content[10];a[7]=""+c.myRow.content[11];a[8]=""+c.myRow.content[12];a[9]=""+c.myRow.content[13];myMoveAction.initParams(a)};var copyContextSelected=function(){myMoveAction.reInit();var c=null;var b=contextMenu.srcElement;while(true){c=b.parentNode;if(c.tagName!="TR"){b=c;continue}else{break}}myMoveAction.cut("copyAssembly",c.myRow.content[6],c.myRow.content[11]);var a=new Array();a[0]=""+c.myRow.content[6];a[1]=""+c.myRow.content[4].data;a[2]=""+c.myRow.content[5].data;a[3]=""+(c.myRow.content[7].data==""?"--":c.myRow.content[7].data);a[4]=""+c.myRow.content[8].data;a[5]=""+c.myRow.content[9].data;a[6]=""+c.myRow.content[10];a[7]=""+c.myRow.content[11];a[8]=""+c.myRow.content[12];a[9]=""+c.myRow.content[13];myMoveAction.initParams(a)};var callPasteToLocationAjax=function(){myMoveAction.verify=function(){if(this.movableItemType=="cutAssembly"){if(this.movableItemId==this.movableToParentId){alert("Cannot move selected to it's own subtree");return false}if(this.movableFromCurrentParentId==this.movableToParentId){alert("Please chose a different location");return false}return true}else{return true}};if(myMoveAction.paste(assemblyTableCurrentParent)==false){return}var f=getHTMLHTTPRequest();var e=parseInt(Math.random()*99999999);var h=myMoveAction.movableItemId;var c=myMoveAction.movableItemType;var a=myMoveAction.movableFromCurrentParentId;var d=myMoveAction.movableToParentId;var g=myMoveAction.paramArray;g[7]=d;var c=""+myMoveAction.movableItemType;var b="";if(c=="cutAssembly"){b=myServerAddress+"MyXMLDispatcher?rand="+e+"&path="+20610+"&id="+h+"&pid="+a+"&newPid="+d+"&method="+c}else{b=myServerAddress+"MyXMLDispatcher?rand="+e+"&path="+20611+"&id="+h+"&pid="+a+"&newPid="+d+"&method="+c}f.open("GET",b,true);f.onreadystatechange=function(){if(f.readyState==4){if(f.status==200){var j=f.responseXML;var i=0;if(j==null){alert("Data Error")}else{var k=j.getElementsByTagName("status");i=systemStatus(null,k)}if(i==1){if(c=="cutAssembly"){addRowToTable1(document.getElementById(TABLE_NAME),-1,g)}else{if(c=="copyAssembly"){var l=j.getElementsByTagName("key");g[0]=""+l[0].getAttribute("value");addRowToTable1(document.getElementById(TABLE_NAME),-1,g)}}}else{if(i==2){alert("Copy/Move: an error occured")}}}else{alert("Connection Problem:"+f.statusText)}myMoveAction.reInit();closeSplashScreen()}};openSplashScreen();f.send(null)};var populateSearchWin=function(){var a="<table>";a+="<tr><td><label>Enter keyword:</label></td><td><input size='40' type='text' id='searchKey' value=''></td><td><input type='button' value='GO' onclick='vaildateKey();'></td></tr>";a+="</table>";a+="<div id='searchResult'>&nbsp;</div>";var b=document.getElementById("blankHidden1");b.innerHTML=a;openSearchWin()};var openSearchWin=function(){projectPropertiesWindow=internalWindow.open("searchWindow","div","blankHidden1","Search Assemblies","width=600px,height=400px,left=200px,top=150px,resize=1,scrolling=1")};function vaildateKey(){key=document.getElementById("searchKey").value;if(key.length<3){alert("Enter Minimum 3 Character");return}else{callSearchAssembliesAjax()}}function callSearchAssembliesAjax(){var a=getHTMLHTTPRequest();var d=parseInt(Math.random()*99999999);var c=URLEncode(key);var b=myServerAddress+"MyXMLDispatcher?rand="+d+"&path="+20010+"&key="+c+"&method=searchAssemblies";a.open("GET",b,true);a.onreadystatechange=function(){if(a.readyState==4){if(a.status==200){renderSearch(a)}else{alert("Connection Problem:"+a.statusText)}}};writeWaitMsg("searchResult","themes/icons/ajax_loading/22.gif","Processing request, please wait...");a.send(null)}function renderSearch(c){var d=c.responseXML;if(d==null){alert("Data Error");return}var f=d.getElementsByTagName("status");var a=systemStatus("searchResult",f);if(a==0){return}var b="";b+="<table id='searchTable' width='100%' class='contentTable'><thead><tr><td width='18px'>&nbsp;</td><td width='1%'>Sl</td><td width='20%'>Name</td><td>Description</td><td>Price</td><td>Premium</td></tr></thead>";b+="<tbody id='searchbody'></tbody></table>";document.getElementById("searchResult").innerHTML=b;populateSearchTable(d,"searchTable");var e=document.getElementById("searchResult").innerHTML;document.getElementById("searchResult").innerHTML=doHighlight(e,key);addTableRolloverEffect("searchTable","tableRollOverEffect2","tableRowClickEffect2")}var populateSearchTable=function(e,b){var d=e.getElementsByTagName("item");for(var c=0;c<d.length;c++){var f=document.getElementById(b);var a=f.tBodies[0].rows.length;var g=Array();g[0]=d[c].childNodes[0].firstChild.data;g[1]=d[c].childNodes[1].firstChild.data;g[2]=d[c].childNodes[2].firstChild.data;g[3]=d[c].childNodes[3].firstChild.data;g[4]=d[c].childNodes[4].firstChild.data;g[5]=d[c].childNodes[5].firstChild.data;g[6]=d[c].childNodes[6].firstChild.data;g[7]=d[c].childNodes[7].firstChild.data;g[8]=d[c].childNodes[8].firstChild.data;g[9]=d[c].childNodes[9].firstChild.data;addRowToSearchTable(f,a,g);reorderRows(f,a)}};var addRowToSearchTable=function(e,f,c){var o=e.tBodies[0].rows.length;var b=o+ROW_BASE;if(f==-1){f=o}else{b=f+ROW_BASE}var q=e.tBodies[0].insertRow(f);var j=(c[3]=="--");var n=Array();n[0]=q.insertCell(0);if(j){n[0].innerHTML="<a href='javascript:void(0);' onclick='sid="+c[0]+";callAssemblyAjax("+c[7]+");'><img src='images/assembly/folder.gif' border='0' width='16' height='16'></a>"}else{n[0].innerHTML="<a href='javascript:void(0);' onclick='sid="+c[0]+"; callAssemblyAjax("+c[7]+");'><img src='images/assembly/item.png' border='0' width='16' height='16'></a>"}n[1]=q.insertCell(1);var h=document.createTextNode(b);n[1].appendChild(h);n[2]=q.insertCell(2);var a=document.createTextNode(c[1]);n[2].appendChild(a);n[3]=q.insertCell(3);var m=document.createTextNode(c[2]);n[3].appendChild(m);n[4]=q.insertCell(4);var l;var p;var g;if(j){l=document.createTextNode("");p=document.createTextNode("");g=document.createTextNode("-")}else{l=document.createTextNode(c[3]);p=document.createTextNode("/");g=document.createTextNode(c[4])}n[4].appendChild(g);n[4].appendChild(p);n[4].appendChild(l);n[5]=q.insertCell(5);var k;if(j){k=document.createTextNode("-")}else{k=document.createTextNode(c[5])}n[5].appendChild(k);var d=Array();d[0]=0;d[1]=0;d[2]=n[0].innerHTML;d[3]=h;d[4]=a;d[5]=m;d[6]=c[0];d[7]=l;d[8]=g;d[9]=k;d[10]=c[6];d[11]=c[7];d[12]=c[8];d[13]=c[9];var i=new myRowObject(d);q.myRow=i};initializeAssemblyTable(10010);