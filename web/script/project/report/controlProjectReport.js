var controlProjectTableparent=1;var controlProjectTableTop=1;var controlProjectTableCurrentParent=1;var controlProjectTablecontainer="blankContent";var INPUT_NAME_PREFIX="inputName";var RADIO_NAME="radName";var TABLE_NAME="controlProjectSample";var DIV_NAV_NAME="controlProjectNavDiv";var ROW_BASE=1;var hasLoaded=false;var ctx_THEAD="CPROJREPORT_TTHEAD123";var ctx_TBODY="CPROJREPORT_TTBODY123";var key="qwerty";var sid=0;var callBack=function(){if(myContextMenuRequest.readyState==4){if(myContextMenuRequest.status==200){configureContextMenu();callControlProjectAjax(1)}else{alert("Connection Problem:"+myContextMenuRequest.statusText)}}};var initializeControlProjectTable=function(a){myCurrentMenuParent=a;writeWaitMsg(controlProjectTablecontainer,"themes/icons/ajax_loading/22.gif","Loading Menu...");callContextMenuAjax(a,callBack)};var menu2=function(){return configureContextMenuModel()};contextMenu.modifyMenu=function(){var a=this.srcElement;currentMenuBar=this.menuBar;var b;while(true){b=a.parentNode;if(b.tagName!="TR"){a=b;continue}else{break}}clickOnTableRowContext(b);if(b.myRow==null){setMenuItemState(212540,"disabled");setMenuItemState(212550,"disabled")}else{if(b.myRow.content[7]=="controlProject"){setMenuItemState(212540,"regular");setMenuItemState(212550,"disabled")}else{setMenuItemState(212540,"disabled");setMenuItemState(212550,"regular")}}if(controlProjectTableCurrentParent==1){setMenuItemState(212510,"disabled");setMenuItemState(212520,"disabled")}else{setMenuItemState(212510,"regular");setMenuItemState(212520,"regular")}setMenuPermissions(currentMenuBar)};function callControlProjectAjax(d){if(document.getElementById(controlProjectTablecontainer)==null){return}var b=getHTMLHTTPRequest();controlProjectTableCurrentParent=d;var c=parseInt(Math.random()*99999999);var a=myServerAddress+"MyXMLDispatcher?rand="+c+"&path="+103100+"&parent="+d+"&method=get";b.open("GET",a,true);b.onreadystatechange=function(){if(b.readyState==4){if(b.status==200){renderControlProject(b)}else{alert("Connection Problem:"+b.statusText)}}};writeWaitMsg(controlProjectTablecontainer,"themes/icons/ajax_loading/22.gif","Processing request, please wait...");b.send(null)}function renderControlProject(b){var c=b.responseXML;if(c==null){alert("Data Error");return}var d=c.getElementsByTagName("status");var a=systemStatus(controlProjectTablecontainer,d);if(a==0){return}var e="";e+="<div id='"+DIV_NAV_NAME+"'></div>";e+="<table id='"+TABLE_NAME+"' width='100%' class='reportTable'><thead id='"+ctx_THEAD+"'><tr><td width='18px'>&nbsp;</td><td width='1%'>Sl</td><td width='20%'>Name</td><td width='100%'>Description</td></tr></thead>";e+="<tbody id='"+ctx_TBODY+"'></tbody></table>";document.getElementById(controlProjectTablecontainer).innerHTML=e;updateControlProjectNav(c,DIV_NAV_NAME);populateTable(c,TABLE_NAME);addTableRolloverEffect(TABLE_NAME,"tableRollOverEffect1","tableRowClickEffect1");contextMenu.attachTo(ctx_THEAD,menu2());contextMenu.attachTo(ctx_TBODY,menu2())}var updateControlProjectNav=function(b,a){var d=b.getElementsByTagName("levelParent");var c="<table class='navTable'><tr>";if(d!=null&&d.length>=1){controlProjectTableparent=d[0].getAttribute("id");c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callControlProjectAjax("+controlProjectTableparent+")'><img src='images/project/report/up.png' border='0' alt='Up one level'></a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callControlProjectAjax("+controlProjectTableTop+")'><img src='images/project/report/top.png' border='0' alt='Top level'></a></td>"}else{c+="<td><img src='images/project/report/up1.png' alt='Up one level'></td>";c+="<td><img src='images/project/report/top1.png' alt='Top level'></td>";controlProjectTableparent=1}c+="<td>&nbsp;</td><td align='right'><input type='button' name='search' value='Search' onclick='populateSearchWin();'/></td>";c+="</tr></table>";document.getElementById(a).innerHTML=c};var populateTable=function(e,b){var d=e.getElementsByTagName("project");var a;var f;var g;for(var c=0;c<d.length;c++){f=document.getElementById(b);a=f.tBodies[0].rows.length;g=Array();g[0]="controlProject";g[1]=d[c].childNodes[0].firstChild.data;g[2]=d[c].childNodes[1].firstChild.data;g[3]=d[c].childNodes[2].firstChild.data;g[4]=d[c].childNodes[3].firstChild.data;g[5]=d[c].childNodes[4].firstChild.data;addRowToTable1(f,a,g);reorderRows(f,a)}d=e.getElementsByTagName("estimate");for(c=0;c<d.length;c++){f=document.getElementById(b);a=f.tBodies[0].rows.length;g=Array();g[0]="controlEstimate";g[1]=d[c].childNodes[0].firstChild.data;g[2]=d[c].childNodes[1].firstChild.data;g[3]=d[c].childNodes[2].firstChild.data;g[4]=d[c].childNodes[3].firstChild.data;g[5]=d[c].childNodes[4].firstChild.data;g[6]=d[c].childNodes[5].firstChild.data;g[7]=d[c].childNodes[6].firstChild.data;addRowToTable1(f,a,g);reorderRows(f,a)}};var myRowObject=function(b){this.content=Array();for(var a=0;a<b.length;a++){this.content[a]=b[a]}};var addRowToTable1=function(e,f,c){var k=e.tBodies[0].rows.length;var b=k+ROW_BASE;if(f==-1){f=k}else{b=f+ROW_BASE}var l=e.tBodies[0].insertRow(f);if(c[1]==sid){l.className="searchClass"}var j=Array();j[0]=l.insertCell(0);if(c[0]=="controlProject"){j[0].innerHTML="<a href='javascript:void(0);' onclick='callControlProjectAjax("+c[1]+");'><img src='images/project/project.png' border='0'></a>"}else{j[0].innerHTML="<img src='images/project/control.png' border='0' width='16' height='16'>"}j[1]=l.insertCell(1);var g=document.createTextNode(b);j[1].appendChild(g);j[2]=l.insertCell(2);var a;if(c[0]=="controlProject"){a=document.createTextNode(c[2])}else{a=document.createTextNode(c[4])}j[2].appendChild(a);j[3]=l.insertCell(3);var i;if(c[0]=="controlProject"){i=document.createTextNode(c[3])}else{i=document.createTextNode(c[5])}j[3].appendChild(i);var d=Array();d[0]=0;d[1]=0;d[2]=j[0].innerHTML;d[3]=g;d[4]=a;d[5]=i;d[6]=c[1];d[7]=c[0];if(c[0]=="controlProject"){d[8]=c[4];d[9]=c[5]}else{d[8]=c[6];d[9]=c[2];d[10]=c[7];d[11]=c[3]}var h=new myRowObject(d);l.myRow=h};var reorderRows=function(d,c){if(d.tBodies[0].rows[c]){var b=c+ROW_BASE;for(var a=c;a<d.tBodies[0].rows.length;a++){d.tBodies[0].rows[a].myRow.content[3].data=b;b++}}};var jobPickerWindowDiv="blankHidden1";var jobPickerWindowId="jobPickerWindowId";var jobPickerWindow=null;var rowToEdit=null;var jobIdentifierString;var getTimeFrame=function(b){jobIdentifierString=b;var a=contextMenu.srcElement;var c;while(true){c=a.parentNode;if(c.tagName!="TR"){a=c;continue}else{break}}if(c!=null&&c.myRow!=null){rowToEdit=c;populateDatePickerWin(c)}else{return}};var populateDatePickerWin=function(h){var f=new Date();var g=f.getMonth()+1;var a=f.getDate();var c=f.getFullYear();var e=(a+"/"+(g<10?"0"+g:""+g)+"/"+c);e="";var b="<table>";b+="<tr><td><label>From Date:</label></td><td><input size='40' type='text' id='editStartDate' value='"+e+"' onclick='pickDate(this,this);' readonly='readonly'> dd/mm/yyyy</td></tr>";b+="<tr><td><label>To Date:</label></td><td><input size='40' type='text' id='editFinishDate' value='"+e+"' onclick='pickDate(this,this);' readonly='readonly'> dd/mm/yyyy</td></tr>";b+="<tr><td colspan='2' align='center'><a href='javascript:void(0)' onclick='pickReport();'>Report</a>&nbsp;&nbsp;";b+="<a href='javascript:void(0)' onclick='resetDatePicker();'>Reset</a></td></tr>";b+="</table>";var d=document.getElementById(jobPickerWindowDiv);d.innerHTML=b;openScheduleEditWin()};var resetDatePicker=function(){document.getElementById("editStartDate").value="";document.getElementById("editFinishDate").value=""};var openScheduleEditWin=function(){var a=rowToEdit.myRow.content[4].data;jobPickerWindow=internalWindow.open(jobPickerWindowId,"div",jobPickerWindowDiv,"#Date Picker: ["+a+"]","width=450px,height=350px,left=200px,top=150px,resize=1,scrolling=1");jobPickerWindow.onclose=function(){if(calendarObjForForm.isVisible()){calendarObjForForm.hide()}return true}};var pickReport=function(){var a=jobIdentifierString;if(a=="workStatus"){openWorkStatusSummary()}else{if(a=="projectStatus"){openProjectStatusSummary()}}};var openWorkStatusSummary=function(){if(rowToEdit==null){return}if(rowToEdit.myRow==null){return}var b=rowToEdit.myRow.content[11];var c=rowToEdit.myRow.content[6];var a=""+document.getElementById("editStartDate").value;a=URLEncode(a==""?"-":a);var d=""+document.getElementById("editFinishDate").value;d=URLEncode(d==""?"-":d);window.open("MyActionDispatcher?path=103400&estimateId="+b+"&controlEstimateId="+c+"&sdate="+a+"&fdate="+d+"&method=openWorkStatusSummaryPDF");jobPickerWindow.close()};var openProjectStatusSummary=function(){if(rowToEdit==null){return}if(rowToEdit.myRow==null){return}var b=rowToEdit.myRow.content[6];var a=""+document.getElementById("editStartDate").value;a=URLEncode(a==""?"-":a);var c=""+document.getElementById("editFinishDate").value;c=URLEncode(c==""?"-":c);window.open("MyActionDispatcher?path=103500&projectId="+b+"&sdate="+a+"&fdate="+c+"&method=openProjectStatusSummaryPDF");jobPickerWindow.close()};var filesWindowId="FilesWIndowId";var openFilesWindow=function(){var b;var d=null;var c=contextMenu.srcElement;while(true){d=c.parentNode;if(d.tagName!="TR"){c=d;continue}else{break}}b=""+d.myRow.content[6];var a=d.myRow.content[4].data;internalWindow.open(filesWindowId,"iframe","MyActionDispatcher?path=103200&method=getProjectRefForUpdate&id="+b+"&uploadPath="+103200,"Files for Project: ["+a+"]","width=900px,height=400px,left=10px,top=10px,resize=1,scrolling=1")};var populateSearchWin=function(){var a="<table>";a+="<tr><td><label>Enter keyword:</label></td><td><input size='40' type='text' id='searchKey' value=''></td><td><input type='button' value='GO' onclick='vaildateKey();'></td></tr>";a+="</table>";a+="<div id='searchResult'>&nbsp;</div>";var b=document.getElementById("blankHidden1");b.innerHTML=a;openSearchWin()};var openSearchWin=function(){projectPropertiesWindow=internalWindow.open("searchWindow","div","blankHidden1","Search Project","width=600px,height=400px,left=200px,top=150px,resize=1,scrolling=1")};function vaildateKey(){key=document.getElementById("searchKey").value;if(key.length<3){alert("Enter Minimum 3 Character");return}else{callSearchProjectAjax()}}function callSearchProjectAjax(){var a=getHTMLHTTPRequest();var d=parseInt(Math.random()*99999999);var c=URLEncode(key);var b=myServerAddress+"MyXMLDispatcher?rand="+d+"&path="+103100+"&key="+c+"&method=searchControlProject";a.open("GET",b,true);a.onreadystatechange=function(){if(a.readyState==4){if(a.status==200){renderSearch(a)}else{alert("Connection Problem:"+a.statusText)}}};writeWaitMsg("searchResult","themes/icons/ajax_loading/22.gif","Processing request, please wait...");a.send(null)}function renderSearch(b){var c=b.responseXML;if(c==null){alert("Data Error");return}var e=c.getElementsByTagName("status");var a="";a+="<table id='searchTable' width='100%' class='reportTable'><thead><tr><td width='18px'>&nbsp;</td><td width='1%'>Sl</td><td width='20%'>Name</td><td>Description</td></tr></thead>";a+="<tbody id='searchbody'></tbody></table>";document.getElementById("searchResult").innerHTML=a;populateSearchTable(c,"searchTable");var d=document.getElementById("searchResult").innerHTML;document.getElementById("searchResult").innerHTML=doHighlight(d,key);addTableRolloverEffect("searchTable","tableRollOverEffect2","tableRowClickEffect2")}var populateSearchTable=function(e,b){var d=e.getElementsByTagName("project");var a;var f;var g;for(var c=0;c<d.length;c++){f=document.getElementById(b);a=f.tBodies[0].rows.length;g=Array();g[0]="controlProject";g[1]=d[c].childNodes[0].firstChild.data;g[2]=d[c].childNodes[1].firstChild.data;g[3]=d[c].childNodes[2].firstChild.data;g[4]=d[c].childNodes[3].firstChild.data;g[5]=d[c].childNodes[4].firstChild.data;addRowToSearchTable(f,a,g);reorderRows(f,a)}d=e.getElementsByTagName("estimate");for(c=0;c<d.length;c++){f=document.getElementById(b);a=f.tBodies[0].rows.length;g=Array();g[0]="controlEstimate";g[1]=d[c].childNodes[0].firstChild.data;g[2]=d[c].childNodes[1].firstChild.data;g[3]=d[c].childNodes[2].firstChild.data;g[4]=d[c].childNodes[3].firstChild.data;g[5]=d[c].childNodes[4].firstChild.data;addRowToSearchTable(f,a,g);reorderRows(f,a)}};var addRowToSearchTable=function(e,f,c){var k=e.tBodies[0].rows.length;var b=k+1;if(f==-1){f=k}else{b=f+1}var l=e.tBodies[0].insertRow(f);var j=Array();j[0]=l.insertCell(0);j[0].className="projIconImage";if(c[0]=="controlProject"){j[0].innerHTML="<a href='javascript:void(0);' onclick='sid="+c[1]+";callControlProjectAjax("+c[5]+");'><img src='images/project/project.png' border='0'></a>"}else{j[0].innerHTML="<a href='javascript:void(0);' onclick='sid="+c[1]+";callControlProjectAjax("+c[5]+");'><img src='images/project/control.png' border='0' width='16' height='16'></a>"}j[1]=l.insertCell(1);var g=document.createTextNode(b);j[1].appendChild(g);j[2]=l.insertCell(2);var a=document.createTextNode(c[2]);j[2].appendChild(a);j[3]=l.insertCell(3);var i=document.createTextNode(c[3]);j[3].appendChild(i);var d=Array();d[0]="";d[1]="";d[2]=j[0].innerHTML;d[3]=g;d[4]=a;d[5]=i;d[6]=c[1];d[7]=c[0];d[8]=c[4];d[9]=c[5];var h=new myRowObject(d);l.myRow=h};initializeControlProjectTable(10270);