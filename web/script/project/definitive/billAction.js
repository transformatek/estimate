var billTableparent=1;var billTableTop=1;var billTableCurrentParent=1;var billTablecontainer="blankContent";var costBookId=0;var INPUT_NAME_PREFIX="inputName";var RADIO_NAME="radName";var TABLE_NAME="billSample";var DIV_NAV_NAME="billNavDiv";var ROW_BASE=1;var hasLoaded=false;var ctx_THEAD="BILL_TTHEAD123";var ctx_TBODY="BILL_TTBODY123";var key1="qwerty";var searchFlag1=false;var currentEstimateId=0;var currentCostBookId=0;var contextMenu=null;contextMenu=new DHTMLSuite.contextMenu();contextMenu.setWidth(140);var callBack=function(){if(myContextMenuRequest.readyState==4){if(myContextMenuRequest.status==200){configureContextMenu();callBillAjax(currentEstimateId,currentCostBookId)}else{alert("Connection Problem:"+myContextMenuRequest.statusText)}}};var initializeBillTable=function(c,a,b){myCurrentMenuParent=c;writeWaitMsg(billTablecontainer,"themes/icons/ajax_loading/22.gif","Loading Menu...");currentEstimateId=a;currentCostBookId=b;callContextMenuAjax(c,callBack)};var menu2=function(){return configureContextMenuModel()};contextMenu.modifyMenu=function(){var a=this.srcElement;currentMenuBar=this.menuBar;var b;while(true){b=a.parentNode;if(b.tagName!="TR"){a=b;continue}else{break}}clickOnTableRowContext(b);var c=b.parentNode.parentNode;var d=c.parentNode;if(d.getAttribute("billRef")!=null&&d.getAttribute("billRef")!=""){hideMenuItem(211110);hideMenuItem(211130);hideMenuItem(211140);showMenuItem(211150);showMenuItem(211160);showMenuItem(211170);if(b.myRow==null){hideMenuItem(211160);hideMenuItem(211170)}else{if(b.myRow.content[17]!=0&&b.myRow.content[4].parentNode.childNodes[2]==null){showMenuItem(211160)}else{hideMenuItem(211160)}showMenuItem(211170)}}else{showMenuItem(211110);showMenuItem(211130);showMenuItem(211140);hideMenuItem(211150);hideMenuItem(211160);hideMenuItem(211170);if(b.myRow==null){hideMenuItem(211130);hideMenuItem(211140)}else{showMenuItem(211130);showMenuItem(211140)}}setMenuPermissions(currentMenuBar,null)};function callBillAjax(e,b){if(document.getElementById(billTablecontainer)==null){return}if(document.getElementById(billTablecontainer)==null){return}var c=getHTMLHTTPRequest();billTableCurrentParent=e;costBookId=b;var d=parseInt(Math.random()*99999999);var a=myServerAddress+"MyXMLDispatcher?rand="+d+"&path="+20420+"&estimateId="+e+"&method=get";c.open("GET",a,true);c.onreadystatechange=function(){if(c.readyState==4){if(c.status==200){renderBill(c)}else{alert("Connection Problem:"+c.statusText)}}};writeWaitMsg(billTablecontainer,"themes/icons/ajax_loading/22.gif","Loading page, please wait...");c.send(null)}function renderBill(b){var c=b.responseXML;if(c==null){alert("Data Error");return}var d=c.getElementsByTagName("status");var a=systemStatus(billTablecontainer,d);if(a==0){return}var e="";e+="<div id='"+DIV_NAV_NAME+"'></div>";e+="<table id='"+TABLE_NAME+"' width='100%' class='contentTable'><thead id='"+ctx_THEAD+"'><tr><td width='18px'>&nbsp;</td><td width='1%'>Sl</td><td width='15%'>Name</td><td width='50%'>Description</td><td>Price</td><td>Premium(%)</td><td width='16px'>&nbsp;</td><td width='16px'>&nbsp;</td><td>D</td><td>E</td></tr></thead>";e+="<tbody id='"+ctx_TBODY+"'></tbody></table>";document.getElementById(billTablecontainer).innerHTML=e;updateBillNav(c,DIV_NAV_NAME);initiateTableRollover(TABLE_NAME,"tableRollOverEffect1","tableRowClickEffect1");populateTable(c,TABLE_NAME);contextMenu.attachTo(ctx_THEAD,menu2());contextMenu.attachTo(ctx_TBODY,menu2())}var updateBillNav=function(b,a){var c="<table class='innerNavTable'><tr>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='initAssemblyWin(\""+TABLE_NAME+"\");'>Add Assembly</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='deleteChecked(\""+TABLE_NAME+"\");'>Delete[D]</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='initItemWin(false,\""+TABLE_NAME+"\");'>Add Job[E]</a></td>";c+="<td>Filter: <input name='filter' onKeyUp='filter(this, \""+TABLE_NAME+"\")' type='text'></td>";c+="</tr></table>";document.getElementById(a).innerHTML=c};var populateTable=function(f,b){var e=f.getElementsByTagName("bill");for(var c=0;c<e.length;c++){var g=document.getElementById(b);var a=g.tBodies[0].rows.length;var h=Array();h[0]=e[c].childNodes[0].firstChild.data;h[1]=e[c].childNodes[1].firstChild.data;h[2]=e[c].childNodes[2].firstChild.data;h[3]=e[c].childNodes[3].firstChild.data;h[4]=e[c].childNodes[4].firstChild.data;h[5]=e[c].childNodes[5].firstChild.data;h[6]=e[c].childNodes[6].firstChild.data;h[7]=e[c].childNodes[7].firstChild.data;var d=(e[c].childNodes[10].firstChild.data=="-"?e[c].childNodes[8].firstChild.data:e[c].childNodes[10].firstChild.data);h[8]=d;addRowToTable1(g,a,h);reorderRows(g,a)}};var myRowObject=function(b){this.content=Array();for(var a=0;a<b.length;a++){this.content[a]=b[a]}};var addRowToTable1=function(f,j,i){var n=f.tBodies[0].rows.length;var b=n+ROW_BASE;if(j==-1){j=n}else{b=j+ROW_BASE}var h=f.tBodies[0].insertRow(j);var d=Array();d[0]=h.insertCell(0);d[0].innerHTML="<img src='images/project/entry.png' border='0'>";d[1]=h.insertCell(1);var c=document.createTextNode(b);d[1].appendChild(c);d[2]=h.insertCell(2);var u=document.createTextNode(i[5]);d[2].appendChild(u);d[3]=h.insertCell(3);var q=document.createTextNode(i[6]);d[3].appendChild(q);d[4]=h.insertCell(4);var l=document.createTextNode(i[7]);var m=document.createTextNode("/");var o=document.createTextNode(i[8]);d[4].appendChild(o);d[4].appendChild(m);d[4].appendChild(l);d[5]=h.insertCell(5);var t=document.createElement("input");t.setAttribute("type","text");t.setAttribute("size","10");t.setAttribute("value",i[3]);d[5].appendChild(t);var e=document.createElement("span");e.appendChild(document.createTextNode(i[3]));e.style.display="none";d[5].appendChild(e);d[6]=h.insertCell(6);d[6].innerHTML="<a href='javascript:void(0);' onclick='callUpdatePremiumAjax(\""+h.sectionRowIndex+"\",\"update\")'><img src='images/common/tick.gif' border='0'></a>";d[7]=h.insertCell(7);d[7].innerHTML="<a href='javascript:void(0);' onclick='callUpdatePremiumAjax(\""+h.sectionRowIndex+"\",\"discard\")'><img src='images/common/cross.gif' border='0'></a>";d[8]=h.insertCell(8);var s=document.createElement("input");s.setAttribute("type","checkbox");d[8].appendChild(s);d[9]=h.insertCell(9);var k;try{k=document.createElement('<input type="radio" name="'+RADIO_NAME+'" value="'+b+'">');var p=k.name.length}catch(r){k=document.createElement("input");k.setAttribute("type","radio");k.setAttribute("name",RADIO_NAME);k.setAttribute("value",b)}d[9].appendChild(k);var g=Array();g[0]=s;g[1]=k;g[2]=d[0].innerHTML;g[3]=c;g[4]=u;g[5]=q;g[6]=i[0];g[7]=l;g[8]=o;g[9]=t;g[10]=i[4];g[11]=i[1];g[12]=e;var a=new myRowObject(g);h.myRow=a;addRowRolloverEffect(h)};function callDeleteBillAjax(g,h,d){if(!confirmDelete()){return}var k;var c=Array();var e;var l=getHTMLHTTPRequest();k=g;c=h;e=d;var j=parseInt(Math.random()*99999999);var b="";for(var f=0;f<h.length;f++){if(f==0){b+=h[f].myRow.content[6]}else{b+=","+h[f].myRow.content[6]}}var a=myServerAddress+"MyXMLDispatcher?rand="+j+"&path="+20430+"&id="+URLEncode(b)+"&method=delete";l.open("GET",a,true);l.onreadystatechange=function(){if(l.readyState==4){if(l.status==200){var m=l.responseXML;var i=0;if(m==null){alert("Data Error")}else{var n=m.getElementsByTagName("status");i=systemStatus(null,n)}if(i==1){deleteRows(c);reorderRows(k,e)}else{if(i==2){alert("DELETE: System Error")}}}else{alert("Connection Problem:"+l.statusText)}closeSplashScreen()}};openSplashScreen();l.send(null)}var deleteChecked=function(d){var f=document.getElementById(d);var a=new Array();var b=0;for(var c=0;c<f.tBodies[0].rows.length;c++){if(f.tBodies[0].rows[c].myRow.content[0].checked){a[b]=f.tBodies[0].rows[c];b++}}if(a.length>0){var e=a[0].sectionRowIndex;callDeleteBillAjax(f,a,e)}};var deleteRows=function(c){for(var a=0;a<c.length;a++){var b=c[a].sectionRowIndex;c[a].parentNode.deleteRow(b)}};var reorderRows=function(d,c){if(d.tBodies[0].rows[c]){var b=c+ROW_BASE;for(var a=c;a<d.tBodies[0].rows.length;a++){d.tBodies[0].rows[a].myRow.content[3].data=b;b++}}};var deleteContextChecked=function(){var a=new Array();var b=contextMenu.srcElement;while(true){a[0]=b.parentNode;if(a[0].tagName!="TR"){b=a[0];continue}else{break}}var d=a[0].parentNode.parentNode;var c=a[0].sectionRowIndex;callDeleteBillAjax(d,a,c)};var myUpdatePremiumRequest=getHTMLHTTPRequest();var premRowtoEdit;var callUpdatePremiumAjax=function(f,b){var e=document.getElementById(TABLE_NAME);premRowtoEdit=e.tBodies[0].rows[f];if(b=="discard"){premRowtoEdit.myRow.content[9].value=premRowtoEdit.myRow.content[12].firstChild.data;return}var d=parseInt(Math.random()*99999999);var c="";var g=premRowtoEdit.myRow.content[6];var a=premRowtoEdit.myRow.content[9].value;c=myServerAddress+"MyXMLDispatcher?rand="+d+"&path="+20440+"&id="+g+"&premium="+a+"&method=updateBillPremium&flag="+b;myUpdatePremiumRequest.open("GET",c,true);myUpdatePremiumRequest.onreadystatechange=updatePremiumAction;openSplashScreen();myUpdatePremiumRequest.send(null)};var updatePremiumAction=function(){if(myUpdatePremiumRequest.readyState==4){if(myUpdatePremiumRequest.status==200){var c=myUpdatePremiumRequest.responseXML;var a=0;if(c==null){alert("Data Error")}else{var d=c.getElementsByTagName("status");a=systemStatus(null,d)}if(a==1){var b=c.getElementsByTagName("refreshValue");if(b!=null&&b.length>0){premRowtoEdit.myRow.content[9].value=b[0].getAttribute("premium");premRowtoEdit.myRow.content[12].firstChild.data=premRowtoEdit.myRow.content[9].value}}else{if(a==2){alert("UPDATE: System Error")}}}else{alert("Connection Problem:"+myUpdatePremiumRequest.statusText)}closeSplashScreen()}};var assemblyManagerContainer="blankHidden1";var ASMOptionsContainer="asmOptions";var ASMInnnerContainer="innerASMContainer";var asmOptionsWindow;var asmOptionsWindowId="asmOptionsWindowId";var ASM_INNER_TABLE_NAME="asmInnerSample";var ASM_INNER_DIV_NAV_NAME="asmInnerNavDiv";var billTable;var initAssemblyWin=function(a){billTable=a;var b=document.getElementById(assemblyManagerContainer);b.innerHTML="<div id='"+ASMInnnerContainer+"' class='smallText'>Please click on one of the options above</div>";openAssemblyOptionsWindow()};var openAssemblyOptionsWindow=function(){asmOptionsWindow=internalWindow.open(asmOptionsWindowId,"div",assemblyManagerContainer,"Add Assembly","width=600px,height=400px,left=5px,top=5px,resize=1,scrolling=1");openAssemblyTable()};var assemblyTableparent=1;var assemblyTableTop=1;var assemblyTableCurrentParent=1;var assemblyTablecontainer=ASMInnnerContainer;var openAssemblyTable=function(){callAssemblyAjax(1)};function callAssemblyAjax(d){if(document.getElementById(assemblyTablecontainer)==null){return}var b=getHTMLHTTPRequest();assemblyTableCurrentParent=d;var c=parseInt(Math.random()*99999999);var a=myServerAddress+"MyXMLDispatcher?rand="+c+"&path="+20450+"&parent="+d+"&cbId="+costBookId+"&method=getAssembly";b.open("GET",a,true);b.onreadystatechange=function(){if(b.readyState==4){if(b.status==200){renderAssembly(b)}else{alert("Connection Problem:"+b.statusText)}}};writeWaitMsg(assemblyTablecontainer,"themes/icons/ajax_loading/24.gif","Loading page, please wait...");b.send(null)}function renderAssembly(b){var c=b.responseXML;if(c==null){alert("Data Error");return}var d=c.getElementsByTagName("status");var a=systemStatus(assemblyTablecontainer,d);if(a==0){return}var e="";e+="<div id='"+ASM_INNER_DIV_NAV_NAME+"'></div>";e+="<table id='"+ASM_INNER_TABLE_NAME+"' width='97%' class='innerContentTable'><thead id='ASMTThead'><tr><td width='18px'>&nbsp;</td><td width='1%'>Sl</td><td width='15%'>Name</td><td width='45%'>Description</td><td>Price</td><td>Premium</td><td width='16px'>&nbsp;</td></tr></thead>";e+="<tbody id='ASMTTbody'></tbody></table>";document.getElementById(assemblyTablecontainer).innerHTML=e;updateAssemblyNav(c,ASM_INNER_DIV_NAV_NAME);populateAssemblyTable(c,ASM_INNER_TABLE_NAME);addTableRolloverEffect(ASM_INNER_TABLE_NAME,"tableRollOverEffect2","tableRowClickEffect2")}var updateAssemblyNav=function(b,a){var d=b.getElementsByTagName("levelParent");var c="<table class='innerNavTable'><tr>";if(d!=null&&d.length>=1){assemblyTableparent=d[0].getAttribute("id");c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callAssemblyAjax("+assemblyTableparent+")'><img src='images/assembly/up.png' border='0' alt='Up one level'></a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callAssemblyAjax("+assemblyTableTop+")'><img src='images/assembly/top.png' border='0' alt='Top level'></a></td>"}else{if(searchFlag1==false){c+="<td><img src='images/assembly/up1.png' alt='Up one level'></td>";c+="<td><img src='images/assembly/top1.png' alt='Top level'></td>";assemblyTableparent=1}else{c+="<td><img src='images/assembly/up1.png' alt='Up one level'></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callAssemblyAjax("+assemblyTableTop+")'><img src='images/assembly/top.png' border='0' alt='Top level'></a></td>";searchFlag1=false;assemblyTableparent=1}}c+="<td><label>Enter keyword:</label></td><td><input size='40' type='text' id='searchKeyForAssembly' value=''></td><td><input type='button' value='GO' onclick='vaildateKey2();'></td>";c+="</tr></table>";document.getElementById(a).innerHTML=c};var populateAssemblyTable=function(f,b){var e=f.getElementsByTagName("item");for(var d=0;d<e.length;d++){var g=document.getElementById(b);var a=g.tBodies[0].rows.length;var h=Array();h[0]=e[d].childNodes[0].firstChild.data;h[1]=e[d].childNodes[1].firstChild.data;h[2]=e[d].childNodes[2].firstChild.data;h[3]=e[d].childNodes[3].firstChild.data;var c=(h[3]=="--");h[4]=(e[d].childNodes[8].firstChild.data=="-"?e[d].childNodes[4].firstChild.data:e[d].childNodes[8].firstChild.data);h[5]=(e[d].childNodes[9].firstChild.data=="-"?e[d].childNodes[5].firstChild.data:e[d].childNodes[9].firstChild.data);h[6]=e[d].getAttribute("remarks");h[7]=e[d].getAttribute("parent");h[8]=c;addRowToTable2(g,a,h);reorderRows(g,a)}};var addRowToTable2=function(e,f,c){var o=e.tBodies[0].rows.length;var b=o+ROW_BASE;if(f==-1){f=o}else{b=f+ROW_BASE}var q=e.tBodies[0].insertRow(f);var j=c[8];var n=Array();n[0]=q.insertCell(0);if(j){n[0].innerHTML="<a href='javascript:void(0);' onclick='callAssemblyAjax("+c[0]+")'><img src='images/assembly/folder.gif' border='0' width='16' height='16'></a>"}else{n[0].innerHTML="<img src='images/assembly/item.png' border='0' width='16' height='16'>"}n[1]=q.insertCell(1);var h=document.createTextNode(b);n[1].appendChild(h);n[2]=q.insertCell(2);var a=document.createTextNode(c[1]);n[2].appendChild(a);n[3]=q.insertCell(3);var m=document.createTextNode(c[2]);n[3].appendChild(m);n[4]=q.insertCell(4);var l;var p;var g;if(j){l=document.createTextNode("");p=document.createTextNode("");g=document.createTextNode("-")}else{l=document.createTextNode(c[3]);p=document.createTextNode("/");g=document.createTextNode(c[4])}n[4].appendChild(g);n[4].appendChild(p);n[4].appendChild(l);n[5]=q.insertCell(5);var k;if(j){k=document.createTextNode("-")}else{k=document.createTextNode(c[5])}n[5].appendChild(k);n[6]=q.insertCell(6);if(!j){n[6].innerHTML="<a href='javascript:void(0);' onclick='callAddAssemblyAjax(\""+e.getAttribute("id")+'",'+q.sectionRowIndex+")'><img src='images/common/tick.gif' border='0'></a>"}else{n[6].innerHTML="&nbsp;&nbsp;&nbsp;"}var d=Array();d[0]=0;d[1]=0;d[2]=n[0].innerHTML;d[3]=h;d[4]=a;d[5]=m;d[6]=c[0];d[7]=l;d[8]=g;d[9]=k;d[10]=c[6];d[11]=c[7];var i=new myRowObject(d);q.myRow=i};var myAssemblyAddRequest=getHTMLHTTPRequest();var myAssemblyTable;var myAssemblyRow;var callAddAssemblyAjax=function(c,g){var b=document.getElementById(c);var f=b.tBodies[0].rows[g];var h=f.myRow.content[6];var a=f.myRow.content[9].data;myAssemblyRow=f;var e=parseInt(Math.random()*99999999);var d=myServerAddress+"MyXMLDispatcher?rand="+e+"&path="+20460+"&id="+h+"&estimateId="+billTableCurrentParent+"&premium="+a+"&method=addAssemblyToBill";myAssemblyAddRequest.open("GET",d,true);myAssemblyAddRequest.onreadystatechange=addAssemblyToBillAction;openSplashScreen();myAssemblyAddRequest.send(null)};var addAssemblyToBillAction=function(){if(myAssemblyAddRequest.readyState==4){if(myAssemblyAddRequest.status==200){var c=myAssemblyAddRequest.responseXML;var a=0;if(c==null){alert("Data Error")}else{var d=c.getElementsByTagName("status");a=systemStatus(null,d)}if(a==1){var b=c.getElementsByTagName("key")[0].getAttribute("value");var e=Array();e[0]=""+b;e[1]=billTableCurrentParent;e[2]=myAssemblyRow.myRow.content[6];e[3]=myAssemblyRow.myRow.content[9].data;e[4]="remarks";e[5]=myAssemblyRow.myRow.content[4].data;e[6]=myAssemblyRow.myRow.content[5].data;e[7]=myAssemblyRow.myRow.content[7].data;e[8]=myAssemblyRow.myRow.content[8].data;addRowToTable1(document.getElementById(TABLE_NAME),-1,e)}else{if(a==2){alert("ADD: System Error")}}}else{alert("Connection Problem:"+myAssemblyAddRequest.statusText)}closeSplashScreen()}};var myBillRow;var initItemWin=function(e,a){myBillRow=null;if(e==true){var b=contextMenu.srcElement;var d;while(true){d=b.parentNode;if(d.tagName!="TR"){b=d;continue}else{break}}myBillRow=d}else{var f=document.getElementById(a);for(var c=0;c<f.tBodies[0].rows.length;c++){if(f.tBodies[0].rows[c].myRow&&f.tBodies[0].rows[c].myRow.content[1].getAttribute("type")=="radio"&&f.tBodies[0].rows[c].myRow.content[1].checked){myBillRow=f.tBodies[0].rows[c]}}}if(myBillRow!=null){openAddJobsWin()}};var jobsContainerDiv="blankHidden1";var jobsInnerDivPrefix="jobsInnerDivPrefix";var jobsWindowIdPrefix="jobsWindowIdPrefix";var INNER_TABLE_NAME_PREFIX="innerTableNamePrefix";var INNER_NAV_DIV_PREFIX="innerNavDivPrefix";var openAddJobsWin=function(){var c=myBillRow.myRow.content[6];var a=myBillRow.myRow.content[3].data;var b="<div id='"+INNER_NAV_DIV_PREFIX+c+"'>Loading content, please wait...</div><div id='"+jobsInnerDivPrefix+c+"' class='smallText'></div>";document.getElementById(jobsContainerDiv).innerHTML=b;internalWindow.open(jobsWindowIdPrefix+c,"div",jobsContainerDiv,"Jobs for #"+a,"width=850px,height=500px,left=5px,top=5px,resize=1,scrolling=1");callShowJobsAjax(c)};var callShowJobsAjax=function(d){if(document.getElementById(INNER_NAV_DIV_PREFIX+d)==null){return}if(document.getElementById(jobsInnerDivPrefix+d)==null){return}var b=getHTMLHTTPRequest();var c=parseInt(Math.random()*99999999);var a=myServerAddress+"MyXMLDispatcher?rand="+c+"&path="+20470+"&billId="+d+"&method=getJobsList";b.open("GET",a,true);b.onreadystatechange=function(){if(b.readyState==4){if(b.status==200){renderJobs(b)}else{alert("Connection Problem:"+b.statusText)}}};b.send(null)};var renderJobs=function(c){var d=c.responseXML;if(d==null){alert("Data Error");return}var e=d.getElementsByTagName("status");var h=d.getElementsByTagName("bill");var g=0;if(h!=null&&h.length>0){g=h[0].getAttribute("id");var a=document.getElementById(jobsInnerDivPrefix+g);a.setAttribute("billRef",g);var f="<table width='97%' class='innerContentTable' id='"+INNER_TABLE_NAME_PREFIX+g+"'><thead id='JOBTHEAD"+g+"'><tr><td width='16px'>&nbsp;</td><td width='16px'>Sl</td><td width='20%'>Description</td><td>Numbers</td><td>Length</td><td>Breadth</td><td>Height</td><td>Weight</td><td align='right'>Total</td><td>D</td></tr></thead><tbody id='JOBTBODY"+g+"'></tbody></table>";a.innerHTML=f;contextMenu.attachTo("JOBTHEAD"+g,menu2());contextMenu.attachTo("JOBTBODY"+g,menu2());updateJobsNav(d,INNER_NAV_DIV_PREFIX,INNER_TABLE_NAME_PREFIX,g);populateJobsTable(d,INNER_TABLE_NAME_PREFIX,g);addTableRolloverEffect(INNER_TABLE_NAME_PREFIX+g,"tableRollOverEffect1","tableRowClickEffect1")}else{var b=systemStatus(null,e);if(b==0){return}}};var updateJobsNav=function(b,e,a,d){var c="<table class='innerNavTable'><tr>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='addNewJobBox(\""+a+'",'+d+");'>Add New</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='editCheckedJobsBox(\""+a+'",'+d+");'>Edit[D]</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='deleteJobsChecked(\""+a+d+"\");'>Delete[D]</a></td>";c+="</tr></table>";document.getElementById(e+d).innerHTML=c};var populateJobsTable=function(j,f,d){var g=f+d;var e=j.getElementsByTagName("entry");for(var c=0;c<e.length;c++){var b=document.getElementById(g);var h=b.tBodies[0].rows.length;var a=Array();a[0]=e[c].childNodes[0].firstChild.data;a[1]=e[c].childNodes[2].firstChild.data;a[2]=e[c].childNodes[3].firstChild.data;a[3]=e[c].childNodes[4].firstChild.data;a[4]=e[c].childNodes[5].firstChild.data;a[5]=e[c].childNodes[6].firstChild.data;a[6]=e[c].childNodes[7].firstChild.data;a[7]=e[c].childNodes[8].firstChild.data;a[8]=e[c].childNodes[1].firstChild.data;addRowToTable3(b,h,a)}};var addRowToTable3=function(f,l,j){var r=f.tBodies[0].rows.length;var b=r+ROW_BASE;if(l==-1){l=r}else{b=l+ROW_BASE}var i=f.tBodies[0].insertRow(l);var d=Array();d[0]=i.insertCell(0);d[0].innerHTML="<img src='images/project/job.gif' border='0'>";d[1]=i.insertCell(1);var c=document.createTextNode(b);d[1].appendChild(c);d[2]=i.insertCell(2);var q=getTextBox(20,j[1]);q.style.display="none";var t=document.createTextNode(j[1]);d[2].appendChild(q);d[2].appendChild(t);d[3]=i.insertCell(3);var s=getTextBox(10,j[2]);s.style.display="none";var k=document.createTextNode(j[2]);d[3].appendChild(s);d[3].appendChild(k);d[4]=i.insertCell(4);var h=getTextBox(10,j[3]);h.style.display="none";var e=document.createTextNode(j[3]);d[4].appendChild(h);d[4].appendChild(e);d[5]=i.insertCell(5);var m=getTextBox(10,j[4]);m.style.display="none";var o=document.createTextNode(j[4]);d[5].appendChild(m);d[5].appendChild(o);d[6]=i.insertCell(6);var x=getTextBox(10,j[5]);x.style.display="none";var p=document.createTextNode(j[5]);d[6].appendChild(x);d[6].appendChild(p);d[7]=i.insertCell(7);var w=getTextBox(10,j[6]);w.style.display="none";var n=document.createTextNode(j[6]);d[7].appendChild(w);d[7].appendChild(n);d[8]=i.insertCell(8);d[8].setAttribute("align","right");var v=document.createTextNode(j[7]);d[8].appendChild(v);d[9]=i.insertCell(9);var u=document.createElement("input");u.setAttribute("type","checkbox");d[9].appendChild(u);var g=Array();g[0]=u;g[1]=0;g[2]=d[0].innerHTML;g[3]=c;g[4]=t;g[5]=q;g[6]=k;g[7]=s;g[8]=e;g[9]=h;g[10]=o;g[11]=m;g[12]=p;g[13]=x;g[14]=n;g[15]=w;g[16]=v;g[17]=j[0];g[18]=j[8];var a=new myRowObject(g);i.myRow=a};var getTextBox=function(b,c){var a=document.createElement("input");a.setAttribute("type","text");a.setAttribute("size",b);a.setAttribute("value",c);return a};function callDeleteJobsAjax(e,f,c){if(!confirmDelete()){return}var d=getHTMLHTTPRequest();var g=parseInt(Math.random()*99999999);var j;var b="";for(var h=0;h<f.length;h++){if(h==0){b+=f[h].myRow.content[17];j=f[h].myRow.content[18]}else{b+=","+f[h].myRow.content[17]}}var a=myServerAddress+"MyXMLDispatcher?rand="+g+"&path="+20480+"&id="+URLEncode(b)+"&billId="+j+"&method=deleteSelectedJobs";d.open("GET",a,true);d.onreadystatechange=function(){if(d.readyState==4){if(d.status==200){var k=d.responseXML;var i=0;if(k==null){alert("Data Error")}else{var l=k.getElementsByTagName("status");i=systemStatus(null,l)}if(i==1){deleteRows(f);reorderRows(e,c)}else{if(i==2){alert("DELETE: System Error")}}}else{alert("Connection Problem:"+d.statusText)}closeSplashScreen()}};openSplashScreen();d.send(null)}var getJobsChecked=function(d){var e=document.getElementById(d);var a=new Array();var b=0;for(var c=0;c<e.tBodies[0].rows.length;c++){if(e.tBodies[0].rows[c].myRow.content[0].checked){a[b]=e.tBodies[0].rows[c];b++}}return a};var deleteJobsChecked=function(d){var f=document.getElementById(d);var a=new Array();var b=0;for(var c=0;c<f.tBodies[0].rows.length;c++){if(f.tBodies[0].rows[c].myRow.content[0].checked){a[b]=f.tBodies[0].rows[c];b++}}if(a.length>0){var e=a[0].sectionRowIndex;callDeleteJobsAjax(f,a,e)}};var deleteJobsRows=function(c){for(var a=0;a<c.length;a++){var b=c[a].sectionRowIndex;c[a].parentNode.deleteRow(b)}};var reorderJobsRows=function(d,c){if(d.tBodies[0].rows[c]){var b=c+ROW_BASE;for(var a=c;a<d.tBodies[0].rows.length;a++){d.tBodies[0].rows[a].myRow.content[3].data=b;b++}}};var deleteContextJobsChecked=function(){var a=new Array();var b=contextMenu.srcElement;while(true){a[0]=b.parentNode;if(a[0].tagName!="TR"){b=a[0];continue}else{break}}var d=a[0].parentNode.parentNode;var c=a[0].sectionRowIndex;callDeleteJobsAjax(d,a,c)};var addContextJobsBox=function(){var a=contextMenu.srcElement;var c;while(true){c=a.parentNode;if(c.tagName!="TR"){a=c;continue}else{break}}var b=c.parentNode.parentNode;var e=b.parentNode;var d=e.getAttribute("billRef");addNewJobBox(INNER_TABLE_NAME_PREFIX,d)};var addNewJobBox=function(n,i){var f=document.getElementById(n+i);var s=f.tBodies[0].rows.length;var l=s;var b=l+ROW_BASE;var j=f.tBodies[0].insertRow(l);var d=Array();d[0]=j.insertCell(0);d[0].innerHTML="<a href='javascript:void(0);' onclick='addNewJob(event,"+i+",\"add\");'><img src='images/common/tick.gif' border='0'></a>";d[1]=j.insertCell(1);var c=document.createTextNode(b);d[1].innerHTML="<a href='javascript:void(0);' onclick='addNewJob(event,"+i+",\"discard\");'><img src='images/common/cross.gif' border='0'></a>";d[2]=j.insertCell(2);var r=getTextBox(20,"-");var u=document.createTextNode("");d[2].appendChild(r);d[2].appendChild(u);d[3]=j.insertCell(3);var t=getTextBox(10,"-");var k=document.createTextNode("");d[3].appendChild(t);d[3].appendChild(k);d[4]=j.insertCell(4);var h=getTextBox(10,"-");var e=document.createTextNode("");d[4].appendChild(h);d[4].appendChild(e);d[5]=j.insertCell(5);var m=getTextBox(10,"-");var p=document.createTextNode("");d[5].appendChild(m);d[5].appendChild(p);d[6]=j.insertCell(6);var y=getTextBox(10,"-");var q=document.createTextNode("");d[6].appendChild(y);d[6].appendChild(q);d[7]=j.insertCell(7);var x=getTextBox(10,"-");var o=document.createTextNode("");d[7].appendChild(x);d[7].appendChild(o);d[8]=j.insertCell(8);d[8].setAttribute("align","right");var w=document.createTextNode("-");d[8].appendChild(w);d[9]=j.insertCell(9);var v=document.createElement("input");v.setAttribute("type","checkbox");v.disabled=true;d[9].appendChild(v);var g=Array();g[0]=v;g[1]=0;g[2]=d[0].innerHTML;g[3]=c;g[4]=u;g[5]=r;g[6]=k;g[7]=t;g[8]=e;g[9]=h;g[10]=p;g[11]=m;g[12]=q;g[13]=y;g[14]=o;g[15]=x;g[16]=w;g[17]=0;g[18]=i;var a=new myRowObject(g);j.myRow=a;addRowRolloverEffect(j)};var addNewJob=function(m,k,n){var d=m;var r;var i;if(d.target){r=d.target.parentNode.parentNode.parentNode}else{if(d.srcElement){r=d.srcElement.parentNode.parentNode.parentNode}}var o=r.sectionRowIndex;i=r.parentNode.parentNode;if(n=="discard"){discardRowsArray=Array();discardRowsArray[0]=i.tBodies[0].rows[o];deleteJobsRows(discardRowsArray);reorderJobsRows(i,o)}else{if(n=="add"){var f=getHTMLHTTPRequest();var h=parseInt(Math.random()*99999999);var p=URLEncode(r.myRow.content[5].value);var g=URLEncode(r.myRow.content[7].value);var c=URLEncode(r.myRow.content[9].value);var a=URLEncode(r.myRow.content[11].value);var q=URLEncode(r.myRow.content[13].value);var j=URLEncode(r.myRow.content[15].value);var l="billId="+k;l+="&description="+p;l+="&number="+g;l+="&length="+c;l+="&breadth="+a;l+="&height="+q;l+="&weight="+j;var b=myServerAddress+"MyXMLDispatcher?rand="+h+"&path="+20490+"&method=addNewJob";f.open("POST",b,true);f.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8");f.setRequestHeader("Content-length",f.length);f.onreadystatechange=function(){if(f.readyState==4){if(f.status==200){var v=f.responseXML;var e=0;if(v==null){alert("Data Error")}else{var w=v.getElementsByTagName("status");e=systemStatus(null,w)}if(e==1){var s=v.getElementsByTagName("key")[0].getAttribute("value");var u=v.getElementsByTagName("key")[0].getAttribute("total");r.myRow.content[4].data=r.myRow.content[5].value;r.myRow.content[6].data=r.myRow.content[7].value;r.myRow.content[8].data=r.myRow.content[9].value;r.myRow.content[10].data=r.myRow.content[11].value;r.myRow.content[12].data=r.myRow.content[13].value;r.myRow.content[14].data=r.myRow.content[15].value;r.myRow.content[16].data=""+u;r.myRow.content[17]=""+s;r.myRow.content[18]=""+k;for(var t=5;t<=15;t+=2){r.myRow.content[t].style.display="none"}r.cells[0].innerHTML="";r.cells[0].innerHTML="<img src='images/common/url.gif' border='0'>";r.myRow.content[2]=r.cells[0].innerHTML;r.cells[1].innerHTML="";r.cells[1].appendChild(r.myRow.content[3]);r.myRow.content[0].disabled=false}else{if(e==2){alert("ADD: System Error")}}}else{alert("Connection Problem:"+f.statusText)}closeSplashScreen()}};openSplashScreen();f.send(l)}}};var editContextJobsBox=function(){var a=contextMenu.srcElement;var c;while(true){c=a.parentNode;if(c.tagName!="TR"){a=c;continue}else{break}}var b=c.parentNode.parentNode;var e=b.parentNode;var d=e.getAttribute("billRef");c.myRow.content[0].checked=true;editCheckedJobsBox(INNER_TABLE_NAME_PREFIX,d)};var editCheckedJobsBox=function(c,g){var e=document.getElementById(c+g);for(var f=0;f<e.tBodies[0].rows.length;f++){if(e.tBodies[0].rows[f].myRow.content[0].checked){var m=e.tBodies[0].rows[f];m.myRow.content[3]=document.createTextNode(m.myRow.content[3].data);m.cells[0].innerHTML="";m.cells[1].innerHTML="";m.cells[0].innerHTML="<a href='javascript:void(0);' onclick='editSelectedJob(event,"+g+",\"edit\");'><img src='images/common/tick.gif' border='0'></a>";m.cells[1].innerHTML="<a href='javascript:void(0);' onclick='editSelectedJob(event,"+g+",\"discard\");'><img src='images/common/cross.gif' border='0'></a>";var h=Array();for(var d=4;d<=14;d+=2){var l=m.myRow.content[d];var a=document.createElement("span");a.appendChild(document.createTextNode(l.data));a.style.display="none";l.parentNode.appendChild(a);l.data=""}for(var b=5;b<=15;b+=2){m.myRow.content[b].style.display="inline"}m.myRow.content[0].checked=false;m.myRow.content[0].disabled=true}}};var editSelectedJob=function(t,h,s){var v=t;var i;var f;if(v.target){i=v.target.parentNode.parentNode.parentNode}else{if(v.srcElement){i=v.srcElement.parentNode.parentNode.parentNode}}var j=i.sectionRowIndex;f=i.parentNode.parentNode;if(s=="discard"){var o;var l;var x;var r;for(var k=4;k<=14;k+=2){o=i.myRow.content[k];l=i.myRow.content[k+1];r=o.parentNode.childNodes[2];x=r.firstChild.data;o.data=x;l.value=x;l.style.display="none";r.parentNode.removeChild(r)}i.myRow.content[0].disabled=false;i.cells[0].innerHTML="";i.cells[0].innerHTML="<img src='images/common/url.gif' border='0'>";i.myRow.content[2]=i.cells[0].innerHTML;i.cells[1].innerHTML="";i.cells[1].appendChild(i.myRow.content[3])}else{if(s=="edit"){var u=getHTMLHTTPRequest();var a=parseInt(Math.random()*99999999);var q=URLEncode(i.myRow.content[5].value);var b=URLEncode(i.myRow.content[7].value);var c=URLEncode(i.myRow.content[9].value);var n=URLEncode(i.myRow.content[11].value);var p=URLEncode(i.myRow.content[13].value);var m=URLEncode(i.myRow.content[15].value);var g="id="+i.myRow.content[17];g+="&description="+q;g+="&number="+b;g+="&length="+c;g+="&breadth="+n;g+="&height="+p;g+="&weight="+m;var d=myServerAddress+"MyXMLDispatcher?rand="+a+"&path="+20500+"&method=EditSelectedJob";u.open("POST",d,true);u.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8");u.setRequestHeader("Content-length",u.length);u.onreadystatechange=function(){if(u.readyState==4){if(u.status==200){var y=u.responseXML;var e=0;if(y==null){alert("Data Error")}else{var z=y.getElementsByTagName("status");e=systemStatus(null,z)}if(e==1){var w=y.getElementsByTagName("total")[0].getAttribute("value");i.myRow.content[16].data=""+w;for(k=4;k<=14;k+=2){o=i.myRow.content[k];l=i.myRow.content[k+1];l.style.display="none";if(l.value==""){o.data="-";l.value="-"}else{o.data=l.value}r=o.parentNode.childNodes[2];r.parentNode.removeChild(r)}i.myRow.content[0].disabled=false;i.cells[0].innerHTML="";i.cells[0].innerHTML="<img src='images/common/url.gif' border='0'>";i.myRow.content[2]=i.cells[0].innerHTML;i.cells[1].innerHTML="";i.cells[1].appendChild(i.myRow.content[3])}else{if(e==2){alert("EDIT: System Error")}}}else{alert("Connection Problem:"+u.statusText)}closeSplashScreen()}};openSplashScreen();u.send(g)}}};function vaildateKey2(){key1=document.getElementById("searchKeyForAssembly").value;if(key1.length<3){alert("Enter Minimum 3 Character");return}else{callSearchAssemblyAjax()}}function callSearchAssemblyAjax(e){if(document.getElementById(assemblyTablecontainer)==null){return}var c=getHTMLHTTPRequest();assemblyTableCurrentParent=e;var d=parseInt(Math.random()*99999999);var b=URLEncode(key1);var a=myServerAddress+"MyXMLDispatcher?rand="+d+"&path="+20450+"&key="+b+"&cbId="+costBookId+"&method=getAssemblyCost";c.open("GET",a,true);c.onreadystatechange=function(){if(c.readyState==4){if(c.status==200){searchFlag1=true;renderAssembly(c)}else{alert("Connection Problem:"+c.statusText)}}};writeWaitMsg(assemblyTablecontainer,"themes/icons/ajax_loading/22.gif","Loading page, please wait...");c.send(null)};