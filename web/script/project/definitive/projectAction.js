var projectTableparent=1;var projectTableTop=1;var projectTableCurrentParent=1;var projectTablecontainer="blankContent";var projectPropertiesWindow=null;var INPUT_NAME_PREFIX="inputName";var RADIO_NAME="radName";var TABLE_NAME="projectSample";var DIV_NAV_NAME="projectNavDiv";var ROW_BASE=1;var hasLoaded=false;var ctx_THEAD="PROJ_TTHEAD123";var ctx_TBODY="PROJ_TTBODY123";var key="qwerty";var sid=0;var key1="qwerty";var searchFlag1=false;var callBack=function(){if(myContextMenuRequest.readyState==4){if(myContextMenuRequest.status==200){configureContextMenu();callProjectAjax(1)}else{alert("Connection Problem:"+myContextMenuRequest.statusText)}}};var initializeProjectTable=function(a){myCurrentMenuParent=a;writeWaitMsg(projectTablecontainer,"themes/icons/ajax_loading/22.gif","Loading Menu...");callContextMenuAjax(a,callBack)};var menu2=function(){return configureContextMenuModel()};contextMenu.modifyMenu=function(){var a=this.srcElement;currentMenuBar=this.menuBar;var b;while(true){b=a.parentNode;if(b.tagName!="TR"){a=b;continue}else{break}}clickOnTableRowContext(b);if(b.myRow==null){setMenuItemState(210880,"disabled");setMenuItemState(210890,"disabled");setMenuItemState(210910,"disabled");setMenuItemState(210920,"disabled");setMenuItemState(210950,"disabled");setMenuItemState(210960,"disabled");setMenuItemState(210970,"disabled");setMenuItemState(211000,"disabled")}else{if(b.myRow.content[7]=="project"){setMenuItemState(210920,"disabled");setMenuItemState(210950,"disabled");setMenuItemState(210960,"disabled");setMenuItemState(210970,"disabled");setMenuItemState(211000,"regular");setMenuItemState(210980,"disabled")}else{setMenuItemState(210920,"regular");setMenuItemState(210950,"regular");setMenuItemState(210960,"regular");setMenuItemState(210970,"regular");setMenuItemState(211000,"disabled");setMenuItemState(210980,"regular")}setMenuItemState(210880,"regular");setMenuItemState(210890,"regular");setMenuItemState(210910,"regular")}if(myMoveAction.movableItemType==null){setMenuItemState(210930,"disabled")}else{setMenuItemState(210930,"regular")}if(projectTableCurrentParent==1){setMenuItemState(210810,"disabled");setMenuItemState(210820,"disabled")}else{setMenuItemState(210810,"regular");setMenuItemState(210820,"regular")}hideMenuItem(211020);hideMenuItem(211030);hideMenuItem(211040);var c=b.parentNode.parentNode;var d=c.parentNode;if(d.getAttribute("estimateRef")!=null&&d.getAttribute("estimateRef")!=""){hideMenuItem(210810);hideMenuItem(210820);hideMenuItem(210840);hideMenuItem(210850);hideMenuItem(210860);hideMenuItem(210870);hideMenuItem(210880);hideMenuItem(210890);hideMenuItem(210910);hideMenuItem(210920);hideMenuItem(210930);hideMenuItem(210950);hideMenuItem(210960);hideMenuItem(210970);hideMenuItem(211000);hideMenuItem(210980);showMenuItem(211020);showMenuItem(211030);showMenuItem(211040);if(b.myRow==null){hideMenuItem(211030);hideMenuItem(211040)}else{if(b.myRow.content[12]!=0&&b.myRow.content[4].parentNode.childNodes[2]==null){showMenuItem(211030)}else{hideMenuItem(211030)}showMenuItem(211040)}}else{showMenuItem(210810);showMenuItem(210820);showMenuItem(210840);showMenuItem(210850);showMenuItem(210860);showMenuItem(210870);showMenuItem(210880);showMenuItem(210890);showMenuItem(210910);showMenuItem(210920);showMenuItem(210930);showMenuItem(210950);showMenuItem(210960);showMenuItem(210970);showMenuItem(211000);showMenuItem(210980);hideMenuItem(211020);hideMenuItem(211030);hideMenuItem(211040)}setMenuPermissions(currentMenuBar)};function callProjectAjax(d){if(document.getElementById(projectTablecontainer)==null){return}if(projectPropertiesWindow!=null){projectPropertiesWindow.close()}var b=getHTMLHTTPRequest();projectTableCurrentParent=d;var c=parseInt(Math.random()*99999999);var a=myServerAddress+"MyXMLDispatcher?rand="+c+"&path="+20310+"&parent="+d+"&method=get";b.open("GET",a,true);b.onreadystatechange=function(){if(b.readyState==4){if(b.status==200){renderProject(b)}else{alert("Connection Problem:"+b.statusText)}}};writeWaitMsg(projectTablecontainer,"themes/icons/ajax_loading/22.gif","Processing request, please wait...");b.send(null)}function renderProject(b){var c=b.responseXML;if(c==null){alert("Data Error");return}var d=c.getElementsByTagName("status");var a=systemStatus(projectTablecontainer,d);if(a==0){return}var e="";e+="<div id='"+DIV_NAV_NAME+"'></div>";e+="<table id='"+TABLE_NAME+"' width='100%' class='contentTable'><thead id='"+ctx_THEAD+"'><tr><td width='18px'>&nbsp;</td><td width='1%'>Sl</td><td width='20%'>Name</td><td width='60%'>Description</td><td width='100%'>CostBook</td><td width='16px'>D</td><td width='16px'>E</td></tr></thead>";e+="<tbody id='"+ctx_TBODY+"'></tbody></table>";document.getElementById(projectTablecontainer).innerHTML=e;updateProjectNav(c,DIV_NAV_NAME);initiateTableRollover(TABLE_NAME,"tableRollOverEffect1","tableRowClickEffect1");populateTable(c,TABLE_NAME);contextMenu.attachTo(ctx_THEAD,menu2());contextMenu.attachTo(ctx_TBODY,menu2())}var updateProjectNav=function(b,a){var d=b.getElementsByTagName("levelParent");var c="<table class='navTable'><tr>";if(d!=null&&d.length>=1){projectTableparent=d[0].getAttribute("id");c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callProjectAjax("+projectTableparent+")'><img src='images/project/up.png' border='0' alt='Up one level'></a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callProjectAjax("+projectTableTop+")'><img src='images/project/top.png' border='0' alt='Top level'></a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='myProjectAddWindow(\""+TABLE_NAME+'","project");\'>Add Project</a></td>';c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='myProjectAddWindow(\""+TABLE_NAME+'","estimate");\'>Add Estimate</a></td>';c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='myProjectEditWindow(\""+TABLE_NAME+"\");'>Edit[E]</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='deleteChecked(\""+TABLE_NAME+"\");'>Delete[D]</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='myCostBookEditWindow(\""+TABLE_NAME+"\");'>Change CostBook[E]</a></td>"}else{c+="<td><img src='images/project/up1.png' alt='Up one level'></td>";c+="<td><img src='images/project/top1.png' alt='Top level'></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='myProjectAddWindow(\""+TABLE_NAME+'","project");\'>Add Project</a></td>';c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='myProjectAddWindow(\""+TABLE_NAME+'","estimate");\'>Add Estimate</a></td>';c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='myProjectEditWindow(\""+TABLE_NAME+"\");'>Edit[E]</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='deleteChecked(\""+TABLE_NAME+"\");'>Delete[D]</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='myCostBookEditWindow(\""+TABLE_NAME+"\");'>Change CostBook[E]</a></td>";projectTableparent=1}c+="<td>&nbsp;</td><td align='right'><input type='button' name='search' value='Search' onclick='populateSearchWin();'/></td>";c+="</tr></table>";document.getElementById(a).innerHTML=c};var populateTable=function(e,b){var d=e.getElementsByTagName("project");var a;var f;var g;for(var c=0;c<d.length;c++){f=document.getElementById(b);a=f.tBodies[0].rows.length;g=Array();g[0]="project";g[1]=d[c].childNodes[0].firstChild.data;g[2]=d[c].childNodes[1].firstChild.data;g[3]=d[c].childNodes[2].firstChild.data;g[4]=d[c].childNodes[3].firstChild.data;g[5]=d[c].childNodes[4].firstChild.data;addRowToTable1(f,a,g);reorderRows(f,a)}d=e.getElementsByTagName("estimate");for(c=0;c<d.length;c++){f=document.getElementById(b);a=f.tBodies[0].rows.length;g=Array();g[0]="estimate";g[1]=d[c].childNodes[0].firstChild.data;g[2]=d[c].childNodes[1].firstChild.data;g[3]=d[c].childNodes[2].firstChild.data;g[4]=d[c].childNodes[3].firstChild.data;g[5]=d[c].childNodes[4].firstChild.data;g[6]=d[c].childNodes[5].firstChild.data;g[7]=d[c].childNodes[6].firstChild.data;g[8]=d[c].childNodes[7].firstChild.data;g[9]=d[c].childNodes[8].firstChild.data;addRowToTable1(f,a,g);reorderRows(f,a)}};var myRowObject=function(b){this.content=Array();for(var a=0;a<b.length;a++){this.content[a]=b[a]}};var addRowToTable1=function(h,i,f){var p=h.tBodies[0].rows.length;var e=p+ROW_BASE;if(i==-1){i=p}else{e=i+ROW_BASE}var q=h.tBodies[0].insertRow(i);if(f[1]==sid){q.className="searchClass"}var o=Array();o[0]=q.insertCell(0);if(f[0]=="project"){o[0].innerHTML="<a href='javascript:void(0);' onclick='callProjectAjax("+f[1]+");'><img src='images/project/project.png' border='0'></a>"}else{o[0].innerHTML="<a href='javascript:void(0);' onclick='openBillWindow(event);'><img src='images/project/estimate.png' border='0' width='16' height='16'></a>"}o[1]=q.insertCell(1);var j=document.createTextNode(e);o[1].appendChild(j);o[2]=q.insertCell(2);var a=document.createTextNode(f[2]);o[2].appendChild(a);o[3]=q.insertCell(3);var n=document.createTextNode(f[3]);o[3].appendChild(n);o[4]=q.insertCell(4);var d;if(f[0]=="project"){d=document.createTextNode("--")}else{d=document.createTextNode(f[7])}o[4].appendChild(d);o[5]=q.insertCell(5);var k=document.createElement("input");k.setAttribute("type","checkbox");o[5].appendChild(k);o[6]=q.insertCell(6);var c;try{c=document.createElement('<input type="radio" name="'+RADIO_NAME+'" value="'+e+'">');var b=c.name.length}catch(l){c=document.createElement("input");c.setAttribute("type","radio");c.setAttribute("name",RADIO_NAME);c.setAttribute("value",e)}o[6].appendChild(c);var g=Array();g[0]=k;g[1]=c;g[2]=o[0].innerHTML;g[3]=j;g[4]=a;g[5]=n;g[6]=f[1];g[7]=f[0];if(f[0]=="project"){g[8]=f[4];g[9]=f[5]}else{g[8]=f[4];g[9]=f[5];g[10]=f[6];g[11]=d;g[12]=f[8];g[13]=f[9]}var m=new myRowObject(g);q.myRow=m;addRowRolloverEffect(q)};var myProjectDeleteRequest=getHTMLHTTPRequest();function callDeleteProjectAjax(g,h,d){if(!confirmDelete()){return}var k;var c=Array();var e;k=g;c=h;e=d;var j=parseInt(Math.random()*99999999);var b="";var l="";for(var f=0;f<h.length;f++){if(h[f].myRow.content[7]=="project"&&b==""){b+=h[f].myRow.content[6]}else{if(h[f].myRow.content[7]=="estimate"&&l==""){l+=h[f].myRow.content[6]}else{if(h[f].myRow.content[7]=="project"){b+=","+h[f].myRow.content[6]}else{l+=","+h[f].myRow.content[6]}}}}var a=myServerAddress+"MyXMLDispatcher?rand="+j+"&path="+20320+"&proid="+URLEncode(b)+"&estid="+URLEncode(l)+"&method=delete";myProjectDeleteRequest.open("GET",a,true);myProjectDeleteRequest.onreadystatechange=function(){if(myProjectDeleteRequest.readyState==4){if(myProjectDeleteRequest.status==200){var m=myProjectDeleteRequest.responseXML;var i=0;if(m==null){alert("Data Error")}else{var n=m.getElementsByTagName("status");i=systemStatus(null,n)}if(i==1){deleteRows(c);reorderRows(k,e)}else{if(i==2){alert("DELETE: System Error")}}}else{alert("Connection Problem:"+myProjectDeleteRequest.statusText)}closeSplashScreen()}};openSplashScreen();myProjectDeleteRequest.send(null)}var deleteChecked=function(d){var f=document.getElementById(d);var a=new Array();var b=0;for(var c=0;c<f.tBodies[0].rows.length;c++){if(f.tBodies[0].rows[c].myRow.content[0].checked){a[b]=f.tBodies[0].rows[c];b++}}if(a.length>0){var e=a[0].sectionRowIndex;callDeleteProjectAjax(f,a,e)}};var deleteRows=function(c){for(var a=0;a<c.length;a++){var b=c[a].sectionRowIndex;c[a].parentNode.deleteRow(b)}};var reorderRows=function(d,c){if(d.tBodies[0].rows[c]){var b=c+ROW_BASE;for(var a=c;a<d.tBodies[0].rows.length;a++){d.tBodies[0].rows[a].myRow.content[3].data=b;b++}}};var deleteContextChecked=function(){var a=new Array();var b=contextMenu.srcElement;while(true){a[0]=b.parentNode;if(a[0].tagName!="TR"){b=a[0];continue}else{break}}var d=a[0].parentNode.parentNode;var c=a[0].sectionRowIndex;callDeleteProjectAjax(d,a,c)};var projectPropertiesWindowDiv="blankHidden";var projectPropertiesWindowTitle="Properties";var projectPropertiesWindowId="projectPropertiesWindowId";var indexOfRowToEdit=-1;var rowToEdit=null;var myContextProjectEditWindow=function(){indexOfRowToEdit=-1;rowToEdit=null;var a=contextMenu.srcElement;while(true){rowToEdit=a.parentNode;if(rowToEdit.tagName!="TR"){a=rowToEdit;continue}else{break}}if(rowToEdit!=null){populateProjectEditWin()}};var myProjectEditWindow=function(b){var c=document.getElementById(b);indexOfRowToEdit=-1;rowToEdit=null;for(var a=0;a<c.tBodies[0].rows.length;a++){if(c.tBodies[0].rows[a].myRow&&c.tBodies[0].rows[a].myRow.content[1].getAttribute("type")=="radio"&&c.tBodies[0].rows[a].myRow.content[1].checked){indexOfRowToEdit=a;rowToEdit=c.tBodies[0].rows[a]}}if(rowToEdit!=null){populateProjectEditWin()}};var populateProjectEditWin=function(){var a="<table>";if(rowToEdit!=null){if(rowToEdit.myRow.content[7]=="project"){a+="<tr><td><label>Name:</label></td><td><input size='40' type='text' id='editName' value='"+rowToEdit.myRow.content[4].data+"'></td></tr>";a+="<tr><td><label>Specification:</label></td><td><textarea rows='6' cols='30' id='editDescription'>"+rowToEdit.myRow.content[5].data+"</textarea></td></tr>";a+="<tr><td><label>Remarks:</label></td><td><textarea rows='6' cols='30' id='editRemarks'>"+rowToEdit.myRow.content[8]+"</textarea></td></tr>";a+="<tr><td colspan='2' align='center'><a href='javascript:void(0)' onclick='callEditProjectAjax();'>Update</a>&nbsp;&nbsp;";a+="<a href='javascript:void(0)' onclick='projectPropertiesWindow.close()'>Discard</a></td></tr>"}else{a+="<tr><td><label>Name:</label></td><td><input size='40' type='text' id='editName' value='"+rowToEdit.myRow.content[4].data+"'></td></tr>";a+="<tr><td><label>Specification:</label></td><td><textarea rows='6' cols='30' id='editDescription'>"+rowToEdit.myRow.content[5].data+"</textarea></td></tr>";a+="<tr><td><label>Remarks:</label></td><td><textarea rows='6' cols='30' id='editRemarks'>"+rowToEdit.myRow.content[8]+"</textarea></td></tr>";a+="<tr style='display: none'><td><label>Contingency (%):</label></td><td><input size='40' type='text' id='editContingency' value='"+rowToEdit.myRow.content[12]+"'></td></tr>";a+="<tr><td><label>Rounded-off Figure:</label></td><td><input size='40' type='text' id='editRndOffFigure' value='"+rowToEdit.myRow.content[13]+"'></td></tr>";a+="<tr><td colspan='2' align='center'><a href='javascript:void(0)' onclick='callEditProjectAjax();'>Update</a>&nbsp;&nbsp;";a+="<a href='javascript:void(0)' onclick='projectPropertiesWindow.close()'>Discard</a></td></tr>"}}a+="</table>";var b=document.getElementById(projectPropertiesWindowDiv);b.innerHTML=a;openMyProjectPropertiesWin()};var openMyProjectPropertiesWin=function(){projectPropertiesWindow=internalWindow.open("projectPropertiesWindowId","div",projectPropertiesWindowDiv,"#Properties Window","width=450px,height=350px,left=200px,top=150px,resize=1,scrolling=1")};var myProjectUpdateData="";var myProjectEditRequest=getHTMLHTTPRequest();var callEditProjectAjax=function(){var c=parseInt(Math.random()*99999999);var a="";var d;if(rowToEdit.myRow.content[7]=="project"){d="updateProject";a="id="+rowToEdit.myRow.content[6];a+="&name="+URLEncode(document.getElementById("editName").value);a+="&description="+URLEncode(document.getElementById("editDescription").value);a+="&remarks="+URLEncode(document.getElementById("editRemarks").value)}else{d="updateEstimate";a="id="+rowToEdit.myRow.content[6];a+="&name="+URLEncode(document.getElementById("editName").value);a+="&description="+URLEncode(document.getElementById("editDescription").value);a+="&remarks="+URLEncode(document.getElementById("editRemarks").value);a+="&contingency="+URLEncode(document.getElementById("editContingency").value);a+="&rndOffFigure="+URLEncode(document.getElementById("editRndOffFigure").value)}var b=myServerAddress+"MyXMLDispatcher?rand="+c+"&path="+20330+"&method="+d;myProjectEditRequest.open("POST",b,true);myProjectEditRequest.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8");myProjectEditRequest.setRequestHeader("Content-length",a.length);myProjectEditRequest.onreadystatechange=updateProjectAction;openSplashScreen();myProjectEditRequest.send(a)};function updateProjectAction(){if(myProjectEditRequest.readyState==4){if(myProjectEditRequest.status==200){var b=myProjectEditRequest.responseXML;var a=0;if(b==null){alert("Data Error")}else{var c=b.getElementsByTagName("status");a=systemStatus(null,c)}if(a==1){if(rowToEdit.myRow.content[7]=="project"){rowToEdit.myRow.content[4].data=document.getElementById("editName").value;rowToEdit.myRow.content[5].data=document.getElementById("editDescription").value;rowToEdit.myRow.content[8]=document.getElementById("editRemarks").value}else{rowToEdit.myRow.content[4].data=document.getElementById("editName").value;rowToEdit.myRow.content[5].data=document.getElementById("editDescription").value;rowToEdit.myRow.content[8]=document.getElementById("editRemarks").value;rowToEdit.myRow.content[12]=document.getElementById("editContingency").value;rowToEdit.myRow.content[13]=document.getElementById("editRndOffFigure").value}}else{if(a==2){alert("EDIT: System Error")}}projectPropertiesWindow.close()}else{alert("Connection Problem:"+myProjectEditRequest.statusText);projectPropertiesWindow.close()}closeSplashScreen()}}var editCostBookInnerDiv="costBookInnerDiv";var myContextCostBookEditWindow=function(b){var c=document.getElementById(b);indexOfRowToEdit=-1;rowToEdit=null;var a=contextMenu.srcElement;while(true){rowToEdit=a.parentNode;if(rowToEdit.tagName!="TR"){a=rowToEdit;continue}else{break}}if(rowToEdit!=null&&rowToEdit.myRow.content[7]=="estimate"){populateCostBookEditWin()}};var myCostBookEditWindow=function(b){var c=document.getElementById(b);indexOfRowToEdit=-1;rowToEdit=null;for(var a=0;a<c.tBodies[0].rows.length;a++){if(c.tBodies[0].rows[a].myRow&&c.tBodies[0].rows[a].myRow.content[1].getAttribute("type")=="radio"&&c.tBodies[0].rows[a].myRow.content[1].checked){indexOfRowToEdit=a;rowToEdit=c.tBodies[0].rows[a]}}if(rowToEdit!=null&&rowToEdit.myRow.content[7]=="estimate"){populateCostBookEditWin()}};var populateCostBookEditWin=function(){var a="<div id='"+editCostBookInnerDiv+"'></div>";var b=document.getElementById(projectPropertiesWindowDiv);b.innerHTML=a;openMyCostBookPropertiesWin()};var openMyCostBookPropertiesWin=function(){projectPropertiesWindow=internalWindow.open(projectPropertiesWindowId,"div",projectPropertiesWindowDiv,"#CostBook","width=750px,height=500px,left=20px,top=15px,resize=1,scrolling=1");callCbCatAjax(1)};var myProjectTable=null;var myProjectAddWindow=function(a,b){var c=document.getElementById(a);myProjectTable=c;populateProjectAddWin(b)};var populateProjectAddWin=function(b){var a="<table>";if(b=="project"){a+="<tr><td><label>Name:</label></td><td><input size='40' type='text' id='editName' value='name'></td></tr>";a+="<tr><td><label>Specification:</label></td><td><textarea rows='6' cols='30' id='editDescription'>specification</textarea></td></tr>";a+="<tr><td><label>Remarks:</label></td><td><textarea rows='6' cols='30' id='editRemarks'>remarks</textarea></td></tr>";a+="<tr><td colspan='2' align='center'><a href='javascript:void(0)' onclick='callAddProjectAjax(\""+b+"\");'>Add</a>&nbsp;&nbsp;";a+="<a href='javascript:void(0)' onclick='projectPropertiesWindow.close()'>Discard</a></td></tr>"}else{a+="<tr><td><label>Name:</label></td><td><input size='40' type='text' id='editName' value='name'></td></tr>";a+="<tr><td><label>Specification:</label></td><td><textarea rows='6' cols='30' id='editDescription'>specification</textarea></td></tr>";a+="<tr><td><label>Remarks:</label></td><td><textarea rows='6' cols='30' id='editRemarks'>remarks</textarea></td></tr>";a+="<tr><td colspan='2' align='center'><a href='javascript:void(0)' onclick='callAddProjectAjax(\""+b+"\");'>Add</a>&nbsp;&nbsp;";a+="<a href='javascript:void(0)' onclick='projectPropertiesWindow.close()'>Discard</a></td></tr>"}a+="</table>";var c=document.getElementById(projectPropertiesWindowDiv);c.innerHTML=a;openMyProjectPropertiesWin()};var myProjectAddData="";var myProjectAddRequest=getHTMLHTTPRequest();var callAddProjectAjax=function(b){var c=parseInt(Math.random()*99999999);if(b=="project"){method="addProject";myProjectAddData="id="+projectTableCurrentParent;myProjectAddData+="&name="+URLEncode(document.getElementById("editName").value);myProjectAddData+="&description="+URLEncode(document.getElementById("editDescription").value);myProjectAddData+="&remarks="+URLEncode(document.getElementById("editRemarks").value)}else{method="addEstimate";myProjectAddData="id="+projectTableCurrentParent;myProjectAddData+="&name="+URLEncode(document.getElementById("editName").value);myProjectAddData+="&description="+URLEncode(document.getElementById("editDescription").value);myProjectAddData+="&remarks="+URLEncode(document.getElementById("editRemarks").value)}var a=myServerAddress+"MyXMLDispatcher?rand="+c+"&path="+20340+"&method="+method;myProjectAddRequest.open("POST",a,true);myProjectAddRequest.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8");myProjectAddRequest.setRequestHeader("Content-length",myProjectAddData.length);myProjectAddRequest.onreadystatechange=addProjectAction;openSplashScreen();myProjectAddRequest.send(myProjectAddData)};function addProjectAction(){if(myProjectAddRequest.readyState==4){if(myProjectAddRequest.status==200){var d=myProjectAddRequest.responseXML;var a=0;if(d==null){alert("Data Error")}else{var e=d.getElementsByTagName("status");a=systemStatus(null,e)}if(a==1){var b=d.getElementsByTagName("key")[0].getAttribute("value");var c=d.getElementsByTagName("key")[0].getAttribute("type");var g=Array();var f=0;if(c=="estimate"){g[0]="estimate";g[1]=""+b;g[2]=document.getElementById("editName").value;g[3]=document.getElementById("editDescription").value;g[4]=document.getElementById("editRemarks").value;g[5]=""+projectTableCurrentParent;g[6]=0;g[7]="--";g[8]=0;g[9]="-";f=getMaxEstimateRow()}else{g[0]="project";g[1]=""+b;g[2]=document.getElementById("editName").value;g[3]=document.getElementById("editDescription").value;g[4]=document.getElementById("editRemarks").value;g[5]=""+projectTableCurrentParent;f=getMaxProjectRow()}addRowToTable1(myProjectTable,f,g);reorderRows(myProjectTable,f)}else{if(a==2){alert("ADD: An Error Occured")}}projectPropertiesWindow.close()}else{alert("Connection Problem:"+myProjectAddRequest.statusText);projectPropertiesWindow.close()}closeSplashScreen()}}var getMaxEstimateRow=function(){var b=myProjectTable;var c=-1;for(var a=0;a<b.tBodies[0].rows.length;a++){if(b.tBodies[0].rows[a].myRow.content[7]=="estimate"&&c<=a){c=a}}if(c==-1){for(a=0;a<b.tBodies[0].rows.length;a++){if(b.tBodies[0].rows[a].myRow.content[7]=="project"&&c<=a){c=a}}}return c+1};var getMaxProjectRow=function(){var b=myProjectTable;var c=-1;for(var a=0;a<b.tBodies[0].rows.length;a++){if(b.tBodies[0].rows[a].myRow.content[7]=="project"&&c<=a){c=a}}return c+1};var openContextBillWindow=function(){var b=contextMenu.srcElement;var e=null;while(true){e=b.parentNode;if(e.tagName!="TR"){b=e;continue}else{break}}if(e!=null){var d=e.myRow.content[4].data;var f=e.myRow.content[6];var c=e.myRow.content[10];var a="billWindow"+f;internalWindow.open(a,"iframe","MyActionDispatcher?path=20410&method=get&id="+f+"&cbId="+c,"Bill for Estimate: ["+d+"]","width=900px,height=600px,left=10px,top=10px,resize=1,scrolling=1")}};var openBillWindow=function(f){var b=f;var j=null;var c=null;if(b.target){j=b.target.parentNode.parentNode.parentNode}else{if(b.srcElement){j=b.srcElement.parentNode.parentNode.parentNode}}if(j!=null){var g=j.sectionRowIndex;c=j.parentNode.parentNode;var d=j.myRow.content[4].data;var a=j.myRow.content[6];var h=j.myRow.content[10];var i="billWindow"+a;internalWindow.open(i,"iframe","MyActionDispatcher?path=20410&method=get&id="+a+"&cbId="+h,"Bill for Estimate: ["+d+"]","width=900px,height=600px,left=10px,top=10px,resize=1,scrolling=1")}};var cbCatTableparent=1;var cbCatTableTop=1;var cbCatTableCurrentParent=1;var cbCatTablecontainer=editCostBookInnerDiv;var CB_TABLE_NAME="cbCatSample123";var CB_DIV_NAV_NAME="cbCatNavDiv123";var CB_ROW_BASE=1;function callCbCatAjax(d){if(document.getElementById(cbCatTablecontainer)==null){return}var b=getHTMLHTTPRequest();cbCatTableCurrentParent=d;var c=parseInt(Math.random()*99999999);var a=myServerAddress+"MyXMLDispatcher?rand="+c+"&path="+20350+"&parent="+d+"&method=getCostBook";b.open("GET",a,true);b.onreadystatechange=function(){if(b.readyState==4){if(b.status==200){renderCbCat(b)}else{alert("Connection Problem:"+b.statusText)}}};writeWaitMsg(cbCatTablecontainer,"themes/icons/ajax_loading/22.gif","Loading page, please wait...");b.send(null)}function renderCbCat(b){var c=b.responseXML;if(c==null){alert("Data Error");return}var d=c.getElementsByTagName("status");var a=systemStatus(cbCatTablecontainer,d);if(a==0){return}var e="";e+="<div id='"+CB_DIV_NAV_NAME+"'></div>";e+="<table id='"+CB_TABLE_NAME+"' width='100%' class='innerContentTable'><thead id='TThead1'><tr><td width='18px'>&nbsp;</td><td width='1%'>Sl</td><td width='10%'>Name</td><td width='100%'>Description</td><td>&nbsp;</td></tr></thead>";e+="<tbody id='TTbody1'></tbody></table>";document.getElementById(cbCatTablecontainer).innerHTML=e;updateCbCatNav(c,CB_DIV_NAV_NAME);populateCbTable(c,CB_TABLE_NAME);addTableRolloverEffect(CB_TABLE_NAME,"tableRollOverEffect2","tableRowClickEffect2")}var updateCbCatNav=function(b,a){var d=b.getElementsByTagName("levelParent");var c="<table class='innerNavTable'><tr>";if(d!=null&&d.length>=1){cbCatTableparent=d[0].getAttribute("id");c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callCbCatAjax("+cbCatTableparent+")'><img src='images/costbook/up.png' border='0' alt='Up one level'></a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callCbCatAjax("+cbCatTableTop+")'><img src='images/costbook/top.png' border='0' alt='Top level'></a></td>"}else{if(searchFlag1==false){c+="<td><img src='images/costbook/up1.png' alt='Up one level'></td>";c+="<td><img src='images/costbook/top1.png' alt='Top level'></td>";cbCatTableparent=1}else{c+="<td><img src='images/costbook/up1.png' alt='Up one level'></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='callCbCatAjax("+cbCatTableTop+")'><img src='images/costbook/top.png' border='0' alt='Top level'></a></td>";searchFlag1=false;cbCatTableparent=1}}c+="<td><label>Enter keyword:</label></td><td><input size='40' type='text' id='searchKeyForCB' value=''></td><td><input type='button' value='GO' onclick='vaildateKey1();'></td>";c+="</tr></table>";document.getElementById(a).innerHTML=c};var populateCbTable=function(e,b){var d=e.getElementsByTagName("cbCat");var a;var f;var g;for(var c=0;c<d.length;c++){f=document.getElementById(b);a=f.tBodies[0].rows.length;g=Array();g[0]="cbCat";g[1]=d[c].childNodes[0].firstChild.data;g[2]=d[c].childNodes[1].firstChild.data;g[3]=d[c].childNodes[2].firstChild.data;g[4]=d[c].childNodes[3].firstChild.data;g[5]=d[c].childNodes[4].firstChild.data;addRowToTable2(f,a,g);reorderRows(f,a)}d=e.getElementsByTagName("cb");for(c=0;c<d.length;c++){f=document.getElementById(b);a=f.tBodies[0].rows.length;g=Array();g[0]="cb";g[1]=d[c].childNodes[0].firstChild.data;g[2]=d[c].childNodes[1].firstChild.data;g[3]=d[c].childNodes[2].firstChild.data;g[4]=d[c].childNodes[3].firstChild.data;g[5]=d[c].childNodes[4].firstChild.data;addRowToTable2(f,a,g);reorderRows(f,a)}};var addRowToTable2=function(e,f,c){var k=e.tBodies[0].rows.length;var b=k+CB_ROW_BASE;if(f==-1){f=k}else{b=f+CB_ROW_BASE}var l=e.tBodies[0].insertRow(f);var j=Array();j[0]=l.insertCell(0);if(c[0]=="cbCat"){j[0].innerHTML="<a href='javascript:void(0);' onclick='callCbCatAjax("+c[1]+")'><img src='images/costbook/folder.gif' border='0'></a>"}else{j[0].innerHTML="<img src='images/costbook/costbook.png' border='0'>"}j[1]=l.insertCell(1);var g=document.createTextNode(b);j[1].appendChild(g);j[2]=l.insertCell(2);var a=document.createTextNode(c[2]);j[2].appendChild(a);j[3]=l.insertCell(3);var i=document.createTextNode(c[3]);j[3].appendChild(i);j[4]=l.insertCell(4);if(c[0]=="cbCat"){j[4].innerHTML="&nbsp;"}else{j[4].innerHTML="<a href='javascript:void(0);' onclick='callEditCostBookAjax(\""+e.getAttribute("id")+'",'+l.sectionRowIndex+")'><img src='images/common/tick.gif' border='0'></a>"}var d=Array();d[0]=0;d[1]=0;d[2]=j[0].innerHTML;d[3]=g;d[4]=a;d[5]=i;d[6]=c[1];d[7]=c[0];if(c[0]=="cbCat"){d[8]=c[4];d[9]=c[5]}else{d[8]=c[4];d[9]=c[5]}var h=new myRowObject(d);l.myRow=h};var myCoskBookEditRequest=getHTMLHTTPRequest();var newCbRow;var callEditCostBookAjax=function(c,g){var e=document.getElementById(c);var f=e.tBodies[0].rows[g];var h=f.myRow.content[6];newCbRow=f;var a=rowToEdit.myRow.content[6];var d=parseInt(Math.random()*99999999);var b=myServerAddress+"MyXMLDispatcher?rand="+d+"&path="+20360+"&id="+h+"&estimateId="+a+"&method=changeCostBook";myCoskBookEditRequest.open("GET",b,true);myCoskBookEditRequest.onreadystatechange=updateCostBookAction;openSplashScreen();myCoskBookEditRequest.send(null)};var updateCostBookAction=function(){if(myCoskBookEditRequest.readyState==4){if(myCoskBookEditRequest.status==200){var b=myCoskBookEditRequest.responseXML;var a=0;if(b==null){alert("Data Error")}else{var c=b.getElementsByTagName("status");a=systemStatus(null,c)}if(a==1){rowToEdit.myRow.content[10]=newCbRow.myRow.content[6];rowToEdit.myRow.content[11].data=newCbRow.myRow.content[4].data}else{if(a==2){alert("ChangeCostBook: System Error")}}}else{alert("Connection Problem:"+myCoskBookEditRequest.statusText)}closeSplashScreen()}};var cutContextSelected=function(){myMoveAction.reInit();var c=null;var b=contextMenu.srcElement;while(true){c=b.parentNode;if(c.tagName!="TR"){b=c;continue}else{break}}var a=new Array();if(c.myRow.content[7]=="project"){myMoveAction.cut("project",c.myRow.content[6],c.myRow.content[9]);a[0]="project";a[1]=""+c.myRow.content[6];a[2]=""+c.myRow.content[4].data;a[3]=""+c.myRow.content[5].data;a[4]=""+c.myRow.content[8];a[5]=""+c.myRow.content[9]}else{if(c.myRow.content[7]=="estimate"){myMoveAction.cut("estimate",c.myRow.content[6],c.myRow.content[9]);a[0]="estimate";a[1]=""+c.myRow.content[6];a[2]=""+c.myRow.content[4].data;a[3]=""+c.myRow.content[5].data;a[4]=""+c.myRow.content[8];a[5]=""+c.myRow.content[9];a[6]=""+c.myRow.content[10];a[7]=""+c.myRow.content[11].data;a[8]=""+c.myRow.content[12];a[9]=""+c.myRow.content[13]}}myMoveAction.initParams(a)};var copyContextSelected=function(){myMoveAction.reInit();var c=null;var b=contextMenu.srcElement;while(true){c=b.parentNode;if(c.tagName!="TR"){b=c;continue}else{break}}var a=new Array();if(c.myRow.content[7]=="estimate"){myMoveAction.cut("copyEstimate",c.myRow.content[6],c.myRow.content[9]);a[0]="estimate";a[1]=""+c.myRow.content[6];a[2]=""+c.myRow.content[4].data;a[3]=""+c.myRow.content[5].data;a[4]=""+c.myRow.content[8];a[5]=""+c.myRow.content[9];a[6]=""+c.myRow.content[10];a[7]=""+c.myRow.content[11].data;a[8]=""+c.myRow.content[12];a[9]=""+c.myRow.content[13]}myMoveAction.initParams(a)};var callPasteToLocationAjax=function(){myMoveAction.verify=function(){if(this.movableItemType=="project"){if(this.movableItemId==this.movableToParentId){alert("Cannot move selected to it's own subtree");return false}if(this.movableFromCurrentParentId==this.movableToParentId){alert("Please chose a different location");return false}}else{if(this.movableItemType=="estimate"){if(this.movableFromCurrentParentId==this.movableToParentId){alert("Please chose a different location");return false}}}return true};if(myMoveAction.paste(projectTableCurrentParent)==false){return}var h=""+myMoveAction.movableItemId;var c=""+myMoveAction.movableItemType;var a=""+myMoveAction.movableFromCurrentParentId;var d=""+myMoveAction.movableToParentId;var g=myMoveAction.paramArray;if(c=="estimate"||c=="copyEstimate"){g[5]=d}else{if(c=="project"){g[5]=d}}var f=getHTMLHTTPRequest();var e=parseInt(Math.random()*99999999);var b="";if(c=="copyEstimate"){b=myServerAddress+"MyXMLDispatcher?rand="+e+"&path="+20650+"&id="+h+"&pid="+a+"&newPid="+d+"&method="+c}else{b=myServerAddress+"MyXMLDispatcher?rand="+e+"&path="+20640+"&id="+h+"&pid="+a+"&newPid="+d+"&method="+c}f.open("GET",b,true);f.onreadystatechange=function(){if(f.readyState==4){if(f.status==200){var j=f.responseXML;var i=0;if(j==null){alert("Data Error")}else{var k=j.getElementsByTagName("status");i=systemStatus(null,k)}if(i==1){myProjectTable=document.getElementById(TABLE_NAME);if(c=="estimate"){addRowToTable1(document.getElementById(TABLE_NAME),getMaxEstimateRow(),g)}else{if(c=="project"){addRowToTable1(document.getElementById(TABLE_NAME),getMaxProjectRow(),g)}else{if(c=="copyEstimate"){var l=j.getElementsByTagName("key");g[1]=""+l[0].getAttribute("value");addRowToTable1(document.getElementById(TABLE_NAME),getMaxEstimateRow(),g)}}}}else{if(i==2){alert("Move/Copy: System Error")}}}else{alert("Connection Problem:"+f.statusText)}if(c!="copyEstimate"){myMoveAction.reInit()}closeSplashScreen()}};openSplashScreen();f.send(null)};var filesWindowId="FilesWIndowId";var openFilesWindow=function(){var b;var d=null;var c=contextMenu.srcElement;while(true){d=c.parentNode;if(d.tagName!="TR"){c=d;continue}else{break}}b=""+d.myRow.content[6];var a=d.myRow.content[4].data;internalWindow.open(filesWindowId,"iframe","MyActionDispatcher?path=20710&method=getProjectRefForUpdate&id="+b+"&uploadPath="+20720,"Files for Project: ["+a+"]","width=900px,height=400px,left=10px,top=10px,resize=1,scrolling=1")};var populateSearchWin=function(){var a="<table>";a+="<tr><td><label>Enter keyword:</label></td><td><input size='40' type='text' id='searchKey' value=''></td><td><input type='button' value='GO' onclick='vaildateKey();'></td></tr>";a+="</table>";a+="<div id='searchResult'>&nbsp;</div>";var b=document.getElementById("blankHidden1");b.innerHTML=a;openSearchWin()};var openSearchWin=function(){projectPropertiesWindow=internalWindow.open("searchWindow","div","blankHidden1","Search Project","width=600px,height=400px,left=200px,top=150px,resize=1,scrolling=1")};function vaildateKey(){key=document.getElementById("searchKey").value;if(key.length<3){alert("Enter Minimum 3 Character");return}else{callSearchProjectAjax()}}function callSearchProjectAjax(){var a=getHTMLHTTPRequest();var d=parseInt(Math.random()*99999999);var c=URLEncode(key);var b=myServerAddress+"MyXMLDispatcher?rand="+d+"&path="+20310+"&key="+c+"&method=searchProject";a.open("GET",b,true);a.onreadystatechange=function(){if(a.readyState==4){if(a.status==200){renderSearch(a)}else{alert("Connection Problem:"+a.statusText)}}};writeWaitMsg("searchResult","themes/icons/ajax_loading/22.gif","Processing request, please wait...");a.send(null)}function renderSearch(c){var d=c.responseXML;if(d==null){alert("Data Error");return}var f=d.getElementsByTagName("status");var a=systemStatus("searchResult",f);if(a==0){return}var b="";b+="<table id='searchTable' width='100%' class='contentTable'><thead><tr><td width='18px'>&nbsp;</td><td width='1%'>Sl</td><td width='20%'>Name</td><td>Description</td></tr></thead>";b+="<tbody id='searchbody'></tbody></table>";document.getElementById("searchResult").innerHTML=b;populateSearchTable(d,"searchTable");var e=document.getElementById("searchResult").innerHTML;document.getElementById("searchResult").innerHTML=doHighlight(e,key);addTableRolloverEffect("searchTable","tableRollOverEffect2","tableRowClickEffect2")}var populateSearchTable=function(e,b){var d=e.getElementsByTagName("project");var a;var f;var g;for(var c=0;c<d.length;c++){f=document.getElementById(b);a=f.tBodies[0].rows.length;g=Array();g[0]="project";g[1]=d[c].childNodes[0].firstChild.data;g[2]=d[c].childNodes[1].firstChild.data;g[3]=d[c].childNodes[2].firstChild.data;g[4]=d[c].childNodes[3].firstChild.data;g[5]=d[c].childNodes[4].firstChild.data;addRowToSearchTable(f,a,g);reorderRows(f,a)}d=e.getElementsByTagName("estimate");for(c=0;c<d.length;c++){f=document.getElementById(b);a=f.tBodies[0].rows.length;g=Array();g[0]="estimate";g[1]=d[c].childNodes[0].firstChild.data;g[2]=d[c].childNodes[1].firstChild.data;g[3]=d[c].childNodes[2].firstChild.data;g[4]=d[c].childNodes[3].firstChild.data;g[5]=d[c].childNodes[4].firstChild.data;addRowToSearchTable(f,a,g);reorderRows(f,a)}};var addRowToSearchTable=function(e,f,c){var k=e.tBodies[0].rows.length;var b=k+1;if(f==-1){f=k}else{b=f+1}var l=e.tBodies[0].insertRow(f);var j=Array();j[0]=l.insertCell(0);if(c[0]=="project"){j[0].innerHTML="<a href='javascript:void(0);' onclick='sid="+c[1]+";callProjectAjax("+c[5]+");'><img src='images/project/project.png' border='0'></a>"}else{j[0].innerHTML="<a href='javascript:void(0);' onclick='sid="+c[1]+";callProjectAjax("+c[5]+");'><img src='images/project/estimate.png' border='0' width='16' height='16'></a>"}j[1]=l.insertCell(1);var g=document.createTextNode(b);j[1].appendChild(g);j[2]=l.insertCell(2);var a=document.createTextNode(c[2]);j[2].appendChild(a);j[3]=l.insertCell(3);var i=document.createTextNode(c[3]);j[3].appendChild(i);var d=Array();d[0]="";d[1]="";d[2]=j[0].innerHTML;d[3]=g;d[4]=a;d[5]=i;d[6]=c[1];d[7]=c[0];d[8]=c[4];d[9]=c[5];var h=new myRowObject(d);l.myRow=h};function vaildateKey1(){key1=document.getElementById("searchKeyForCB").value;if(key1.length<3){alert("Enter Minimum 3 Character");return}else{callSearchCbCatAjax()}}function callSearchCbCatAjax(e){if(document.getElementById(cbCatTablecontainer)==null){return}var c=getHTMLHTTPRequest();cbCatTableCurrentParent=e;var d=parseInt(Math.random()*99999999);var b=URLEncode(key1);var a=myServerAddress+"MyXMLDispatcher?rand="+d+"&path="+20350+"&key="+b+"&method=searchCostBook";c.open("GET",a,true);c.onreadystatechange=function(){if(c.readyState==4){if(c.status==200){searchFlag1=true;renderCbCat(c)}else{alert("Connection Problem:"+c.statusText)}}};writeWaitMsg(cbCatTablecontainer,"themes/icons/ajax_loading/22.gif","Loading page, please wait...");c.send(null)}var myOverheadRow;var initItemWin=function(e,a){myOverheadRow=null;if(e==true){var b=contextMenu.srcElement;var d;while(true){d=b.parentNode;if(d.tagName!="TR"){b=d;continue}else{break}}myOverheadRow=d}else{var f=document.getElementById(a);for(var c=0;c<f.tBodies[0].rows.length;c++){if(f.tBodies[0].rows[c].myRow&&f.tBodies[0].rows[c].myRow.content[1].getAttribute("type")=="radio"&&f.tBodies[0].rows[c].myRow.content[1].checked){myOverheadRow=f.tBodies[0].rows[c]}}}if(myOverheadRow!=null){openAddJobsWin()}};var overheadsContainerDiv="blankHidden1";var overheadsInnerDivPrefix="overheadsInnerDivPrefix";var overheadsWindowIdPrefix="overheadsWindowIdPrefix";var INNER_OVERHEAD_TABLE_NAME_PREFIX="innerOverheadTableNamePrefix";var INNER_OVERHEAD_NAV_DIV_PREFIX="innerOverheadNavDivPrefix";var openAddJobsWin=function(){var a=myOverheadRow.myRow.content[6];var c=myOverheadRow.myRow.content[4].data;var b="<div id='"+overheadsInnerDivPrefix+a+"' class='smallText'>Loading content, please wait...</div>";document.getElementById(overheadsContainerDiv).innerHTML=b;internalWindow.open(overheadsWindowIdPrefix+a,"div",overheadsContainerDiv,"Overheads for #"+c,"width=850px,height=500px,left=5px,top=5px,resize=1,scrolling=1");callShowOverheadsAjax(a)};var callShowOverheadsAjax=function(b){if(document.getElementById(overheadsInnerDivPrefix+b)==null){return}var a=getHTMLHTTPRequest();var d=parseInt(Math.random()*99999999);var c=myServerAddress+"MyXMLDispatcher?rand="+d+"&path="+20370+"&estimateId="+b+"&method=getOverhead";a.open("GET",c,true);a.onreadystatechange=function(){if(a.readyState==4){if(a.status==200){renderOverheads(a)}else{alert("Connection Problem:"+a.statusText)}}};a.send(null)};var renderOverheads=function(a){var f=a.responseXML;if(f==null){alert("Data Error");return}var g=f.getElementsByTagName("status");var e=f.getElementsByTagName("estimate");var c=0;if(e!=null&&e.length>0){c=e[0].getAttribute("id");var b=document.getElementById(overheadsInnerDivPrefix+c);b.setAttribute("estimateRef",c);var h="<div id='"+INNER_OVERHEAD_NAV_DIV_PREFIX+c+"'></div>";h+="<table width='97%' class='innerContentTable' id='"+INNER_OVERHEAD_TABLE_NAME_PREFIX+c+"'><thead id='JOBTHEAD"+c+"'><tr><td width='16px'>&nbsp;</td><td width='16px'>Sl</td><td width='30%'>Overhead Title</td><td>Overhead Percent</td><td>Overhead Type</td><td>On Amount</td><td>D</td></tr></thead><tbody id='JOBTBODY"+c+"'></tbody></table>";b.innerHTML=h;contextMenu.attachTo("JOBTHEAD"+c,menu2());contextMenu.attachTo("JOBTBODY"+c,menu2());updateOverheadsNav(f,INNER_OVERHEAD_NAV_DIV_PREFIX,INNER_OVERHEAD_TABLE_NAME_PREFIX,c);populateOverheadsTable(f,INNER_OVERHEAD_TABLE_NAME_PREFIX,c);addTableRolloverEffect(INNER_OVERHEAD_TABLE_NAME_PREFIX+c,"tableRollOverEffect1","tableRowClickEffect1")}else{var d=systemStatus(null,g);if(d==0){return}}};var updateOverheadsNav=function(b,e,a,d){var c="<table class='innerNavTable'><tr>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='addNewOverheadBox(\""+a+'",'+d+");'>Add New</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='editCheckedOverheadsBox(\""+a+'",'+d+");'>Edit[D]</a></td>";c+="<td><a style='text-decoration: none;' href='javascript:void(0);' onclick='deleteOverheadsChecked(\""+a+d+"\");'>Delete[D]</a></td>";c+="</tr></table>";document.getElementById(e+d).innerHTML=c};var populateOverheadsTable=function(j,f,b){var g=f+b;var e=j.getElementsByTagName("entry");for(var d=0;d<e.length;d++){var c=document.getElementById(g);var h=c.tBodies[0].rows.length;var a=Array();a[0]=e[d].childNodes[0].firstChild.data;a[1]=e[d].childNodes[1].firstChild.data;a[2]=e[d].childNodes[2].firstChild.data;a[3]=e[d].childNodes[3].firstChild.data;a[4]=e[d].childNodes[4].firstChild.data;a[5]=e[d].childNodes[5].firstChild.data;addRowToTable3(c,h,a)}};var addRowToTable3=function(j,o,n){var r=j.tBodies[0].rows.length;var b=r+ROW_BASE;if(o==-1){o=r}else{b=o+ROW_BASE}var m=j.tBodies[0].insertRow(o);var e=Array();e[0]=m.insertCell(0);e[0].innerHTML="<img src='images/project/job.gif' border='0'>";e[1]=m.insertCell(1);var d=document.createTextNode(b);e[1].appendChild(d);e[2]=m.insertCell(2);var q=getTextBox(20,n[1]);q.style.display="none";var s=document.createTextNode(n[1]);e[2].appendChild(q);e[2].appendChild(s);e[3]=m.insertCell(3);var p=getTextBox(10,n[2]);p.style.display="none";var c=document.createTextNode(n[2]);e[3].appendChild(p);e[3].appendChild(c);e[4]=m.insertCell(4);var i=document.createTextNode(n[3]);var v=getSelectBox(m);var h=getOptionBox("Actual","Actual",n[3]);var g=getOptionBox("DR","DR",n[3]);var f=getOptionBox("Amount","Amount",n[3]);v.appendChild(h);v.appendChild(g);v.appendChild(f);e[4].appendChild(v);e[4].appendChild(i);v.style.display="none";e[5]=m.insertCell(5);var t;if(n[3]=="Amount"){t=getTextBox(10,n[4])}else{t=getTextBox(10,"-")}t.style.display="none";var l;if(n[3]=="Amount"){l=document.createTextNode(n[4])}else{l=document.createTextNode("-")}e[5].appendChild(t);e[5].appendChild(l);e[6]=m.insertCell(6);var u=document.createElement("input");u.setAttribute("type","checkbox");e[6].appendChild(u);var k=Array();k[0]=u;k[1]=0;k[2]=e[0].innerHTML;k[3]=d;k[4]=s;k[5]=q;k[6]=c;k[7]=p;k[8]=i;k[9]=v;k[10]=l;k[11]=t;k[12]=n[0];k[13]=n[5];var a=new myRowObject(k);m.myRow=a};var getTextBox=function(b,c){var a=document.createElement("input");a.setAttribute("type","text");a.setAttribute("size",b);a.setAttribute("value",c);return a};var getSelectBox=function(b){var a=document.createElement("select");a.onchange=hideTextBox;return a};var getOptionBox=function(b,e,c){var a=document.createElement("option");a.setAttribute("value",e);var d=document.createTextNode(b);if(e==c){a.setAttribute("selected",true)}a.appendChild(d);return a};var hideTextBox=function(g){var f=g;if(!f){f=window.event}var h;var d=null;var c;if(f.target){c=f.target;h=f.target.parentNode.parentNode}else{if(f.srcElement){c=f.srcElement;h=f.srcElement.parentNode.parentNode}}if(h!=null){var a=h.cells;var b=a[5].firstChild;if(c.options[c.selectedIndex].value=="Amount"){b.style.display="inline"}else{b.style.display="none"}}};function callDeleteOverheadsAjax(f,e,c){if(!confirmDelete()){return}var h=getHTMLHTTPRequest();var d=parseInt(Math.random()*99999999);var g="";for(var b=0;b<e.length;b++){if(b==0){g+=e[b].myRow.content[12]}else{g+=","+e[b].myRow.content[12]}}var a=myServerAddress+"MyXMLDispatcher?rand="+d+"&path="+20380+"&id="+g+"&method=deleteOverhead";h.open("GET",a,true);h.onreadystatechange=function(){if(h.readyState==4){if(h.status==200){var j=h.responseXML;var i=0;if(j==null){alert("Data Error")}else{var k=j.getElementsByTagName("status");i=systemStatus(null,k)}if(i==1){deleteRows(e);reorderRows(f,c)}else{if(i==2){alert("DELETE: System Error")}}}else{alert("Connection Problem:"+h.statusText)}closeSplashScreen()}};openSplashScreen();h.send(null)}var deleteOverheadsChecked=function(d){var f=document.getElementById(d);var a=new Array();var b=0;for(var c=0;c<f.tBodies[0].rows.length;c++){if(f.tBodies[0].rows[c].myRow.content[0].checked){a[b]=f.tBodies[0].rows[c];b++}}if(a.length>0){var e=a[0].sectionRowIndex;callDeleteOverheadsAjax(f,a,e)}};var deleteJobsRows=function(c){for(var a=0;a<c.length;a++){var b=c[a].sectionRowIndex;c[a].parentNode.deleteRow(b)}};var reorderJobsRows=function(d,c){if(d.tBodies[0].rows[c]){var b=c+ROW_BASE;for(var a=c;a<d.tBodies[0].rows.length;a++){d.tBodies[0].rows[a].myRow.content[3].data=b;b++}}};var deleteContextOverheadsChecked=function(){var a=new Array();var b=contextMenu.srcElement;while(true){a[0]=b.parentNode;if(a[0].tagName!="TR"){b=a[0];continue}else{break}}var d=a[0].parentNode.parentNode;var c=a[0].sectionRowIndex;callDeleteOverheadsAjax(d,a,c)};var addContextOverheadsBox=function(){var b=contextMenu.srcElement;var d;while(true){d=b.parentNode;if(d.tagName!="TR"){b=d;continue}else{break}}var c=d.parentNode.parentNode;var e=c.parentNode;var a=e.getAttribute("estimateRef");addNewOverheadBox(INNER_OVERHEAD_TABLE_NAME_PREFIX,a)};var addNewOverheadBox=function(p,v){var j=document.getElementById(p+v);var r=j.tBodies[0].rows.length;var n=r;var b=n+ROW_BASE;var m=j.tBodies[0].insertRow(n);var e=Array();e[0]=m.insertCell(0);e[0].innerHTML="<a href='javascript:void(0);' onclick='addNewOverhead(event,"+v+",\"add\");'><img src='images/common/tick.gif' border='0'></a>";e[1]=m.insertCell(1);var d=document.createTextNode(b);e[1].innerHTML="<a href='javascript:void(0);' onclick='addNewOverhead(event,"+v+",\"discard\");'><img src='images/common/cross.gif' border='0'></a>";e[2]=m.insertCell(2);var q=getTextBox(20,"-");var s=document.createTextNode("");e[2].appendChild(q);e[2].appendChild(s);e[3]=m.insertCell(3);var o=getTextBox(10,"-");var c=document.createTextNode("");e[3].appendChild(o);e[3].appendChild(c);e[4]=m.insertCell(4);var i=document.createTextNode("");var w=getSelectBox(m);var h=getOptionBox("Actual","Actual","");var g=getOptionBox("DR","DR","");var f=getOptionBox("Amount","Amount","");w.appendChild(h);w.appendChild(g);w.appendChild(f);e[4].appendChild(w);e[4].appendChild(i);e[5]=m.insertCell(5);var t=getTextBox(10,"-");t.style.display="none";var l=document.createTextNode("");e[5].appendChild(t);e[5].appendChild(l);e[6]=m.insertCell(6);var u=document.createElement("input");u.setAttribute("type","checkbox");u.disabled=true;e[6].appendChild(u);var k=Array();k[0]=u;k[1]=0;k[2]=e[0].innerHTML;k[3]=d;k[4]=s;k[5]=q;k[6]=c;k[7]=o;k[8]=i;k[9]=w;k[10]=l;k[11]=t;k[12]=0;k[13]=v;var a=new myRowObject(k);m.myRow=a;addRowRolloverEffect(m)};var addNewOverhead=function(k,c,l){var b=k;var p;var g;if(b.target){p=b.target.parentNode.parentNode.parentNode}else{if(b.srcElement){p=b.srcElement.parentNode.parentNode.parentNode}}var n=p.sectionRowIndex;g=p.parentNode.parentNode;if(l=="discard"){discardRowsArray=Array();discardRowsArray[0]=g.tBodies[0].rows[n];deleteJobsRows(discardRowsArray);reorderJobsRows(g,n)}else{if(l=="add"){var d=getHTMLHTTPRequest();var f=parseInt(Math.random()*99999999);var o=URLEncode(p.myRow.content[5].value);var j=URLEncode(p.myRow.content[7].value);var m=URLEncode(p.myRow.content[9].value);var h=URLEncode(p.myRow.content[11].value);var i="estimateId="+c;i+="&description="+o;i+="&percent="+j;i+="&type="+m;i+="&amount="+h;var a=myServerAddress+"MyXMLDispatcher?rand="+f+"&path="+20390+"&method=addOverhead";d.open("POST",a,true);d.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8");d.setRequestHeader("Content-length",d.length);d.onreadystatechange=function(){if(d.readyState==4){if(d.status==200){var s=d.responseXML;var e=0;if(s==null){alert("Data Error")}else{var t=s.getElementsByTagName("status");e=systemStatus(null,t)}if(e==1){var q=s.getElementsByTagName("key")[0].getAttribute("value");p.myRow.content[4].data=p.myRow.content[5].value;p.myRow.content[6].data=p.myRow.content[7].value;p.myRow.content[8].data=p.myRow.content[9].value;p.myRow.content[10].data=p.myRow.content[11].value;p.myRow.content[12]=""+q;p.myRow.content[13]=""+c;for(var r=5;r<=11;r+=2){p.myRow.content[r].style.display="none"}p.cells[0].innerHTML="";p.cells[0].innerHTML="<img src='images/common/url.gif' border='0'>";p.myRow.content[2]=p.cells[0].innerHTML;p.cells[1].innerHTML="";p.cells[1].appendChild(p.myRow.content[3]);p.myRow.content[0].disabled=false}else{if(e==2){alert("ADD: System Error")}}}else{alert("Connection Problem:"+d.statusText)}closeSplashScreen()}};openSplashScreen();d.send(i)}}};var editContextOverheadsBox=function(){var b=contextMenu.srcElement;var d;while(true){d=b.parentNode;if(d.tagName!="TR"){b=d;continue}else{break}}var c=d.parentNode.parentNode;var e=c.parentNode;var a=e.getAttribute("estimateRef");d.myRow.content[0].checked=true;editCheckedOverheadsBox(INNER_OVERHEAD_TABLE_NAME_PREFIX,a)};var editCheckedOverheadsBox=function(d,b){var f=document.getElementById(d+b);for(var g=0;g<f.tBodies[0].rows.length;g++){if(f.tBodies[0].rows[g].myRow.content[0].checked){var m=f.tBodies[0].rows[g];m.myRow.content[3]=document.createTextNode(m.myRow.content[3].data);m.cells[0].innerHTML="";m.cells[1].innerHTML="";m.cells[0].innerHTML="<a href='javascript:void(0);' onclick='editSelectedOverhead(event,"+b+",\"edit\");'><img src='images/common/tick.gif' border='0'></a>";m.cells[1].innerHTML="<a href='javascript:void(0);' onclick='editSelectedOverhead(event,"+b+",\"discard\");'><img src='images/common/cross.gif' border='0'></a>";var h=Array();for(var e=4;e<=10;e+=2){var l=m.myRow.content[e];var a=document.createElement("span");a.appendChild(document.createTextNode(l.data));a.style.display="none";l.parentNode.appendChild(a);l.data=""}for(var c=5;c<=11;c+=2){if(c==11){if(m.myRow.content[9].value=="Actual"||m.myRow.content[9].value=="DR"){m.myRow.content[c].style.display="none"}else{m.myRow.content[c].style.display=""}}else{m.myRow.content[c].style.display=""}}m.myRow.content[0].checked=false;m.myRow.content[0].disabled=true}}};var editSelectedOverhead=function(q,r,p){var t=q;var i;var f;if(t.target){i=t.target.parentNode.parentNode.parentNode}else{if(t.srcElement){i=t.srcElement.parentNode.parentNode.parentNode}}var j=i.sectionRowIndex;f=i.parentNode.parentNode;if(p=="discard"){var m;var l;var u;var o;for(var k=4;k<=10;k+=2){m=i.myRow.content[k];l=i.myRow.content[k+1];o=m.parentNode.childNodes[2];u=o.firstChild.data;m.data=u;l.value=u;l.style.display="none";o.parentNode.removeChild(o)}i.myRow.content[0].disabled=false;i.cells[0].innerHTML="";i.cells[0].innerHTML="<img src='images/common/url.gif' border='0'>";i.myRow.content[2]=i.cells[0].innerHTML;i.cells[1].innerHTML="";i.cells[1].appendChild(i.myRow.content[3])}else{if(p=="edit"){var s=getHTMLHTTPRequest();var b=parseInt(Math.random()*99999999);var n=URLEncode(i.myRow.content[5].value);var a=URLEncode(i.myRow.content[7].value);var c=URLEncode(i.myRow.content[9].value);var h=URLEncode(i.myRow.content[11].value);var g="id="+i.myRow.content[12];g+="&description="+n;g+="&percent="+a;g+="&type="+c;g+="&amount="+h;var d=myServerAddress+"MyXMLDispatcher?rand="+b+"&path="+20391+"&method=updateOverhead";s.open("POST",d,true);s.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8");s.setRequestHeader("Content-length",s.length);s.onreadystatechange=function(){if(s.readyState==4){if(s.status==200){var v=s.responseXML;var e=0;if(v==null){alert("Data Error")}else{var w=v.getElementsByTagName("status");e=systemStatus(null,w)}if(e==1){for(k=4;k<=10;k+=2){m=i.myRow.content[k];l=i.myRow.content[k+1];l.style.display="none";if(l.value==""){m.data="-";l.value="-"}else{if(k==10&&i.myRow.content[8].data!="Amount"){m.data=l.value="-"}else{m.data=l.value}}o=m.parentNode.childNodes[2];o.parentNode.removeChild(o)}i.myRow.content[0].disabled=false;i.cells[0].innerHTML="";i.cells[0].innerHTML="<img src='images/common/url.gif' border='0'>";i.myRow.content[2]=i.cells[0].innerHTML;i.cells[1].innerHTML="";i.cells[1].appendChild(i.myRow.content[3])}else{if(e==2){alert("EDIT: System Error")}}}else{alert("Connection Problem:"+s.statusText)}closeSplashScreen()}};openSplashScreen();s.send(g)}}};initializeProjectTable(10410);